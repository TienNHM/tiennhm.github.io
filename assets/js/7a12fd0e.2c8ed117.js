"use strict";(self.webpackChunktiennhm_github_io=self.webpackChunktiennhm_github_io||[]).push([[4013],{28453:(n,s,r)=>{r.d(s,{R:()=>h,x:()=>d});var t=r(96540);const e={},i=t.createContext(e);function h(n){const s=t.useContext(i);return t.useMemo((function(){return"function"==typeof n?n(s):{...s,...n}}),[s,n])}function d(n){let s;return s=n.disableParentContext?"function"==typeof n.components?n.components(e):n.components||e:h(n.components),t.createElement(i.Provider,{value:s},n.children)}},73695:(n,s,r)=>{r.r(s),r.d(s,{assets:()=>g,contentTitle:()=>h,default:()=>l,frontMatter:()=>i,metadata:()=>d,toc:()=>c});var t=r(74848),e=r(28453);const i={title:"18. Triggers",slug:"18-triggers",description:"T\xecm hi\u1ec3u c\xe1ch s\u1eed d\u1ee5ng Triggers \u0111\u1ec3 t\u1ef1 \u0111\u1ed9ng h\xf3a ki\u1ec3m so\xe1t d\u1eef li\u1ec7u trong SQL.",image:"https://tiennhm.github.io/img/docs/database.jpg",sidebar_position:18,tags:["database","sql","learn-sql","roadmap","dbms"],keywords:["database","sql","learn-sql","roadmap","dbms"],enableComments:!0,draft:!1},h=void 0,d={id:"database/learn-sql-in-30-days/Triggers",title:"18. Triggers",description:"T\xecm hi\u1ec3u c\xe1ch s\u1eed d\u1ee5ng Triggers \u0111\u1ec3 t\u1ef1 \u0111\u1ed9ng h\xf3a ki\u1ec3m so\xe1t d\u1eef li\u1ec7u trong SQL.",source:"@site/docs/06-database/learn-sql-in-30-days/18. Triggers.md",sourceDirName:"06-database/learn-sql-in-30-days",slug:"/database/learn-sql-in-30-days/18-triggers",permalink:"/docs/database/learn-sql-in-30-days/18-triggers",draft:!1,unlisted:!1,editUrl:"https://github.com/TienNHM/tiennhm.github.io/tree/master/docs/06-database/learn-sql-in-30-days/18. Triggers.md",tags:[{inline:!0,label:"database",permalink:"/docs/tags/database"},{inline:!0,label:"sql",permalink:"/docs/tags/sql"},{inline:!0,label:"learn-sql",permalink:"/docs/tags/learn-sql"},{inline:!0,label:"roadmap",permalink:"/docs/tags/roadmap"},{inline:!0,label:"dbms",permalink:"/docs/tags/dbms"}],version:"current",lastUpdatedAt:1755314501e3,sidebarPosition:18,frontMatter:{title:"18. Triggers",slug:"18-triggers",description:"T\xecm hi\u1ec3u c\xe1ch s\u1eed d\u1ee5ng Triggers \u0111\u1ec3 t\u1ef1 \u0111\u1ed9ng h\xf3a ki\u1ec3m so\xe1t d\u1eef li\u1ec7u trong SQL.",image:"https://tiennhm.github.io/img/docs/database.jpg",sidebar_position:18,tags:["database","sql","learn-sql","roadmap","dbms"],keywords:["database","sql","learn-sql","roadmap","dbms"],enableComments:!0,draft:!1},sidebar:"tutorialSidebar",previous:{title:"17. Stored Procedures & Functions",permalink:"/docs/database/learn-sql-in-30-days/17-stored-procedures-functions"},next:{title:"19. Views",permalink:"/docs/database/learn-sql-in-30-days/19-views"}},g={},c=[{value:"\ud83d\udccc <strong>1. Trigger l\xe0 g\xec?</strong>",id:"-1-trigger-l\xe0-g\xec",level:2},{value:"\ud83d\udee0 <strong>2. C\xe1c lo\u1ea1i Trigger trong SQL</strong>",id:"-2-c\xe1c-lo\u1ea1i-trigger-trong-sql",level:2},{value:"\u2699\ufe0f <strong>3. C\xe1ch t\u1ea1o Trigger trong SQL</strong>",id:"\ufe0f-3-c\xe1ch-t\u1ea1o-trigger-trong-sql",level:2},{value:"<strong>C\u1ea5u tr\xfac c\u01a1 b\u1ea3n</strong>",id:"c\u1ea5u-tr\xfac-c\u01a1-b\u1ea3n",level:3},{value:"\ud83d\uded2 <strong>4. V\xed d\u1ee5 th\u1ef1c t\u1ebf: C\u1eadp nh\u1eadt t\u1ed3n kho t\u1ef1 \u0111\u1ed9ng</strong>",id:"-4-v\xed-d\u1ee5-th\u1ef1c-t\u1ebf-c\u1eadp-nh\u1eadt-t\u1ed3n-kho-t\u1ef1-\u0111\u1ed9ng",level:2},{value:"<strong>1\ufe0f\u20e3 T\u1ea1o b\u1ea3ng s\u1ea3n ph\u1ea9m (<code>products</code>)</strong>",id:"1\ufe0f\u20e3-t\u1ea1o-b\u1ea3ng-s\u1ea3n-ph\u1ea9m-products",level:3},{value:"<strong>2\ufe0f\u20e3 T\u1ea1o b\u1ea3ng \u0111\u01a1n h\xe0ng (<code>orders</code>)</strong>",id:"2\ufe0f\u20e3-t\u1ea1o-b\u1ea3ng-\u0111\u01a1n-h\xe0ng-orders",level:3},{value:"<strong>3\ufe0f\u20e3 T\u1ea1o Trigger c\u1eadp nh\u1eadt stock sau khi \u0111\u1eb7t h\xe0ng</strong>",id:"3\ufe0f\u20e3-t\u1ea1o-trigger-c\u1eadp-nh\u1eadt-stock-sau-khi-\u0111\u1eb7t-h\xe0ng",level:3},{value:"<strong>4\ufe0f\u20e3 Ki\u1ec3m tra trigger ho\u1ea1t \u0111\u1ed9ng</strong>",id:"4\ufe0f\u20e3-ki\u1ec3m-tra-trigger-ho\u1ea1t-\u0111\u1ed9ng",level:3},{value:"\ud83d\udea8 <strong>5. Ki\u1ec3m so\xe1t d\u1eef li\u1ec7u v\u1edbi BEFORE Trigger</strong>",id:"-5-ki\u1ec3m-so\xe1t-d\u1eef-li\u1ec7u-v\u1edbi-before-trigger",level:2},{value:"<strong>Ng\u0103n kh\xf4ng cho kh\xe1ch \u0111\u1eb7t h\xe0ng n\u1ebfu h\u1ebft h\xe0ng</strong>",id:"ng\u0103n-kh\xf4ng-cho-kh\xe1ch-\u0111\u1eb7t-h\xe0ng-n\u1ebfu-h\u1ebft-h\xe0ng",level:3},{value:"\ud83d\udcdc <strong>6. Ghi log thay \u0111\u1ed5i d\u1eef li\u1ec7u v\u1edbi AFTER UPDATE</strong>",id:"-6-ghi-log-thay-\u0111\u1ed5i-d\u1eef-li\u1ec7u-v\u1edbi-after-update",level:2},{value:"<strong>1\ufe0f\u20e3 T\u1ea1o b\u1ea3ng log (<code>product_logs</code>)</strong>",id:"1\ufe0f\u20e3-t\u1ea1o-b\u1ea3ng-log-product_logs",level:3},{value:"<strong>2\ufe0f\u20e3 T\u1ea1o Trigger ghi log khi <code>stock</code> thay \u0111\u1ed5i</strong>",id:"2\ufe0f\u20e3-t\u1ea1o-trigger-ghi-log-khi-stock-thay-\u0111\u1ed5i",level:3},{value:"\ud83c\udfaf <strong>7. B\xe0i t\u1eadp th\u1ef1c h\xe0nh</strong>",id:"-7-b\xe0i-t\u1eadp-th\u1ef1c-h\xe0nh",level:2},{value:"\u2705 <strong>B\xe0i 1: T\u1ea1o trigger c\u1eadp nh\u1eadt t\u1ed5ng s\u1ed1 l\u01b0\u1ee3ng h\xe0ng \u0111\xe3 b\xe1n</strong>",id:"-b\xe0i-1-t\u1ea1o-trigger-c\u1eadp-nh\u1eadt-t\u1ed5ng-s\u1ed1-l\u01b0\u1ee3ng-h\xe0ng-\u0111\xe3-b\xe1n",level:3},{value:"\u2705 <strong>B\xe0i 2: Ng\u0103n kh\xf4ng cho x\xf3a s\u1ea3n ph\u1ea9m n\u1ebfu c\xf3 \u0111\u01a1n h\xe0ng</strong>",id:"-b\xe0i-2-ng\u0103n-kh\xf4ng-cho-x\xf3a-s\u1ea3n-ph\u1ea9m-n\u1ebfu-c\xf3-\u0111\u01a1n-h\xe0ng",level:3},{value:"\ud83d\udd25 <strong>T\xf3m t\u1eaft b\xe0i h\u1ecdc Ng\xe0y 18</strong>",id:"-t\xf3m-t\u1eaft-b\xe0i-h\u1ecdc-ng\xe0y-18",level:2}];function o(n){const s={a:"a",blockquote:"blockquote",br:"br",code:"code",h2:"h2",h3:"h3",hr:"hr",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,e.R)(),...n.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(s.blockquote,{children:["\n",(0,t.jsx)(s.p,{children:"M\u1ee5c ti\xeau b\xe0i h\u1ecdc: Hi\u1ec3u c\xe1ch s\u1eed d\u1ee5ng Triggers \u0111\u1ec3 t\u1ef1 \u0111\u1ed9ng ki\u1ec3m so\xe1t d\u1eef li\u1ec7u tr\u01b0\u1edbc/sau khi thay \u0111\u1ed5i."}),"\n"]}),"\n",(0,t.jsxs)(s.h2,{id:"-1-trigger-l\xe0-g\xec",children:["\ud83d\udccc ",(0,t.jsx)(s.strong,{children:"1. Trigger l\xe0 g\xec?"})]}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Trigger"})," l\xe0 m\u1ed9t lo\u1ea1i th\u1ee7 t\u1ee5c t\u1ef1 \u0111\u1ed9ng th\u1ef1c thi khi c\xf3 ",(0,t.jsx)(s.strong,{children:"s\u1ef1 ki\u1ec7n x\u1ea3y ra tr\xean m\u1ed9t b\u1ea3ng"})," (INSERT, UPDATE, DELETE)."]}),"\n",(0,t.jsxs)(s.p,{children:["\ud83d\udca1 ",(0,t.jsx)(s.strong,{children:"\u1ee8ng d\u1ee5ng c\u1ee7a Trigger:"}),(0,t.jsx)(s.br,{}),"\n","\u2714 T\u1ef1 \u0111\u1ed9ng c\u1eadp nh\u1eadt ",(0,t.jsx)(s.strong,{children:"t\u1ed3n kho"})," khi c\xf3 \u0111\u01a1n h\xe0ng m\u1edbi.",(0,t.jsx)(s.br,{}),"\n","\u2714 Ki\u1ec3m tra d\u1eef li\u1ec7u ",(0,t.jsx)(s.strong,{children:"tr\u01b0\u1edbc khi ch\xe8n v\xe0o b\u1ea3ng"}),".",(0,t.jsx)(s.br,{}),"\n","\u2714 Ghi log l\u1ecbch s\u1eed thay \u0111\u1ed5i d\u1eef li\u1ec7u.",(0,t.jsx)(s.br,{}),"\n","\u2714 Ki\u1ec3m so\xe1t r\xe0ng bu\u1ed9c d\u1eef li\u1ec7u kh\xf4ng th\u1ec3 th\u1ef1c hi\u1ec7n b\u1eb1ng ",(0,t.jsx)(s.code,{children:"CONSTRAINT"}),"."]}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsxs)(s.h2,{id:"-2-c\xe1c-lo\u1ea1i-trigger-trong-sql",children:["\ud83d\udee0 ",(0,t.jsx)(s.strong,{children:"2. C\xe1c lo\u1ea1i Trigger trong SQL"})]}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:(0,t.jsx)(s.strong,{children:"Lo\u1ea1i Trigger"})}),(0,t.jsx)(s.th,{children:(0,t.jsx)(s.strong,{children:"M\xf4 t\u1ea3"})})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.strong,{children:"BEFORE INSERT"})}),(0,t.jsx)(s.td,{children:"Ch\u1ea1y tr\u01b0\u1edbc khi ch\xe8n d\u1eef li\u1ec7u."})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.strong,{children:"AFTER INSERT"})}),(0,t.jsx)(s.td,{children:"Ch\u1ea1y sau khi ch\xe8n d\u1eef li\u1ec7u."})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.strong,{children:"BEFORE UPDATE"})}),(0,t.jsx)(s.td,{children:"Ch\u1ea1y tr\u01b0\u1edbc khi c\u1eadp nh\u1eadt d\u1eef li\u1ec7u."})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.strong,{children:"AFTER UPDATE"})}),(0,t.jsx)(s.td,{children:"Ch\u1ea1y sau khi c\u1eadp nh\u1eadt d\u1eef li\u1ec7u."})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.strong,{children:"BEFORE DELETE"})}),(0,t.jsx)(s.td,{children:"Ch\u1ea1y tr\u01b0\u1edbc khi x\xf3a d\u1eef li\u1ec7u."})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.strong,{children:"AFTER DELETE"})}),(0,t.jsx)(s.td,{children:"Ch\u1ea1y sau khi x\xf3a d\u1eef li\u1ec7u."})]})]})]}),"\n",(0,t.jsxs)(s.p,{children:["\ud83d\udc49 ",(0,t.jsx)(s.strong,{children:"BEFORE"})," gi\xfap ki\u1ec3m tra d\u1eef li\u1ec7u ",(0,t.jsx)(s.strong,{children:"tr\u01b0\u1edbc khi thay \u0111\u1ed5i"}),".",(0,t.jsx)(s.br,{}),"\n","\ud83d\udc49 ",(0,t.jsx)(s.strong,{children:"AFTER"})," gi\xfap ",(0,t.jsx)(s.strong,{children:"c\u1eadp nh\u1eadt b\u1ea3ng kh\xe1c"})," ho\u1eb7c ",(0,t.jsx)(s.strong,{children:"ghi log"})," sau khi thay \u0111\u1ed5i."]}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsxs)(s.h2,{id:"\ufe0f-3-c\xe1ch-t\u1ea1o-trigger-trong-sql",children:["\u2699\ufe0f ",(0,t.jsx)(s.strong,{children:"3. C\xe1ch t\u1ea1o Trigger trong SQL"})]}),"\n",(0,t.jsx)(s.h3,{id:"c\u1ea5u-tr\xfac-c\u01a1-b\u1ea3n",children:(0,t.jsx)(s.strong,{children:"C\u1ea5u tr\xfac c\u01a1 b\u1ea3n"})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-sql",children:"CREATE TRIGGER trigger_name\nAFTER INSERT ON table_name\nFOR EACH ROW\nBEGIN\n    -- H\xe0nh \u0111\u1ed9ng s\u1ebd \u0111\u01b0\u1ee3c th\u1ef1c thi\nEND;\n"})}),"\n",(0,t.jsxs)(s.p,{children:["\ud83d\udd39 ",(0,t.jsx)(s.strong,{children:"FOR EACH ROW"}),": Th\u1ef1c thi trigger cho t\u1eebng d\xf2ng b\u1ecb \u1ea3nh h\u01b0\u1edfng."]}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsxs)(s.h2,{id:"-4-v\xed-d\u1ee5-th\u1ef1c-t\u1ebf-c\u1eadp-nh\u1eadt-t\u1ed3n-kho-t\u1ef1-\u0111\u1ed9ng",children:["\ud83d\uded2 ",(0,t.jsx)(s.strong,{children:"4. V\xed d\u1ee5 th\u1ef1c t\u1ebf: C\u1eadp nh\u1eadt t\u1ed3n kho t\u1ef1 \u0111\u1ed9ng"})]}),"\n",(0,t.jsx)(s.h3,{id:"1\ufe0f\u20e3-t\u1ea1o-b\u1ea3ng-s\u1ea3n-ph\u1ea9m-products",children:(0,t.jsxs)(s.strong,{children:["1\ufe0f\u20e3 T\u1ea1o b\u1ea3ng s\u1ea3n ph\u1ea9m (",(0,t.jsx)(s.code,{children:"products"}),")"]})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-sql",children:"CREATE TABLE products (\n    id SERIAL PRIMARY KEY,\n    name VARCHAR(100),\n    stock INT NOT NULL\n);\n"})}),"\n",(0,t.jsx)(s.h3,{id:"2\ufe0f\u20e3-t\u1ea1o-b\u1ea3ng-\u0111\u01a1n-h\xe0ng-orders",children:(0,t.jsxs)(s.strong,{children:["2\ufe0f\u20e3 T\u1ea1o b\u1ea3ng \u0111\u01a1n h\xe0ng (",(0,t.jsx)(s.code,{children:"orders"}),")"]})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-sql",children:"CREATE TABLE orders (\n    id SERIAL PRIMARY KEY,\n    product_id INT REFERENCES products(id),\n    quantity INT NOT NULL\n);\n"})}),"\n",(0,t.jsx)(s.h3,{id:"3\ufe0f\u20e3-t\u1ea1o-trigger-c\u1eadp-nh\u1eadt-stock-sau-khi-\u0111\u1eb7t-h\xe0ng",children:(0,t.jsx)(s.strong,{children:"3\ufe0f\u20e3 T\u1ea1o Trigger c\u1eadp nh\u1eadt stock sau khi \u0111\u1eb7t h\xe0ng"})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-sql",children:"CREATE TRIGGER update_stock_after_order\nAFTER INSERT ON orders\nFOR EACH ROW\nBEGIN\n    UPDATE products\n    SET stock = stock - NEW.quantity\n    WHERE id = NEW.product_id;\nEND;\n"})}),"\n",(0,t.jsxs)(s.p,{children:["\ud83d\udd39 Khi c\xf3 \u0111\u01a1n h\xe0ng m\u1edbi, trigger ",(0,t.jsx)(s.strong,{children:"t\u1ef1 \u0111\u1ed9ng tr\u1eeb stock"})," s\u1ea3n ph\u1ea9m t\u01b0\u01a1ng \u1ee9ng."]}),"\n",(0,t.jsx)(s.h3,{id:"4\ufe0f\u20e3-ki\u1ec3m-tra-trigger-ho\u1ea1t-\u0111\u1ed9ng",children:(0,t.jsx)(s.strong,{children:"4\ufe0f\u20e3 Ki\u1ec3m tra trigger ho\u1ea1t \u0111\u1ed9ng"})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-sql",children:"INSERT INTO products (name, stock) VALUES ('Laptop', 10);\nINSERT INTO orders (product_id, quantity) VALUES (1, 2);\nSELECT * FROM products;\n"})}),"\n",(0,t.jsxs)(s.p,{children:["\ud83d\udc49 Stock c\u1ee7a Laptop s\u1ebd ",(0,t.jsx)(s.strong,{children:"gi\u1ea3m t\u1eeb 10 \u2192 8"}),"."]}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsxs)(s.h2,{id:"-5-ki\u1ec3m-so\xe1t-d\u1eef-li\u1ec7u-v\u1edbi-before-trigger",children:["\ud83d\udea8 ",(0,t.jsx)(s.strong,{children:"5. Ki\u1ec3m so\xe1t d\u1eef li\u1ec7u v\u1edbi BEFORE Trigger"})]}),"\n",(0,t.jsx)(s.h3,{id:"ng\u0103n-kh\xf4ng-cho-kh\xe1ch-\u0111\u1eb7t-h\xe0ng-n\u1ebfu-h\u1ebft-h\xe0ng",children:(0,t.jsx)(s.strong,{children:"Ng\u0103n kh\xf4ng cho kh\xe1ch \u0111\u1eb7t h\xe0ng n\u1ebfu h\u1ebft h\xe0ng"})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-sql",children:"CREATE TRIGGER check_stock_before_order\nBEFORE INSERT ON orders\nFOR EACH ROW\nBEGIN\n    DECLARE stock_available INT;\n    \n    SELECT stock INTO stock_available\n    FROM products WHERE id = NEW.product_id;\n    \n    IF stock_available < NEW.quantity THEN\n        SIGNAL SQLSTATE '45000'\n        SET MESSAGE_TEXT = 'Kh\xf4ng \u0111\u1ee7 h\xe0ng trong kho!';\n    END IF;\nEND;\n"})}),"\n",(0,t.jsxs)(s.p,{children:["\ud83d\udc49 N\u1ebfu s\u1ed1 l\u01b0\u1ee3ng \u0111\u1eb7t h\xe0ng l\u1edbn h\u01a1n ",(0,t.jsx)(s.code,{children:"stock"}),", ",(0,t.jsx)(s.strong,{children:"Trigger s\u1ebd b\xe1o l\u1ed7i"})," v\xe0 kh\xf4ng cho \u0111\u1eb7t h\xe0ng."]}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsxs)(s.h2,{id:"-6-ghi-log-thay-\u0111\u1ed5i-d\u1eef-li\u1ec7u-v\u1edbi-after-update",children:["\ud83d\udcdc ",(0,t.jsx)(s.strong,{children:"6. Ghi log thay \u0111\u1ed5i d\u1eef li\u1ec7u v\u1edbi AFTER UPDATE"})]}),"\n",(0,t.jsx)(s.h3,{id:"1\ufe0f\u20e3-t\u1ea1o-b\u1ea3ng-log-product_logs",children:(0,t.jsxs)(s.strong,{children:["1\ufe0f\u20e3 T\u1ea1o b\u1ea3ng log (",(0,t.jsx)(s.code,{children:"product_logs"}),")"]})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-sql",children:"CREATE TABLE product_logs (\n    id SERIAL PRIMARY KEY,\n    product_id INT,\n    old_stock INT,\n    new_stock INT,\n    changed_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n"})}),"\n",(0,t.jsx)(s.h3,{id:"2\ufe0f\u20e3-t\u1ea1o-trigger-ghi-log-khi-stock-thay-\u0111\u1ed5i",children:(0,t.jsxs)(s.strong,{children:["2\ufe0f\u20e3 T\u1ea1o Trigger ghi log khi ",(0,t.jsx)(s.code,{children:"stock"})," thay \u0111\u1ed5i"]})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-sql",children:"CREATE TRIGGER log_stock_changes\nAFTER UPDATE ON products\nFOR EACH ROW\nBEGIN\n    INSERT INTO product_logs (product_id, old_stock, new_stock)\n    VALUES (OLD.id, OLD.stock, NEW.stock);\nEND;\n"})}),"\n",(0,t.jsxs)(s.p,{children:["\ud83d\udd39 ",(0,t.jsx)(s.strong,{children:"OLD.stock"}),": Gi\xe1 tr\u1ecb ",(0,t.jsx)(s.code,{children:"stock"})," tr\u01b0\u1edbc khi c\u1eadp nh\u1eadt.",(0,t.jsx)(s.br,{}),"\n","\ud83d\udd39 ",(0,t.jsx)(s.strong,{children:"NEW.stock"}),": Gi\xe1 tr\u1ecb ",(0,t.jsx)(s.code,{children:"stock"})," m\u1edbi sau c\u1eadp nh\u1eadt."]}),"\n",(0,t.jsxs)(s.p,{children:["\ud83d\udc49 Khi thay \u0111\u1ed5i t\u1ed3n kho s\u1ea3n ph\u1ea9m, trigger s\u1ebd ",(0,t.jsx)(s.strong,{children:"t\u1ef1 \u0111\u1ed9ng ghi log"})," v\xe0o ",(0,t.jsx)(s.code,{children:"product_logs"}),"."]}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsxs)(s.h2,{id:"-7-b\xe0i-t\u1eadp-th\u1ef1c-h\xe0nh",children:["\ud83c\udfaf ",(0,t.jsx)(s.strong,{children:"7. B\xe0i t\u1eadp th\u1ef1c h\xe0nh"})]}),"\n",(0,t.jsxs)(s.h3,{id:"-b\xe0i-1-t\u1ea1o-trigger-c\u1eadp-nh\u1eadt-t\u1ed5ng-s\u1ed1-l\u01b0\u1ee3ng-h\xe0ng-\u0111\xe3-b\xe1n",children:["\u2705 ",(0,t.jsx)(s.strong,{children:"B\xe0i 1: T\u1ea1o trigger c\u1eadp nh\u1eadt t\u1ed5ng s\u1ed1 l\u01b0\u1ee3ng h\xe0ng \u0111\xe3 b\xe1n"})]}),"\n",(0,t.jsxs)(s.blockquote,{children:["\n",(0,t.jsxs)(s.p,{children:["Vi\u1ebft trigger c\u1eadp nh\u1eadt b\u1ea3ng ",(0,t.jsx)(s.code,{children:"sales_summary (product_id, total_sold)"})," m\u1ed7i khi c\xf3 \u0111\u01a1n h\xe0ng m\u1edbi."]}),"\n"]}),"\n",(0,t.jsxs)(s.p,{children:["\ud83d\udca1 ",(0,t.jsx)(s.strong,{children:"G\u1ee3i \xfd l\u1eddi gi\u1ea3i:"})]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-sql",children:"CREATE TABLE sales_summary (\n    product_id INT PRIMARY KEY,\n    total_sold INT DEFAULT 0\n);\n\nCREATE TRIGGER update_sales_summary\nAFTER INSERT ON orders\nFOR EACH ROW\nBEGIN\n    INSERT INTO sales_summary (product_id, total_sold)\n    VALUES (NEW.product_id, NEW.quantity)\n    ON DUPLICATE KEY UPDATE total_sold = total_sold + NEW.quantity;\nEND;\n"})}),"\n",(0,t.jsxs)(s.p,{children:["\ud83d\udc49 M\u1ed7i l\u1ea7n c\xf3 \u0111\u01a1n h\xe0ng m\u1edbi, ",(0,t.jsx)(s.strong,{children:"trigger s\u1ebd c\u1eadp nh\u1eadt t\u1ed5ng s\u1ed1 l\u01b0\u1ee3ng h\xe0ng \u0111\xe3 b\xe1n"}),"."]}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsxs)(s.h3,{id:"-b\xe0i-2-ng\u0103n-kh\xf4ng-cho-x\xf3a-s\u1ea3n-ph\u1ea9m-n\u1ebfu-c\xf3-\u0111\u01a1n-h\xe0ng",children:["\u2705 ",(0,t.jsx)(s.strong,{children:"B\xe0i 2: Ng\u0103n kh\xf4ng cho x\xf3a s\u1ea3n ph\u1ea9m n\u1ebfu c\xf3 \u0111\u01a1n h\xe0ng"})]}),"\n",(0,t.jsxs)(s.blockquote,{children:["\n",(0,t.jsxs)(s.p,{children:["Vi\u1ebft trigger ki\u1ec3m tra n\u1ebfu ",(0,t.jsx)(s.code,{children:"product_id"})," \u0111\xe3 t\u1ed3n t\u1ea1i trong ",(0,t.jsx)(s.code,{children:"orders"}),", kh\xf4ng cho ph\xe9p x\xf3a s\u1ea3n ph\u1ea9m kh\u1ecfi b\u1ea3ng ",(0,t.jsx)(s.code,{children:"products"}),"."]}),"\n"]}),"\n",(0,t.jsxs)(s.p,{children:["\ud83d\udca1 ",(0,t.jsx)(s.strong,{children:"G\u1ee3i \xfd l\u1eddi gi\u1ea3i:"})]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-sql",children:"CREATE TRIGGER prevent_product_deletion\nBEFORE DELETE ON products\nFOR EACH ROW\nBEGIN\n    DECLARE order_count INT;\n    \n    SELECT COUNT(*) INTO order_count FROM orders WHERE product_id = OLD.id;\n    \n    IF order_count > 0 THEN\n        SIGNAL SQLSTATE '45000'\n        SET MESSAGE_TEXT = 'Kh\xf4ng th\u1ec3 x\xf3a s\u1ea3n ph\u1ea9m v\xec \u0111\xe3 c\xf3 \u0111\u01a1n h\xe0ng!';\n    END IF;\nEND;\n"})}),"\n",(0,t.jsxs)(s.p,{children:["\ud83d\udc49 N\u1ebfu s\u1ea3n ph\u1ea9m \u0111\xe3 c\xf3 \u0111\u01a1n h\xe0ng, trigger s\u1ebd b\xe1o l\u1ed7i v\xe0 ",(0,t.jsx)(s.strong,{children:"kh\xf4ng cho x\xf3a"}),"."]}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsxs)(s.h2,{id:"-t\xf3m-t\u1eaft-b\xe0i-h\u1ecdc-ng\xe0y-18",children:["\ud83d\udd25 ",(0,t.jsx)(s.strong,{children:"T\xf3m t\u1eaft b\xe0i h\u1ecdc Ng\xe0y 18"})]}),"\n",(0,t.jsxs)(s.p,{children:["\u2705 ",(0,t.jsx)(s.strong,{children:"Triggers"})," gi\xfap t\u1ef1 \u0111\u1ed9ng h\xf3a ki\u1ec3m so\xe1t d\u1eef li\u1ec7u trong SQL.",(0,t.jsx)(s.br,{}),"\n","\u2705 ",(0,t.jsx)(s.strong,{children:"BEFORE Trigger"})," gi\xfap ki\u1ec3m tra d\u1eef li\u1ec7u ",(0,t.jsx)(s.strong,{children:"tr\u01b0\u1edbc khi thay \u0111\u1ed5i"}),".",(0,t.jsx)(s.br,{}),"\n","\u2705 ",(0,t.jsx)(s.strong,{children:"AFTER Trigger"})," gi\xfap c\u1eadp nh\u1eadt b\u1ea3ng kh\xe1c ho\u1eb7c ghi log ",(0,t.jsx)(s.strong,{children:"sau khi thay \u0111\u1ed5i"}),".",(0,t.jsx)(s.br,{}),"\n","\u2705 ",(0,t.jsx)(s.strong,{children:"Th\u1ef1c h\xe0nh:"})," T\u1ea1o trigger c\u1eadp nh\u1eadt t\u1ed3n kho, ghi log thay \u0111\u1ed5i, ng\u0103n x\xf3a d\u1eef li\u1ec7u quan tr\u1ecdng."]}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsxs)(s.p,{children:["\ud83d\ude80 ",(0,t.jsx)(s.strong,{children:"Ti\u1ebfp theo:"})," ",(0,t.jsx)(s.a,{href:"/docs/database/learn-sql-in-30-days/19-views",children:"Views (B\u1ea3ng \u1ea3o)."})]}),"\n",(0,t.jsxs)(s.p,{children:["\ud83d\udccc ",(0,t.jsx)(s.strong,{children:"L\u1ed9 tr\xecnh:"})," ",(0,t.jsx)(s.a,{href:"/docs/database/learn-sql-in-30-days/30-day-sql-learning-roadmap",children:"H\u1ecdc SQL trong 30 ng\xe0y"}),"."]})]})}function l(n={}){const{wrapper:s}={...(0,e.R)(),...n.components};return s?(0,t.jsx)(s,{...n,children:(0,t.jsx)(o,{...n})}):o(n)}}}]);