"use strict";(self.webpackChunktiennhm_github_io=self.webpackChunktiennhm_github_io||[]).push([[1043],{28453:(n,e,s)=>{s.d(e,{R:()=>o,x:()=>r});var i=s(96540);const c={},t=i.createContext(c);function o(n){const e=i.useContext(t);return i.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function r(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(c):n.components||c:o(n.components),i.createElement(t.Provider,{value:e},n.children)}},50068:(n,e,s)=>{s.r(e),s.d(e,{assets:()=>h,contentTitle:()=>r,default:()=>a,frontMatter:()=>o,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"web-security/webgoat-2023.8/A1-Broken-Access-Control/Hijack-a-session-02","title":"1.02 | Hijack a session","description":"B\xe0i vi\u1ebft n\xe0y s\u1ebd h\u01b0\u1edbng d\u1eabn c\xe1ch t\u1ea5n c\xf4ng Hijack a session tr\xean WebGoat 2023.8","source":"@site/docs/02-web-security/webgoat-2023.8/A1-Broken-Access-Control/Hijack-a-session-02.md","sourceDirName":"02-web-security/webgoat-2023.8/A1-Broken-Access-Control","slug":"/web-security/webgoat-2023.8/A1-Broken-Access-Control/hijack-a-session-02","permalink":"/docs/web-security/webgoat-2023.8/A1-Broken-Access-Control/hijack-a-session-02","draft":false,"unlisted":false,"editUrl":"https://github.com/TienNHM/tiennhm.github.io/tree/master/docs/02-web-security/webgoat-2023.8/A1-Broken-Access-Control/Hijack-a-session-02.md","tags":[{"inline":true,"label":"web-security","permalink":"/docs/tags/web-security"},{"inline":true,"label":"webgoat","permalink":"/docs/tags/webgoat"},{"inline":true,"label":"broken-access-control","permalink":"/docs/tags/broken-access-control"},{"inline":true,"label":"hijack-a-session","permalink":"/docs/tags/hijack-a-session"},{"inline":true,"label":"webgoat-2023.8","permalink":"/docs/tags/webgoat-2023-8"}],"version":"current","lastUpdatedAt":1756056430000,"sidebarPosition":1,"frontMatter":{"title":"1.02 | Hijack a session","slug":"hijack-a-session-02","description":"B\xe0i vi\u1ebft n\xe0y s\u1ebd h\u01b0\u1edbng d\u1eabn c\xe1ch t\u1ea5n c\xf4ng Hijack a session tr\xean WebGoat 2023.8","image":"https://tiennhm.github.io/img/docs/database.jpg","sidebar_position":1,"tags":["web-security","webgoat","broken-access-control","hijack-a-session","webgoat-2023.8"],"keywords":["web-security","webgoat","broken-access-control","hijack-a-session","webgoat-2023.8"],"enableComments":true,"draft":false},"sidebar":"tutorialSidebar","previous":{"title":"1.01 | Hijack a session","permalink":"/docs/web-security/webgoat-2023.8/A1-Broken-Access-Control/hijack-a-session-01"},"next":{"title":"2.01 | Insecure Direct Object References","permalink":"/docs/web-security/webgoat-2023.8/A1-Broken-Access-Control/insecure-direct-object-references-01"}}');var c=s(74848),t=s(28453);const o={title:"1.02 | Hijack a session",slug:"hijack-a-session-02",description:"B\xe0i vi\u1ebft n\xe0y s\u1ebd h\u01b0\u1edbng d\u1eabn c\xe1ch t\u1ea5n c\xf4ng Hijack a session tr\xean WebGoat 2023.8",image:"https://tiennhm.github.io/img/docs/database.jpg",sidebar_position:1,tags:["web-security","webgoat","broken-access-control","hijack-a-session","webgoat-2023.8"],keywords:["web-security","webgoat","broken-access-control","hijack-a-session","webgoat-2023.8"],enableComments:!0,draft:!1},r=void 0,h={},l=[{value:"\ud83d\ude80 <strong>1. T\xf3m t\u1eaft b\xe0i h\u1ecdc</strong>",id:"-1-t\xf3m-t\u1eaft-b\xe0i-h\u1ecdc",level:2},{value:"\ud83d\udca1 <strong>2. Hints</strong>",id:"-2-hints",level:2},{value:"\ud83d\udccc <strong>3. C\xe1c b\u01b0\u1edbc t\u1ea5n c\xf4ng</strong>",id:"-3-c\xe1c-b\u01b0\u1edbc-t\u1ea5n-c\xf4ng",level:2},{value:"<strong>1\ufe0f\u20e3 Thu th\u1eadp d\u1eef li\u1ec7u v\u1ec1 <code>hijack_cookie</code></strong>",id:"1\ufe0f\u20e3-thu-th\u1eadp-d\u1eef-li\u1ec7u-v\u1ec1-hijack_cookie",level:3},{value:"<strong>2\ufe0f\u20e3 D\u1ef1 \u0111o\xe1n cookie h\u1ee3p l\u1ec7</strong>",id:"2\ufe0f\u20e3-d\u1ef1-\u0111o\xe1n-cookie-h\u1ee3p-l\u1ec7",level:3},{value:"<strong>3\ufe0f\u20e3 T\u1ea5n c\xf4ng Brute Force</strong>",id:"3\ufe0f\u20e3-t\u1ea5n-c\xf4ng-brute-force",level:3},{value:"<strong>S\u1eed d\u1ee5ng Burp Suite:</strong>",id:"s\u1eed-d\u1ee5ng-burp-suite",level:4},{value:"<strong>S\u1eed d\u1ee5ng ZAP Fuzzer:</strong>",id:"s\u1eed-d\u1ee5ng-zap-fuzzer",level:4},{value:"\ud83d\udee1\ufe0f <strong>4. C\xe1ch ph\xf2ng tr\xe1nh</strong>",id:"\ufe0f-4-c\xe1ch-ph\xf2ng-tr\xe1nh",level:2},{value:"\ud83c\udfaf <strong>K\u1ebft lu\u1eadn</strong>",id:"-k\u1ebft-lu\u1eadn",level:2}];function d(n){const e={a:"a",br:"br",code:"code",h2:"h2",h3:"h3",h4:"h4",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...n.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)(e.h2,{id:"-1-t\xf3m-t\u1eaft-b\xe0i-h\u1ecdc",children:["\ud83d\ude80 ",(0,c.jsx)(e.strong,{children:"1. T\xf3m t\u1eaft b\xe0i h\u1ecdc"})]}),"\n",(0,c.jsxs)(e.ul,{children:["\n",(0,c.jsxs)(e.li,{children:[(0,c.jsx)(e.code,{children:"hijack_cookie"})," c\xf3 d\u1ea1ng ",(0,c.jsx)(e.strong,{children:'"s\u1ed1 tu\u1ea7n t\u1ef1"-"timestamp Unix"'}),"."]}),"\n",(0,c.jsx)(e.li,{children:"S\u1ed1 tu\u1ea7n t\u1ef1 t\u0103ng \u0111\u1ec1u (th\u01b0\u1eddng +1 ho\u1eb7c +2)."}),"\n",(0,c.jsx)(e.li,{children:"Timestamp Unix t\u01b0\u01a1ng \u1ee9ng v\u1edbi th\u1eddi gian t\u1ea1o session."}),"\n",(0,c.jsx)(e.li,{children:"B\u1eb1ng c\xe1ch quan s\xe1t nhi\u1ec1u cookie, c\xf3 th\u1ec3 d\u1ef1 \u0111o\xe1n m\u1ed9t gi\xe1 tr\u1ecb h\u1ee3p l\u1ec7."}),"\n"]}),"\n",(0,c.jsxs)(e.p,{children:["B\xe0i n\xe0y t\u1eadp trung v\xe0o d\u1ef1 \u0111o\xe1n gi\xe1 tr\u1ecb c\u1ee7a cookie ",(0,c.jsx)(e.code,{children:"hijack_cookie"}),", m\u1ed9t k\u1ef9 thu\u1eadt t\u1ea5n c\xf4ng ki\u1ec3u ",(0,c.jsx)(e.strong,{children:"Session Prediction"})," (D\u1ef1 \u0111o\xe1n phi\xean \u0111\u0103ng nh\u1eadp). M\u1ee5c ti\xeau l\xe0 x\xe1c \u0111\u1ecbnh c\xe1ch h\u1ec7 th\u1ed1ng t\u1ea1o cookie n\xe0y v\xe0 d\u1ef1 \u0111o\xe1n m\u1ed9t gi\xe1 tr\u1ecb h\u1ee3p l\u1ec7 \u0111\u1ec3 m\u1ea1o danh ng\u01b0\u1eddi d\xf9ng h\u1ee3p l\u1ec7."]}),"\n",(0,c.jsxs)(e.h2,{id:"-2-hints",children:["\ud83d\udca1 ",(0,c.jsx)(e.strong,{children:"2. Hints"})]}),"\n",(0,c.jsxs)(e.ul,{children:["\n",(0,c.jsxs)(e.li,{children:["Ki\u1ec3m tra gi\xe1 tr\u1ecb c\u1ee7a cookie ",(0,c.jsx)(e.code,{children:"hijack_cookie"})," v\xe0 xem x\xe9t v\u1ec1 \u0111\u1ecbnh d\u1ea1ng c\u1ee7a n\xf3."]}),"\n",(0,c.jsxs)(e.li,{children:["Cookie ",(0,c.jsx)(e.code,{children:"hijack_cookie"})," \u0111\u01b0\u1ee3c chia th\xe0nh hai ph\u1ea7n v\xe0 c\xf3 \u0111\u1ecbnh d\u1ea1ng nh\u01b0 sau ",(0,c.jsx)(e.code,{children:'"long number"-"another long number"'}),"."]}),"\n",(0,c.jsxs)(e.li,{children:["Cookie ",(0,c.jsx)(e.code,{children:"hijack_cookie"})," \u0111\u01b0\u1ee3c chia th\xe0nh hai ph\u1ea7n v\xe0 c\xf3 \u0111\u1ecbnh d\u1ea1ng nh\u01b0 sau ",(0,c.jsx)(e.code,{children:'"sequential number"-"unix epoch time"'}),"."]}),"\n",(0,c.jsx)(e.li,{children:"Th\u1eed g\u1eedi nhi\u1ec1u requests \u0111\u1ec3 bu\u1ed9c \u1ee9ng d\u1ee5ng t\u1ea1o ra c\xe1c cookie m\u1edbi v\xe0 ki\u1ec3m tra xem c\xf3 theo 1 m\u1eabu \u0111\u1ecbnh d\u1ea1ng chung n\xe0o kh\xf4ng."}),"\n",(0,c.jsx)(e.li,{children:"\u0110\xf4i khi, ng\u01b0\u1eddi d\xf9ng \u0111\u01b0\u1ee3c \u1ee7y quy\u1ec1n \u0111\u0103ng nh\u1eadp v\xe0o \u1ee9ng d\u1ee5ng."}),"\n"]}),"\n",(0,c.jsxs)(e.h2,{id:"-3-c\xe1c-b\u01b0\u1edbc-t\u1ea5n-c\xf4ng",children:["\ud83d\udccc ",(0,c.jsx)(e.strong,{children:"3. C\xe1c b\u01b0\u1edbc t\u1ea5n c\xf4ng"})]}),"\n",(0,c.jsx)(e.h3,{id:"1\ufe0f\u20e3-thu-th\u1eadp-d\u1eef-li\u1ec7u-v\u1ec1-hijack_cookie",children:(0,c.jsxs)(e.strong,{children:["1\ufe0f\u20e3 Thu th\u1eadp d\u1eef li\u1ec7u v\u1ec1 ",(0,c.jsx)(e.code,{children:"hijack_cookie"})]})}),"\n",(0,c.jsxs)(e.ul,{children:["\n",(0,c.jsxs)(e.li,{children:["B\u1eadt ",(0,c.jsx)(e.strong,{children:"Burp Suite/ZAP"})," \u0111\u1ec3 theo d\xf5i request."]}),"\n",(0,c.jsxs)(e.li,{children:["G\u1eedi nhi\u1ec1u request \u0111\u1ebfn ",(0,c.jsx)(e.code,{children:"/WebGoat/HijackSession"})," \u0111\u1ec3 thu th\u1eadp cookie."]}),"\n",(0,c.jsxs)(e.li,{children:["Ghi l\u1ea1i gi\xe1 tr\u1ecb ",(0,c.jsx)(e.code,{children:"hijack_cookie"})," nh\u1eadn \u0111\u01b0\u1ee3c."]}),"\n"]}),"\n",(0,c.jsx)(e.p,{children:"V\xed d\u1ee5 c\xe1c gi\xe1 tr\u1ecb nh\u1eadn \u0111\u01b0\u1ee3c:"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"8538432081538402370-1717442040234\n8538432081538402372-1717442064847\n8538432081538402373-1717442084267\n"})}),"\n",(0,c.jsx)(e.p,{children:(0,c.jsx)(e.strong,{children:"Nh\u1eadn x\xe9t:"})}),"\n",(0,c.jsxs)(e.ul,{children:["\n",(0,c.jsxs)(e.li,{children:["Ph\u1ea7n \u0111\u1ea7u ti\xean (",(0,c.jsx)(e.code,{children:"8538432081538402370"}),") t\u0103ng d\u1ea7n theo t\u1eebng session."]}),"\n",(0,c.jsxs)(e.li,{children:["Ph\u1ea7n sau (",(0,c.jsx)(e.code,{children:"1717442040234"}),") l\xe0 timestamp theo Unix Epoch."]}),"\n"]}),"\n",(0,c.jsx)(e.h3,{id:"2\ufe0f\u20e3-d\u1ef1-\u0111o\xe1n-cookie-h\u1ee3p-l\u1ec7",children:(0,c.jsx)(e.strong,{children:"2\ufe0f\u20e3 D\u1ef1 \u0111o\xe1n cookie h\u1ee3p l\u1ec7"})}),"\n",(0,c.jsx)(e.p,{children:"D\u1ef1a tr\xean c\xe1c m\u1eabu thu th\u1eadp \u0111\u01b0\u1ee3c, ta c\xf3 th\u1ec3 d\u1ef1 \u0111o\xe1n:"}),"\n",(0,c.jsxs)(e.ul,{children:["\n",(0,c.jsxs)(e.li,{children:["S\u1ed1 tu\u1ea7n t\u1ef1 ti\u1ebfp theo: N\u1ebfu c\xf3 ",(0,c.jsx)(e.code,{children:"8538432081538402372"}),", ta th\u1eed ",(0,c.jsx)(e.code,{children:"8538432081538402371"})," (s\u1ed1 xen gi\u1eefa)."]}),"\n",(0,c.jsx)(e.li,{children:"Timestamp: Ch\u1ecdn gi\xe1 tr\u1ecb g\u1ea7n nh\u1ea5t trong kho\u1ea3ng th\u1eddi gian session h\u1ee3p l\u1ec7."}),"\n"]}),"\n",(0,c.jsxs)(e.p,{children:["Gi\u1ea3 s\u1eed s\u1ed1 tu\u1ea7n t\u1ef1 l\xe0 ",(0,c.jsx)(e.strong,{children:"8538432081538402371"}),", timestamp h\u1ee3p l\u1ec7 c\xf3 th\u1ec3 n\u1eb1m gi\u1eefa ",(0,c.jsx)(e.code,{children:"1717442040234"})," v\xe0 ",(0,c.jsx)(e.code,{children:"1717442064847"})]}),"\n",(0,c.jsx)(e.h3,{id:"3\ufe0f\u20e3-t\u1ea5n-c\xf4ng-brute-force",children:(0,c.jsx)(e.strong,{children:"3\ufe0f\u20e3 T\u1ea5n c\xf4ng Brute Force"})}),"\n",(0,c.jsx)(e.h4,{id:"s\u1eed-d\u1ee5ng-burp-suite",children:(0,c.jsx)(e.strong,{children:"S\u1eed d\u1ee5ng Burp Suite:"})}),"\n",(0,c.jsxs)(e.ol,{children:["\n",(0,c.jsxs)(e.li,{children:[(0,c.jsxs)(e.strong,{children:["Ch\u1ecdn ",(0,c.jsx)(e.code,{children:"Intruder"})]}),", ch\u1ecdn request ch\u1ee9a cookie."]}),"\n",(0,c.jsxs)(e.li,{children:[(0,c.jsx)(e.strong,{children:"Clear v\u1ecb tr\xed fuzz"}),", ch\u1ecdn ph\u1ea7n timestamp \u0111\u1ec3 brute-force."]}),"\n",(0,c.jsxs)(e.li,{children:[(0,c.jsx)(e.strong,{children:"Payload:"})," Set kho\u1ea3ng gi\xe1 tr\u1ecb cho timestamp."]}),"\n",(0,c.jsxs)(e.li,{children:[(0,c.jsx)(e.strong,{children:"Ch\u1ea1y Attack"}),", ki\u1ec3m tra response h\u1ee3p l\u1ec7."]}),"\n"]}),"\n",(0,c.jsx)(e.h4,{id:"s\u1eed-d\u1ee5ng-zap-fuzzer",children:(0,c.jsx)(e.strong,{children:"S\u1eed d\u1ee5ng ZAP Fuzzer:"})}),"\n",(0,c.jsxs)(e.ol,{children:["\n",(0,c.jsxs)(e.li,{children:["Ch\u1ec9nh s\u1eeda ",(0,c.jsx)(e.code,{children:"hijack_cookie"})," theo m\u1eabu:","\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"hijack_cookie=8538432081538402371-1717442040234\n"})}),"\n"]}),"\n",(0,c.jsxs)(e.li,{children:["D\xf9ng ",(0,c.jsx)(e.strong,{children:"ZAP Fuzzer"})," \u0111\u1ec3 ki\u1ec3m tra c\xe1c gi\xe1 tr\u1ecb timestamp g\u1ea7n \u0111\xfang."]}),"\n",(0,c.jsx)(e.li,{children:"N\u1ebfu th\xe0nh c\xf4ng, h\u1ec7 th\u1ed1ng s\u1ebd x\xe1c nh\u1eadn session h\u1ee3p l\u1ec7."}),"\n"]}),"\n",(0,c.jsxs)(e.h2,{id:"\ufe0f-4-c\xe1ch-ph\xf2ng-tr\xe1nh",children:["\ud83d\udee1\ufe0f ",(0,c.jsx)(e.strong,{children:"4. C\xe1ch ph\xf2ng tr\xe1nh"})]}),"\n",(0,c.jsxs)(e.p,{children:["\u2705 ",(0,c.jsx)(e.strong,{children:"S\u1eed d\u1ee5ng Session Token ng\u1eabu nhi\xean"}),", kh\xf4ng d\u1ef1a tr\xean quy t\u1eafc d\u1ec5 \u0111o\xe1n.\n\u2705 ",(0,c.jsx)(e.strong,{children:"M\xe3 h\xf3a session ID thay v\xec \u0111\u1ec3 d\u01b0\u1edbi d\u1ea1ng s\u1ed1 d\u1ec5 \u0111o\xe1n."}),(0,c.jsx)(e.br,{}),"\n","\u2705 ",(0,c.jsx)(e.strong,{children:"H\u1ebft h\u1ea1n session sau th\u1eddi gian ng\u1eafn"})," \u0111\u1ec3 gi\u1ea3m thi\u1ec3u t\u1ea5n c\xf4ng brute-force.\n\u2705 ",(0,c.jsx)(e.strong,{children:"R\xe0ng bu\u1ed9c session v\u1edbi IP ho\u1eb7c User-Agent."}),(0,c.jsx)(e.br,{}),"\n","\u2705 ",(0,c.jsxs)(e.strong,{children:["S\u1eed d\u1ee5ng ",(0,c.jsx)(e.code,{children:"Secure"}),", ",(0,c.jsx)(e.code,{children:"HttpOnly"})," v\xe0 ",(0,c.jsx)(e.code,{children:"SameSite"})," cho cookie."]})]}),"\n",(0,c.jsxs)(e.h2,{id:"-k\u1ebft-lu\u1eadn",children:["\ud83c\udfaf ",(0,c.jsx)(e.strong,{children:"K\u1ebft lu\u1eadn"})]}),"\n",(0,c.jsx)(e.p,{children:"B\xe0i n\xe0y d\u1ea1y c\xe1ch ph\xe2n t\xedch v\xe0 d\u1ef1 \u0111o\xe1n session cookie \u0111\u1ec3 m\u1ea1o danh ng\u01b0\u1eddi d\xf9ng. \u0110\xe2y l\xe0 m\u1ed9t d\u1ea1ng t\u1ea5n c\xf4ng ph\u1ed5 bi\u1ebfn trong b\u1ea3o m\u1eadt \u1ee9ng d\u1ee5ng web v\xe0 nh\u1ea5n m\u1ea1nh t\u1ea7m quan tr\u1ecdng c\u1ee7a vi\u1ec7c s\u1eed d\u1ee5ng session an to\xe0n. \ud83d\ude80"}),"\n",(0,c.jsxs)(e.p,{children:["Xem th\xeam t\u1ea1i ",(0,c.jsx)(e.a,{href:"https://docs.cycubix.com/application-security-series/web-application-security-essentials/solutions/a5-broken-access-control/a1-2021-or-hijack-a-session-or-cycubix-docs/a1-2021-or-hijack-a-session-2-or-cycubix-docs",children:"\u0111\xe2y"}),"."]})]})}function a(n={}){const{wrapper:e}={...(0,t.R)(),...n.components};return e?(0,c.jsx)(e,{...n,children:(0,c.jsx)(d,{...n})}):d(n)}}}]);