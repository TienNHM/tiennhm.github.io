---
title: 14. Review 2
slug: 14-review-2
description: Kiá»ƒm tra kiáº¿n thá»©c - BÃ i táº­p tá»•ng há»£p cho tuáº§n 2 há»c SQL.
image: https://tiennhm.github.io/img/docs/database.jpg
sidebar_position: 14
# sidebar_class_name: hidden
tags:
    - database
    - sql
    - learn-sql
    - roadmap
    - dbms
keywords: [database, sql, learn-sql, roadmap, dbms]
enableComments: true # for Gisqus comments, set to true
draft: false # set to true to hide this post from the site
---

> Má»¥c tiÃªu bÃ i há»c: Kiá»ƒm tra kiáº¿n thá»©c - BÃ i táº­p tá»•ng há»£p cho tuáº§n 2 há»c SQL, tá»« Ä‘Ã³ cá»§ng cá»‘ kiáº¿n thá»©c vÃ  chuáº©n bá»‹ cho tuáº§n tiáº¿p theo.

HÃ´m nay, báº¡n sáº½ **Ã´n láº¡i táº¥t cáº£ kiáº¿n thá»©c Ä‘Ã£ há»c trong tuáº§n** vÃ  thá»±c hÃ nh vá»›i **cÃ¡c bÃ i táº­p tá»•ng há»£p** Ä‘á»ƒ rÃ¨n luyá»‡n ká»¹ nÄƒng SQL.  

---

## **1ï¸âƒ£ Tá»•ng káº¿t kiáº¿n thá»©c Ä‘Ã£ há»c trong tuáº§n 2**  

| Chá»§ Ä‘á»                  | Ná»™i dung chÃ­nh |
|-------------------------|--------------|
| **Aggregate Functions** | `COUNT()`, `SUM()`, `AVG()`, `MIN()`, `MAX()` |
| **GROUP BY & HAVING**   | NhÃ³m dá»¯ liá»‡u (`GROUP BY`) vÃ  lá»c nhÃ³m (`HAVING`) |
| **JOIN**                | Káº¿t há»£p dá»¯ liá»‡u tá»« nhiá»u báº£ng (`INNER JOIN`, `LEFT JOIN`, `RIGHT JOIN`, `FULL JOIN`) |
| **Subquery**            | Truy váº¥n con trong `SELECT`, `WHERE`, `FROM` |
| **UNION & INTERSECT**   | Há»£p nhiá»u táº­p dá»¯ liá»‡u (`UNION`) vÃ  láº¥y pháº§n chung (`INTERSECT`) |
| **CASE WHEN**           | Xá»­ lÃ½ Ä‘iá»u kiá»‡n vÃ  phÃ¢n loáº¡i dá»¯ liá»‡u |

---

## **2ï¸âƒ£ Cáº¥u trÃºc database: `ECommerceDB`**  

DÆ°á»›i Ä‘Ã¢y lÃ  thÃ´ng tin chi tiáº¿t vá» cÃ¡c báº£ng trong database Ä‘á»ƒ báº¡n dá»… dÃ ng lÃ m bÃ i táº­p Ã´n táº­p SQL.  

### **1ï¸âƒ£ Báº£ng `Customers` - ThÃ´ng tin khÃ¡ch hÃ ng**  
Chá»©a thÃ´ng tin vá» khÃ¡ch hÃ ng.  

| Column         | Data Type       | Description                     |
|----------------|-----------------|---------------------------------|
| `CustomerID`   | `INT` (PK)      | MÃ£ khÃ¡ch hÃ ng (Primary Key).    |
| `CustomerName` | `VARCHAR(255)`  | TÃªn khÃ¡ch hÃ ng.                 |
| `Email`        | `VARCHAR(255)`  | Email khÃ¡ch hÃ ng.               |
| `Phone`        | `VARCHAR(50)`   | Sá»‘ Ä‘iá»‡n thoáº¡i.                  |
| `Address`      | `TEXT`          | Äá»‹a chá»‰.                        |
| `CreatedAt`    | `DATETIME`      | NgÃ y táº¡o tÃ i khoáº£n.             |

---

### **2ï¸âƒ£ Báº£ng `Products` - ThÃ´ng tin sáº£n pháº©m**  
Chá»©a thÃ´ng tin vá» cÃ¡c sáº£n pháº©m Ä‘Æ°á»£c bÃ¡n.  

| Column        | Data Type       | Description                          |
|---------------|-----------------|--------------------------------------|
| `ProductID`   | `INT` (PK)      | MÃ£ sáº£n pháº©m (Primary Key).           |
| `ProductName` | `VARCHAR(255)`  | TÃªn sáº£n pháº©m.                        |
| `CategoryID`  | `INT` (FK)      | MÃ£ danh má»¥c (LiÃªn káº¿t `Categories`). |
| `Price`       | `DECIMAL(10,2)` | GiÃ¡ sáº£n pháº©m.                        |
| `Stock`       | `INT`           | Sá»‘ lÆ°á»£ng hÃ ng tá»“n kho.               |

---

### **3ï¸âƒ£ Báº£ng `Categories` - Danh má»¥c sáº£n pháº©m**  
Chá»©a thÃ´ng tin vá» cÃ¡c danh má»¥c sáº£n pháº©m.  

| Column         | Data Type      | Description                     |
|----------------|----------------|---------------------------------|
| `CategoryID`   | `INT` (PK)     | MÃ£ danh má»¥c (Primary Key).      |
| `CategoryName` | `VARCHAR(255)` | TÃªn danh má»¥c sáº£n pháº©m.          |

---

### **4ï¸âƒ£ Báº£ng `Orders` - ThÃ´ng tin Ä‘Æ¡n hÃ ng**  
Chá»©a thÃ´ng tin vá» Ä‘Æ¡n hÃ ng cá»§a khÃ¡ch hÃ ng.  

| Column        | Data Type       | Description                              |
|---------------|-----------------|------------------------------------------|
| `OrderID`     | `INT` (PK)      | MÃ£ Ä‘Æ¡n hÃ ng (Primary Key).               |
| `CustomerID`  | `INT` (FK)      | MÃ£ khÃ¡ch hÃ ng (LiÃªn káº¿t `Customers`).    |
| `OrderDate`   | `DATETIME`      | NgÃ y Ä‘áº·t hÃ ng.                           |
| `TotalAmount` | `DECIMAL(10,2)` | Tá»•ng tiá»n Ä‘Æ¡n hÃ ng.                      |
| `OrderType`   | `VARCHAR(50)`   | Loáº¡i Ä‘Æ¡n hÃ ng (`Online` hoáº·c `Offline`). |

---

### **5ï¸âƒ£ Báº£ng `OrderDetails` - Chi tiáº¿t Ä‘Æ¡n hÃ ng**  
LÆ°u thÃ´ng tin sáº£n pháº©m trong tá»«ng Ä‘Æ¡n hÃ ng.  

| Column          | Data Type       | Description                             |
|-----------------|-----------------|-----------------------------------------|
| `OrderDetailID` | `INT` (PK)      | MÃ£ chi tiáº¿t Ä‘Æ¡n hÃ ng (Primary Key).     |
| `OrderID`       | `INT` (FK)      | MÃ£ Ä‘Æ¡n hÃ ng (LiÃªn káº¿t `Orders`).        |
| `ProductID`     | `INT` (FK)      | MÃ£ sáº£n pháº©m (LiÃªn káº¿t `Products`).      |
| `Quantity`      | `INT`           | Sá»‘ lÆ°á»£ng sáº£n pháº©m trong Ä‘Æ¡n hÃ ng.       |
| `UnitPrice`     | `DECIMAL(10,2)` | GiÃ¡ táº¡i thá»i Ä‘iá»ƒm Ä‘áº·t hÃ ng.             |

---

### **ğŸ“Œ CÃ¡c rÃ ng buá»™c trong database**
1. **`Orders.CustomerID` â†’ `Customers.CustomerID`** (Má»—i Ä‘Æ¡n hÃ ng thuá»™c vá» 1 khÃ¡ch hÃ ng).  
2. **`Products.CategoryID` â†’ `Categories.CategoryID`** (Má»—i sáº£n pháº©m thuá»™c vá» 1 danh má»¥c).  
3. **`OrderDetails.OrderID` â†’ `Orders.OrderID`** (Má»—i chi tiáº¿t Ä‘Æ¡n hÃ ng thuá»™c vá» 1 Ä‘Æ¡n hÃ ng).  
4. **`OrderDetails.ProductID` â†’ `Products.ProductID`** (Má»—i chi tiáº¿t Ä‘Æ¡n hÃ ng chá»©a má»™t sáº£n pháº©m).  

DÆ°á»›i Ä‘Ã¢y lÃ  script SQL Ä‘á»ƒ táº¡o database **ECommerceDB**, bao gá»“m cÃ¡c báº£ng vÃ  rÃ ng buá»™c cáº§n thiáº¿t:  

---

### **ğŸ“Œ Táº¡o database vÃ  cÃ¡c báº£ng**
```sql
-- Táº¡o database
CREATE DATABASE ECommerceDB;
USE ECommerceDB;

-- Táº¡o báº£ng Customers (KhÃ¡ch hÃ ng)
CREATE TABLE Customers (
    CustomerID INT PRIMARY KEY AUTO_INCREMENT,
    CustomerName VARCHAR(255) NOT NULL,
    Email VARCHAR(255) UNIQUE NOT NULL,
    Phone VARCHAR(50) UNIQUE NOT NULL,
    Address TEXT,
    CreatedAt DATETIME DEFAULT CURRENT_TIMESTAMP
);

-- Táº¡o báº£ng Categories (Danh má»¥c sáº£n pháº©m)
CREATE TABLE Categories (
    CategoryID INT PRIMARY KEY AUTO_INCREMENT,
    CategoryName VARCHAR(255) NOT NULL
);

-- Táº¡o báº£ng Products (Sáº£n pháº©m)
CREATE TABLE Products (
    ProductID INT PRIMARY KEY AUTO_INCREMENT,
    ProductName VARCHAR(255) NOT NULL,
    CategoryID INT,
    Price DECIMAL(10,2) NOT NULL,
    Stock INT NOT NULL DEFAULT 0,
    FOREIGN KEY (CategoryID) REFERENCES Categories(CategoryID) ON DELETE SET NULL
);

-- Táº¡o báº£ng Orders (ÄÆ¡n hÃ ng)
CREATE TABLE Orders (
    OrderID INT PRIMARY KEY AUTO_INCREMENT,
    CustomerID INT,
    OrderDate DATETIME DEFAULT CURRENT_TIMESTAMP,
    TotalAmount DECIMAL(10,2) NOT NULL DEFAULT 0,
    OrderType VARCHAR(50) CHECK (OrderType IN ('Online', 'Offline')),
    FOREIGN KEY (CustomerID) REFERENCES Customers(CustomerID) ON DELETE CASCADE
);

-- Táº¡o báº£ng OrderDetails (Chi tiáº¿t Ä‘Æ¡n hÃ ng)
CREATE TABLE OrderDetails (
    OrderDetailID INT PRIMARY KEY AUTO_INCREMENT,
    OrderID INT,
    ProductID INT,
    Quantity INT NOT NULL CHECK (Quantity > 0),
    UnitPrice DECIMAL(10,2) NOT NULL,
    FOREIGN KEY (OrderID) REFERENCES Orders(OrderID) ON DELETE CASCADE,
    FOREIGN KEY (ProductID) REFERENCES Products(ProductID) ON DELETE CASCADE
);
```

---

### **ğŸ“Œ ChÃ¨n dá»¯ liá»‡u máº«u**
```sql
-- ThÃªm dá»¯ liá»‡u vÃ o báº£ng Customers
INSERT INTO Customers (CustomerName, Email, Phone, Address) VALUES
('Nguyá»…n VÄƒn A', 'nguyenvana@example.com', '0901123456', 'HÃ  Ná»™i'),
('Tráº§n Thá»‹ B', 'tranthib@example.com', '0902234567', 'TP.HCM'),
('LÃª VÄƒn C', 'levanc@example.com', '0903345678', 'ÄÃ  Náºµng');

-- ThÃªm dá»¯ liá»‡u vÃ o báº£ng Categories
INSERT INTO Categories (CategoryName) VALUES
('Äiá»‡n thoáº¡i'),
('Laptop'),
('Phá»¥ kiá»‡n');

-- ThÃªm dá»¯ liá»‡u vÃ o báº£ng Products
INSERT INTO Products (ProductName, CategoryID, Price, Stock) VALUES
('iPhone 15 Pro', 1, 29990000, 10),
('Samsung Galaxy S23', 1, 24990000, 15),
('MacBook Air M2', 2, 32990000, 8),
('Dell XPS 13', 2, 27990000, 5),
('Tai nghe AirPods Pro', 3, 4990000, 20);

-- ThÃªm dá»¯ liá»‡u vÃ o báº£ng Orders
INSERT INTO Orders (CustomerID, TotalAmount, OrderType) VALUES
(1, 29990000, 'Online'),
(2, 57980000, 'Offline'),
(3, 24990000, 'Online');

-- ThÃªm dá»¯ liá»‡u vÃ o báº£ng OrderDetails
INSERT INTO OrderDetails (OrderID, ProductID, Quantity, UnitPrice) VALUES
(1, 1, 1, 29990000),
(2, 3, 1, 32990000),
(2, 4, 1, 27990000),
(3, 2, 1, 24990000);
```

## **3ï¸âƒ£ BÃ i táº­p thá»±c hÃ nh tá»•ng há»£p ğŸš€**  

### **ğŸ“Œ BÃ i 1: Láº¥y danh sÃ¡ch khÃ¡ch hÃ ng vÃ  tá»•ng sá»‘ Ä‘Æ¡n hÃ ng há» Ä‘Ã£ Ä‘áº·t**  
âœ… **YÃªu cáº§u:**  
- Hiá»ƒn thá»‹ `CustomerID`, `CustomerName`, sá»‘ lÆ°á»£ng Ä‘Æ¡n hÃ ng (`TotalOrders`).  
- Sáº¯p xáº¿p giáº£m dáº§n theo sá»‘ Ä‘Æ¡n hÃ ng.  
- Chá»‰ hiá»ƒn thá»‹ nhá»¯ng khÃ¡ch hÃ ng cÃ³ Ã­t nháº¥t 3 Ä‘Æ¡n hÃ ng.  

ğŸ”¹ **Gá»£i Ã½:** Sá»­ dá»¥ng `JOIN`, `GROUP BY`, `HAVING`, `ORDER BY`.  

```sql
SELECT 
    c.CustomerID, 
    c.CustomerName, 
    COUNT(o.OrderID) AS TotalOrders
FROM Customers c
JOIN Orders o ON c.CustomerID = o.CustomerID
GROUP BY c.CustomerID, c.CustomerName
HAVING COUNT(o.OrderID) >= 3
ORDER BY TotalOrders DESC;
```

---

### **ğŸ“Œ BÃ i 2: TÃ¬m sáº£n pháº©m cÃ³ giÃ¡ cao hÆ¡n giÃ¡ trung bÃ¬nh**  
âœ… **YÃªu cáº§u:**  
- Hiá»ƒn thá»‹ `ProductID`, `ProductName`, `Price`.  
- Chá»‰ láº¥y sáº£n pháº©m cÃ³ giÃ¡ **cao hÆ¡n giÃ¡ trung bÃ¬nh** cá»§a táº¥t cáº£ sáº£n pháº©m.  

ğŸ”¹ **Gá»£i Ã½:** DÃ¹ng **Subquery trong WHERE** Ä‘á»ƒ láº¥y giÃ¡ trung bÃ¬nh.  

```sql
SELECT 
    ProductID, 
    ProductName, 
    Price
FROM Products
WHERE Price > (SELECT AVG(Price) FROM Products);
```

---

### **ğŸ“Œ BÃ i 3: Láº¥y danh sÃ¡ch Ä‘Æ¡n hÃ ng kÃ¨m tráº¡ng thÃ¡i Æ°u tiÃªn**  
âœ… **YÃªu cáº§u:**  
- Hiá»ƒn thá»‹ `OrderID`, `CustomerName`, `TotalAmount`, `PriorityStatus`.  
- `PriorityStatus` Ä‘Æ°á»£c xÃ¡c Ä‘á»‹nh báº±ng `CASE WHEN`:  
  - `>= 1000`: **"Cao"**  
  - `500 - 999`: **"Trung bÃ¬nh"**  
  - `< 500`: **"Tháº¥p"**  

ğŸ”¹ **Gá»£i Ã½:** DÃ¹ng `CASE WHEN`.  

```sql
SELECT 
    o.OrderID, 
    c.CustomerName, 
    o.TotalAmount,
    CASE 
        WHEN o.TotalAmount >= 1000 THEN 'Cao'
        WHEN o.TotalAmount >= 500 THEN 'Trung bÃ¬nh'
        ELSE 'Tháº¥p'
    END AS PriorityStatus
FROM Orders o
JOIN Customers c ON o.CustomerID = c.CustomerID;
```

---

### **ğŸ“Œ BÃ i 4: Doanh thu theo thÃ¡ng**  
âœ… **YÃªu cáº§u:**  
- Hiá»ƒn thá»‹ tá»•ng doanh thu (`TotalRevenue`) theo tá»«ng thÃ¡ng (`OrderMonth`).  
- Chá»‰ hiá»ƒn thá»‹ nhá»¯ng thÃ¡ng cÃ³ doanh thu **trÃªn 10 triá»‡u**.  
- Sáº¯p xáº¿p theo thá»© tá»± thÃ¡ng.  

ğŸ”¹ **Gá»£i Ã½:** DÃ¹ng `GROUP BY`, `HAVING`, `SUM()`, `MONTH()`.  

```sql
SELECT 
    MONTH(OrderDate) AS OrderMonth, 
    SUM(TotalAmount) AS TotalRevenue
FROM Orders
GROUP BY MONTH(OrderDate)
HAVING SUM(TotalAmount) > 10000000
ORDER BY OrderMonth;
```

---

### **ğŸ“Œ BÃ i 5: Danh sÃ¡ch khÃ¡ch hÃ ng cÃ³ cáº£ Ä‘Æ¡n hÃ ng Online vÃ  Offline**  
âœ… **YÃªu cáº§u:**  
- Hiá»ƒn thá»‹ `CustomerID`, `CustomerName`.  
- Chá»‰ láº¥y khÃ¡ch hÃ ng cÃ³ Ä‘Æ¡n hÃ ng **á»Ÿ cáº£ hai hÃ¬nh thá»©c** (**Online** vÃ  **Offline**).  

ğŸ”¹ **Gá»£i Ã½:** DÃ¹ng `INTERSECT`.  

```sql
SELECT CustomerID, CustomerName
FROM Orders
WHERE OrderType = 'Online'

INTERSECT

SELECT CustomerID, CustomerName
FROM Orders
WHERE OrderType = 'Offline';
```

---

## **3ï¸âƒ£ Thá»­ thÃ¡ch nÃ¢ng cao ğŸš€ğŸ”¥**  
ğŸ’¡ **BÃ i 6: Láº¥y sáº£n pháº©m cÃ³ tá»•ng sá»‘ lÆ°á»£ng bÃ¡n cao nháº¥t trong tá»«ng danh má»¥c**  
- Hiá»ƒn thá»‹ `CategoryID`, `CategoryName`, `ProductID`, `ProductName`, `TotalSold`.  
- `TotalSold` lÃ  tá»•ng sá»‘ lÆ°á»£ng sáº£n pháº©m Ä‘Ã£ bÃ¡n (`SUM(Quantity)`).  
- Chá»‰ láº¥y **sáº£n pháº©m cÃ³ tá»•ng sá»‘ lÆ°á»£ng bÃ¡n cao nháº¥t trong má»—i danh má»¥c**.  

ğŸ”¹ **Gá»£i Ã½:** DÃ¹ng `JOIN`, `GROUP BY`, `ORDER BY`, `RANK() OVER (PARTITION BY CategoryID)`.  

---

âœ… **TÃ³m táº¯t NgÃ y 14:**  
âœ”ï¸ **Ã”n táº­p kiáº¿n thá»©c Tuáº§n 2.**  
âœ”ï¸ **Luyá»‡n táº­p vá»›i bÃ i táº­p tá»•ng há»£p vá» JOIN, GROUP BY, HAVING, CASE WHEN, SUBQUERY.**  
âœ”ï¸ **BÃ i táº­p nÃ¢ng cao giÃºp báº¡n Ã¡p dá»¥ng nhiá»u ká»¹ thuáº­t SQL cÃ¹ng lÃºc.**  

ğŸš€ **Tiáº¿p theo:** Há»c vá» [Chá»‰ má»¥c (Indexes)](15.%20Index.md)!

ğŸ“Œ **Lá»™ trÃ¬nh:** [Há»c SQL trong 30 ngÃ y](00.%2030-Day%20SQL%20Learning%20Roadmap.md)