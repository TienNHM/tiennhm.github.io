---
title: 30. Database security
slug: 30-database-security
description: Há»c cÃ¡ch quáº£n trá»‹ & báº£o máº­t database, phÃ¢n quyá»n, ngÄƒn cháº·n SQL Injection, sao lÆ°u & khÃ´i phá»¥c dá»¯ liá»‡u Ä‘Ãºng cÃ¡ch.
image: https://tiennhm.github.io/img/docs/database.jpg
sidebar_position: 30
# sidebar_class_name: hidden
tags:
    - database
    - sql
    - learn-sql
    - roadmap
    - dbms
keywords: [database, sql, learn-sql, roadmap, dbms]
enableComments: true # for Gisqus comments, set to true
draft: false # set to true to hide this post from the site
---

# ðŸ“Œ **NgÃ y 30: Quáº£n Trá»‹ & Báº£o Máº­t Database**  

## **1ï¸âƒ£ Giá»›i Thiá»‡u**  
ðŸ”¹ Quáº£n trá»‹ cÆ¡ sá»Ÿ dá»¯ liá»‡u (DBA) lÃ  má»™t ká»¹ nÄƒng quan trá»ng Ä‘á»ƒ **báº£o vá»‡ dá»¯ liá»‡u, quáº£n lÃ½ quyá»n truy cáº­p vÃ  Ä‘áº£m báº£o há»‡ thá»‘ng an toÃ n**.  
ðŸ”¹ Trong bÃ i há»c nÃ y, báº¡n sáº½ há»c:  
âœ” **Quáº£n lÃ½ ngÆ°á»i dÃ¹ng, vai trÃ² & quyá»n truy cáº­p** (`GRANT`, `REVOKE`).  
âœ” **NgÄƒn cháº·n SQL Injection & báº£o máº­t dá»¯ liá»‡u**.  
âœ” **Sao lÆ°u & khÃ´i phá»¥c dá»¯ liá»‡u (Backup & Restore)**.  

ðŸ’¡ **Má»¥c tiÃªu:**  
âœ” Biáº¿t cÃ¡ch **phÃ¢n quyá»n** trong SQL Server, MySQL, PostgreSQL.  
âœ” Hiá»ƒu cÃ¡ch **phÃ¡t hiá»‡n & ngÄƒn cháº·n SQL Injection**.  
âœ” Biáº¿t **thá»±c hiá»‡n sao lÆ°u & phá»¥c há»“i dá»¯ liá»‡u** Ä‘Ãºng cÃ¡ch.  

---

## **2ï¸âƒ£ Quáº£n LÃ½ NgÆ°á»i DÃ¹ng, Vai TrÃ² & Quyá»n Truy Cáº­p**  
### âœ… **2.1. Táº¡o User & GÃ¡n Quyá»n**  
ðŸ”¹ **CÃ¢u lá»‡nh `CREATE USER`** dÃ¹ng Ä‘á»ƒ táº¡o tÃ i khoáº£n database.  
ðŸ”¹ **CÃ¢u lá»‡nh `GRANT`** dÃ¹ng Ä‘á»ƒ cáº¥p quyá»n truy cáº­p dá»¯ liá»‡u.  

ðŸ’¡ **VÃ­ dá»¥:** Táº¡o user vÃ  cáº¥p quyá»n truy cáº­p báº£ng `Orders`  
```sql
-- Táº¡o user má»›i
CREATE USER 'sales_user'@'localhost' IDENTIFIED BY 'securepassword';

-- Cáº¥p quyá»n chá»‰ Ä‘á»c dá»¯ liá»‡u
GRANT SELECT ON sales_db.Orders TO 'sales_user'@'localhost';

-- Cáº¥p quyá»n cáº­p nháº­t dá»¯ liá»‡u
GRANT UPDATE, INSERT ON sales_db.Orders TO 'sales_user'@'localhost';
```
ðŸ”¹ **CÃ¡c quyá»n quan trá»ng:**  
âœ” `SELECT`: Xem dá»¯ liá»‡u.  
âœ” `INSERT`: ThÃªm dá»¯ liá»‡u.  
âœ” `UPDATE`: Sá»­a dá»¯ liá»‡u.  
âœ” `DELETE`: XÃ³a dá»¯ liá»‡u.  
âœ” `ALL PRIVILEGES`: ToÃ n quyá»n truy cáº­p.  

---

### âœ… **2.2. Thu Há»“i Quyá»n Truy Cáº­p**  
ðŸ”¹ **CÃ¢u lá»‡nh `REVOKE`** dÃ¹ng Ä‘á»ƒ thu há»“i quyá»n truy cáº­p.  

ðŸ’¡ **VÃ­ dá»¥:** Thu há»“i quyá»n sá»­a dá»¯ liá»‡u  
```sql
REVOKE UPDATE, INSERT ON sales_db.Orders FROM 'sales_user'@'localhost';
```

ðŸ”¹ **XÃ³a user khá»i há»‡ thá»‘ng:**  
```sql
DROP USER 'sales_user'@'localhost';
```

---

### âœ… **2.3. Táº¡o Vai TrÃ² (Roles) & GÃ¡n Quyá»n**  
ðŸ”¹ **Roles** giÃºp quáº£n lÃ½ nhiá»u user cÃ¹ng lÃºc dá»… dÃ ng hÆ¡n.  

ðŸ’¡ **VÃ­ dá»¥:** Táº¡o role **"NhÃ¢n viÃªn bÃ¡n hÃ ng"** vÃ  gÃ¡n quyá»n  
```sql
-- Táº¡o role má»›i
CREATE ROLE SalesRole;

-- GÃ¡n quyá»n cho role
GRANT SELECT, INSERT ON sales_db.Orders TO SalesRole;

-- GÃ¡n role cho user
GRANT SalesRole TO 'sales_user'@'localhost';
```

---

## **3ï¸âƒ£ PhÃ¡t Hiá»‡n & NgÄƒn Cháº·n SQL Injection**  
ðŸ”¹ **SQL Injection** lÃ  ká»¹ thuáº­t táº¥n cÃ´ng báº±ng cÃ¡ch chÃ¨n mÃ£ SQL vÃ o cÃ¡c input Ä‘áº§u vÃ o.  
ðŸ”¹ Káº» táº¥n cÃ´ng cÃ³ thá»ƒ **truy váº¥n, xÃ³a, sá»­a dá»¯ liá»‡u** náº¿u khÃ´ng kiá»ƒm tra input cháº·t cháº½.  

ðŸ’¡ **VÃ­ dá»¥:** Má»™t truy váº¥n bá»‹ lá»—i báº£o máº­t  
```sql
SELECT * FROM Users WHERE username = 'admin' AND password = '1234' OR '1'='1';
```
ðŸ”¹ **Váº¥n Ä‘á»:** `'1'='1'` luÃ´n Ä‘Ãºng, khiáº¿n hacker Ä‘Äƒng nháº­p mÃ  khÃ´ng cáº§n máº­t kháº©u.  

---

### âœ… **3.1. CÃ¡ch NgÄƒn Cháº·n SQL Injection**  
âœ” **DÃ¹ng Prepared Statements hoáº·c Stored Procedures.**  
âœ” **KhÃ´ng ná»‘i chuá»—i trá»±c tiáº¿p vÃ o SQL.**  
âœ” **Kiá»ƒm tra input ngÆ°á»i dÃ¹ng (Validation & Sanitization).**  

ðŸ’¡ **VÃ­ dá»¥:** **DÃ¹ng Prepared Statements (MySQL, PostgreSQL)**  
```sql
PREPARE stmt FROM 'SELECT * FROM Users WHERE username = ? AND password = ?';
SET @user = 'admin', @pass = '1234';
EXECUTE stmt USING @user, @pass;
```
ðŸ”¹ **Lá»£i Ã­ch:**  
âœ” Biáº¿n `?` Ä‘Æ°á»£c xá»­ lÃ½ an toÃ n, khÃ´ng thá»ƒ chÃ¨n mÃ£ Ä‘á»™c.  

---

## **4ï¸âƒ£ Sao LÆ°u & Phá»¥c Há»“i Dá»¯ Liá»‡u (Backup & Restore)**  
### âœ… **4.1. Sao LÆ°u Database (Backup)**  
ðŸ”¹ **Táº¡o file backup toÃ n bá»™ dá»¯ liá»‡u** Ä‘á»ƒ phÃ²ng trÆ°á»ng há»£p lá»—i há»‡ thá»‘ng.  

ðŸ’¡ **VÃ­ dá»¥:** Sao lÆ°u toÃ n bá»™ database MySQL  
```bash
mysqldump -u root -p sales_db > sales_backup.sql
```

ðŸ”¹ **Sao lÆ°u trong SQL Server:**  
```sql
BACKUP DATABASE SalesDB TO DISK = 'C:\Backups\SalesDB.bak' WITH FORMAT;
```

---

### âœ… **4.2. KhÃ´i Phá»¥c Database (Restore)**  
ðŸ”¹ **DÃ¹ng file backup Ä‘á»ƒ khÃ´i phá»¥c dá»¯ liá»‡u khi bá»‹ máº¥t.**  

ðŸ’¡ **VÃ­ dá»¥:** KhÃ´i phá»¥c MySQL tá»« file backup  
```bash
mysql -u root -p sales_db < sales_backup.sql
```

ðŸ”¹ **KhÃ´i phá»¥c SQL Server:**  
```sql
RESTORE DATABASE SalesDB FROM DISK = 'C:\Backups\SalesDB.bak' WITH REPLACE;
```

---

## **5ï¸âƒ£ BÃ i Táº­p Thá»±c HÃ nh & Gá»£i Ã ÄÃ¡p Ãn**  
### ðŸ”¹ **BÃ i 1: Táº¡o user vÃ  cáº¥p quyá»n truy cáº­p**  
ðŸ“Œ **YÃªu cáº§u:**  
âœ” Táº¡o user `report_user`.  
âœ” Cáº¥p quyá»n `SELECT` trÃªn báº£ng `Orders`.  

ðŸ“ **Gá»£i Ã½ Ä‘Ã¡p Ã¡n:**  
```sql
CREATE USER 'report_user'@'localhost' IDENTIFIED BY 'securepass';
GRANT SELECT ON sales_db.Orders TO 'report_user'@'localhost';
```

---

### ðŸ”¹ **BÃ i 2: NgÄƒn cháº·n SQL Injection vá»›i Prepared Statement**  
ðŸ“Œ **YÃªu cáº§u:**  
âœ” Viáº¿t truy váº¥n láº¥y thÃ´ng tin user nhÆ°ng pháº£i an toÃ n.  

ðŸ“ **Gá»£i Ã½ Ä‘Ã¡p Ã¡n:**  
```sql
PREPARE stmt FROM 'SELECT * FROM Users WHERE username = ? AND password = ?';
SET @user = 'admin', @pass = 'mypassword';
EXECUTE stmt USING @user, @pass;
```

---

### ðŸ”¹ **BÃ i 3: Sao lÆ°u & khÃ´i phá»¥c database**  
ðŸ“Œ **YÃªu cáº§u:**  
âœ” Sao lÆ°u database `sales_db` thÃ nh file `sales_backup.sql`.  
âœ” KhÃ´i phá»¥c láº¡i tá»« file backup.  

ðŸ“ **Gá»£i Ã½ Ä‘Ã¡p Ã¡n:**  
```bash
mysqldump -u root -p sales_db > sales_backup.sql
mysql -u root -p sales_db < sales_backup.sql
```

---

#### ðŸ“Œ **TÃ³m táº¯t bÃ i há»c**
ðŸ”¹ **Quáº£n lÃ½ quyá»n truy cáº­p (GRANT, REVOKE, ROLES) giÃºp báº£o máº­t dá»¯ liá»‡u.**  
ðŸ”¹ **SQL Injection lÃ  nguy hiá»ƒm, cáº§n sá»­ dá»¥ng Prepared Statements.**  
ðŸ”¹ **Sao lÆ°u thÆ°á»ng xuyÃªn Ä‘á»ƒ báº£o vá»‡ dá»¯ liá»‡u trÆ°á»›c sá»± cá»‘.**  

---

ðŸš€ **Tiáº¿p theo:** [Tá»•ng káº¿t series.](99.%20Summary.md).

ðŸ“Œ **Lá»™ trÃ¬nh:** [Há»c SQL trong 30 ngÃ y](00.%2030-Day%20SQL%20Learning%20Roadmap.md).