---
title: 09. GROUP BY - HAVING
slug: 09-group-by-having
description: Giá»›i thiá»‡u vá» GROUP BY vÃ  HAVING trong SQL, cÃ¡ch sá»­ dá»¥ng vÃ  vÃ­ dá»¥ minh há»a.
image: https://tiennhm.github.io/img/docs/database.jpg
sidebar_position: 9
# sidebar_class_name: hidden
tags:
    - database
    - sql
    - learn-sql
    - roadmap
    - dbms
keywords: [database, sql, learn-sql, roadmap, dbms]
enableComments: true # for Gisqus comments, set to true
draft: false # set to true to hide this post from the site
---

> Má»¥c tiÃªu bÃ i há»c: Giá»›i thiá»‡u vá» GROUP BY vÃ  HAVING trong SQL, cÃ¡ch sá»­ dá»¥ng vÃ  vÃ­ dá»¥ minh há»a.

HÃ´m nay, báº¡n sáº½ há»c cÃ¡ch **nhÃ³m dá»¯ liá»‡u** vá»›i `GROUP BY` vÃ  **lá»c káº¿t quáº£ nhÃ³m** báº±ng `HAVING`.  

---

## **1ï¸âƒ£ GROUP BY lÃ  gÃ¬?**  
ğŸ“Œ `GROUP BY` giÃºp **nhÃ³m cÃ¡c hÃ ng cÃ³ cÃ¹ng giÃ¡ trá»‹ trong má»™t cá»™t** Ä‘á»ƒ tÃ­nh toÃ¡n tá»•ng há»£p (`COUNT()`, `SUM()`, `AVG()`, v.v.).  

### **VÃ­ dá»¥:**  
TÃ­nh tá»•ng doanh thu (`SUM(TotalAmount)`) cá»§a má»—i khÃ¡ch hÃ ng (`CustomerID`):  
```sql
SELECT CustomerID, SUM(TotalAmount) AS TotalSpent
FROM Orders
GROUP BY CustomerID;
```
âœ… **Ã nghÄ©a:** NhÃ³m cÃ¡c Ä‘Æ¡n hÃ ng theo `CustomerID` vÃ  tÃ­nh tá»•ng sá»‘ tiá»n mÃ  má»—i khÃ¡ch hÃ ng Ä‘Ã£ chi tiÃªu.  

---

## **2ï¸âƒ£ Chuáº©n bá»‹ dá»¯ liá»‡u**  
Náº¿u chÆ°a cÃ³ database, cháº¡y lá»‡nh nÃ y Ä‘á»ƒ táº¡o láº¡i:  
```sql
CREATE DATABASE ShopDB;
USE ShopDB;

CREATE TABLE Orders (
    ID INT AUTO_INCREMENT PRIMARY KEY,
    CustomerID INT NOT NULL,
    TotalAmount FLOAT NOT NULL,
    OrderDate DATE NOT NULL
);

INSERT INTO Orders (CustomerID, TotalAmount, OrderDate) VALUES
(1, 1500, '2024-02-20'),
(2, 1200, '2024-02-21'),
(3, 500, '2024-02-22'),
(1, 800, '2024-02-22'),
(2, 2000, '2024-02-23'),
(3, 700, '2024-02-23');
```

---

## **3ï¸âƒ£ GROUP BY - NhÃ³m dá»¯ liá»‡u**  
ğŸ“Œ **Äáº¿m sá»‘ Ä‘Æ¡n hÃ ng cá»§a má»—i khÃ¡ch hÃ ng**  
```sql
SELECT CustomerID, COUNT(*) AS OrderCount
FROM Orders
GROUP BY CustomerID;
```
âœ… Káº¿t quáº£:  
| CustomerID | OrderCount |
|------------|------------|
| 1          | 2          |
| 2          | 2          |
| 3          | 2          |

ğŸ“Œ **TÃ­nh tá»•ng doanh thu theo tá»«ng ngÃ y**  
```sql
SELECT OrderDate, SUM(TotalAmount) AS DailyRevenue
FROM Orders
GROUP BY OrderDate;
```
âœ… Káº¿t quáº£:  
| OrderDate  | DailyRevenue |
|------------|--------------|
| 2024-02-20 | 1500         |
| 2024-02-21 | 1200         |
| 2024-02-22 | 1300         |
| 2024-02-23 | 2700         |

---

## **4ï¸âƒ£ HAVING - Lá»c dá»¯ liá»‡u sau khi nhÃ³m**  
`HAVING` dÃ¹ng Ä‘á»ƒ **lá»c káº¿t quáº£ sau khi Ä‘Ã£ `GROUP BY`**, tÆ°Æ¡ng tá»± nhÆ° `WHERE` nhÆ°ng Ã¡p dá»¥ng cho dá»¯ liá»‡u nhÃ³m.  

ğŸ“Œ **Chá»‰ láº¥y khÃ¡ch hÃ ng cÃ³ tá»•ng chi tiÃªu > 2000**  
```sql
SELECT CustomerID, SUM(TotalAmount) AS TotalSpent
FROM Orders
GROUP BY CustomerID
HAVING SUM(TotalAmount) > 2000;
```
âœ… Káº¿t quáº£:  
| CustomerID | TotalSpent |
|------------|------------|
| 2          | 3200       |

ğŸ“Œ **Chá»‰ láº¥y cÃ¡c ngÃ y cÃ³ tá»•ng doanh thu >= 2000**  
```sql
SELECT OrderDate, SUM(TotalAmount) AS DailyRevenue
FROM Orders
GROUP BY OrderDate
HAVING SUM(TotalAmount) >= 2000;
```
âœ… Káº¿t quáº£:  
| OrderDate  | DailyRevenue |
|------------|--------------|
| 2024-02-23 | 2700         |

---

## **5ï¸âƒ£ Káº¿t há»£p GROUP BY, HAVING vÃ  ORDER BY**  
ğŸ“Œ **Láº¥y danh sÃ¡ch khÃ¡ch hÃ ng cÃ³ tá»« 2 Ä‘Æ¡n hÃ ng trá»Ÿ lÃªn, sáº¯p xáº¿p theo tá»•ng chi tiÃªu giáº£m dáº§n**  
```sql
SELECT 
    CustomerID, 
    COUNT(*) AS OrderCount, 
    SUM(TotalAmount) AS TotalSpent
FROM Orders
GROUP BY CustomerID
HAVING COUNT(*) >= 2
ORDER BY TotalSpent DESC;
```
âœ… Káº¿t quáº£:  
| CustomerID | OrderCount | TotalSpent |
|------------|------------|------------|
| 2          | 2          | 3200       |
| 1          | 2          | 2300       |
| 3          | 2          | 1200       |

---

## **6ï¸âƒ£ BÃ i táº­p thá»­ thÃ¡ch ğŸš€**  
ğŸ‘‰ **BÃ i 1:** TÃ­nh sá»‘ lÆ°á»£ng Ä‘Æ¡n hÃ ng theo tá»«ng ngÃ y.  
ğŸ‘‰ **BÃ i 2:** TÃ¬m khÃ¡ch hÃ ng cÃ³ tá»•ng chi tiÃªu lá»›n hÆ¡n `1000`.  
ğŸ‘‰ **BÃ i 3:** Äáº¿m sá»‘ lÆ°á»£ng khÃ¡ch hÃ ng cÃ³ Ã­t nháº¥t `2 Ä‘Æ¡n hÃ ng`.  
ğŸ‘‰ **BÃ i 4:** TÃ­nh doanh thu trung bÃ¬nh má»—i ngÃ y, chá»‰ láº¥y ngÃ y cÃ³ doanh thu lá»›n hÆ¡n `1500`.  
ğŸ‘‰ **BÃ i 5:** Láº¥y danh sÃ¡ch ngÃ y cÃ³ trÃªn `1 Ä‘Æ¡n hÃ ng`, sáº¯p xáº¿p theo sá»‘ lÆ°á»£ng Ä‘Æ¡n hÃ ng giáº£m dáº§n.  

---

âœ… **TÃ³m táº¯t NgÃ y 9:**  
âœ”ï¸ `GROUP BY` - NhÃ³m dá»¯ liá»‡u theo má»™t hoáº·c nhiá»u cá»™t.  
âœ”ï¸ `HAVING` - Lá»c dá»¯ liá»‡u sau khi nhÃ³m (`WHERE` khÃ´ng dÃ¹ng Ä‘Æ°á»£c vá»›i Aggregate Functions).  
âœ”ï¸ Káº¿t há»£p vá»›i `ORDER BY` Ä‘á»ƒ sáº¯p xáº¿p káº¿t quáº£.  

ğŸš€ **Tiáº¿p theo:** Há»c vá» [`JOIN` Ä‘á»ƒ káº¿t ná»‘i nhiá»u báº£ng dá»¯ liá»‡u](10.%20JOIN.md)!

ğŸ“Œ **Lá»™ trÃ¬nh:** [Há»c SQL trong 30 ngÃ y](00.%2030-Day%20SQL%20Learning%20Roadmap.md)