---
title: 22. SQL Json practice
slug: 22-sql-json-practice
description: Gi·ªõi thi·ªáu v·ªÅ ki·ªÉu d·ªØ li·ªáu JSON trong SQL v√† c√°ch truy v·∫•n d·ªØ li·ªáu JSON trong SQL.
image: https://tiennhm.github.io/img/docs/database.jpg
sidebar_position: 22
# sidebar_class_name: hidden
tags:
    - database
    - sql
    - learn-sql
    - roadmap
    - dbms
keywords: [database, sql, learn-sql, roadmap, dbms]
enableComments: true # for Gisqus comments, set to true
draft: false # set to true to hide this post from the site
---

> M·ª•c ti√™u b√†i h·ªçc: T√¨m hi·ªÉu v·ªÅ ki·ªÉu d·ªØ li·ªáu JSON trong SQL v√† c√°ch truy v·∫•n d·ªØ li·ªáu JSON trong SQL.

## 1. Gi·ªõi thi·ªáu
D·ªØ li·ªáu JSON ("JavaScript Object Notation") l√† ƒë·ªãnh d·∫°ng ph·ªï bi·∫øn trong c√°c h·ªá th·ªëng hi·ªán ƒë·∫°i, gi√∫p truy·ªÅn d·ªØ li·ªáu gi·ªØa client v√† server, l√†m vi·ªác v·ªõi API, v.v. SQL cung c·∫•p c√°c c√¥ng c·ª• x·ª≠ l√Ω JSON ngay trong c∆° s·ªü d·ªØ li·ªáu.

### 1.1. JSON trong PostgreSQL/MySQL
- **PostgreSQL**: Cung c·∫•p ki·ªÉu d·ªØ li·ªáu `JSON` v√† `JSONB` (d·∫°ng nh·ªã ph√¢n t√≠ch t·ªët h∆°n).
- **MySQL**: H·ªó tr·ª£ ki·ªÉu `JSON` t·ª´ phi√™n b·∫£n 5.7 tr·ªü l√™n, cho ph√©p truy v·∫•n, l·ªçc v√† ch·ªânh s·ª≠a JSON nh∆∞ c√°c tr∆∞·ªùng d√¢y k√Ω t·ª±.

## 2. C√°ch l∆∞u tr·ªØ v√† truy v·∫•n JSON trong SQL

### 2.1. T·∫°o b·∫£ng ch·ª©a d·ªØ li·ªáu JSON
- Trong PostgreSQL, s·ª≠ d·ª•ng ki·ªÉu d·ªØ li·ªáu `JSONB`:
```sql
CREATE TABLE customers (
    id SERIAL PRIMARY KEY,
    name VARCHAR(100),
    details JSONB -- PostgreSQL
);
```

- Trong MySQL, s·ª≠ d·ª•ng ki·ªÉu d·ªØ li·ªáu `JSON`:
```sql
CREATE TABLE customers (
    id INT AUTO_INCREMENT PRIMARY KEY,
    name VARCHAR(100),
    details JSON -- MySQL
);
```

### 2.2. Ch√®n d·ªØ li·ªáu JSON
```sql
INSERT INTO customers (name, details) VALUES
('John Doe', '{"age": 30, "city": "New York", "email": "john@example.com"}'),
('Jane Smith', '{"age": 25, "city": "Los Angeles", "email": "jane@example.com"}');
```

### 2.3. Truy v·∫•n d·ªØ li·ªáu JSON
- L·∫•y gi√° tr·ªã c·ª• th·ªÉ t·ª´ JSON:
```sql
-- PostgreSQL
SELECT name, details->>'city' AS city FROM customers;

-- MySQL
SELECT name, JSON_UNQUOTE(details->'$.city') AS city FROM customers;
```

- T√¨m kh√°ch h√†ng trong m·ªôt th√†nh ph·ªë nh·∫•t ƒë·ªãnh:
```sql
-- PostgreSQL
SELECT * FROM customers WHERE details->>'city' = 'New York';

-- MySQL
SELECT * FROM customers WHERE JSON_UNQUOTE(details->'$.city') = 'New York';
```

## 3. B√†i t·∫≠p th·ª±c h√†nh

### B√†i 1: Th√™m tr∆∞·ªùng "phone" v√†o JSON
> **Y√™u c·∫ßu**: C·∫≠p nh·∫≠t b·∫£ng `customers` th√™m tr∆∞·ªùng `phone` v√†o JSON cho m·ªói kh√°ch h√†ng.

**G·ª£i √Ω ƒë√°p √°n:**
```sql
 -- PostgreSQL
UPDATE customers
SET details = jsonb_set(details, '{phone}', '"123-456-7890"')
WHERE name = 'John Doe';

-- MySQL
UPDATE customers
SET details = JSON_SET(details, '$.phone', '"123-456-7890"')
WHERE name = 'John Doe';
```

### B√†i 2: T√≠nh tu·ªïi trung b√¨nh c·ªßa kh√°ch h√†ng
> **Y√™u c·∫ßu**: T√≠nh tu·ªïi trung b√¨nh t·ª´ tr∆∞·ªùng `age` trong JSON.

**G·ª£i √Ω ƒë√°p √°n:**
```sql
 -- PostgreSQL
SELECT AVG((details->>'age')::INT) AS avg_age FROM customers;

-- MySQL
SELECT AVG(CAST(JSON_UNQUOTE(details->'$.age') AS UNSIGNED)) AS avg_age FROM customers;
```

### B√†i 3: L·ªçc danh s√°ch kh√°ch h√†ng c√≥ email k·∫øt th√∫c b·∫±ng "@example.com"
> **Y√™u c·∫ßu**: L·ªçc danh s√°ch kh√°ch h√†ng c√≥ email thu·ªôc d√£y `@example.com`.

**G·ª£i √Ω ƒë√°p √°n:**
```sql
-- PostgreSQL
SELECT * FROM customers WHERE details->>'email' LIKE '%@example.com';

-- MySQL
SELECT * FROM customers WHERE JSON_UNQUOTE(details->'$.email') LIKE '%@example.com';
```

## 4. T·ªïng k·∫øt b√†i h·ªçc
- JSON trong SQL gi√∫p l∆∞u tr·ªØ d·ªØ li·ªáu linh ho·∫°t h∆°n, nh∆∞ng c·∫ßn bi·∫øt khi n√†o n√™n d√πng JSON thay v√¨ c√°c b·∫£ng quan h·ªá.
- PostgreSQL v√† MySQL h·ªó tr·ª£ truy v·∫•n JSON v·ªõi c√°c h√†m nh∆∞ `jsonb_set`, `JSON_UNQUOTE`, v.v.
- Th·ª±c h√†nh v·ªõi JSON gi√∫p qu·∫£n l√Ω d·ªØ li·ªáu linh ho·∫°t h∆°n, ƒë·∫∑c bi·ªát trong c√°c h·ªá th·ªëng API.

---

üöÄ **Ng√†y mai:** [K·∫øt n·ªëi SQL v·ªõi ·ª©ng d·ª•ng.](23.%20SQL%20connect%20apps.md)

üìå **L·ªô tr√¨nh:** [H·ªçc SQL trong 30 ng√†y](00.%2030-Day%20SQL%20Learning%20Roadmap.md).
