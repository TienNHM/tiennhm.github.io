---
title: 24. Import - Export data
slug: 24-import-export-data
description: Hi·ªÉu c√°ch nh·∫≠p d·ªØ li·ªáu t·ª´ file CSV, Excel v√†o SQL, xu·∫•t d·ªØ li·ªáu t·ª´ SQL ra file CSV, Excel v√† s·ª≠ d·ª•ng c√°c l·ªánh LOAD DATA INFILE, COPY, SELECT INTO OUTFILE ƒë·ªÉ x·ª≠ l√Ω d·ªØ li·ªáu.
image: https://tiennhm.github.io/img/docs/database.jpg
sidebar_position: 24
# sidebar_class_name: hidden
tags:
    - database
    - sql
    - learn-sql
    - roadmap
    - dbms
keywords: [database, sql, learn-sql, roadmap, dbms]
enableComments: true # for Gisqus comments, set to true
draft: false # set to true to hide this post from the site
---

# **Ng√†y 24: Nh·∫≠p & Xu·∫•t d·ªØ li·ªáu CSV, Excel**  

#### üéØ **M·ª•c ti√™u h·ªçc t·∫≠p**
- Hi·ªÉu c√°ch nh·∫≠p d·ªØ li·ªáu t·ª´ file CSV, Excel v√†o SQL.
- Xu·∫•t d·ªØ li·ªáu t·ª´ SQL ra file CSV, Excel.
- S·ª≠ d·ª•ng c√°c l·ªánh **LOAD DATA INFILE**, **COPY**, **SELECT INTO OUTFILE** ƒë·ªÉ x·ª≠ l√Ω d·ªØ li·ªáu.

---

## üìù **1. Nh·∫≠p d·ªØ li·ªáu t·ª´ CSV v√†o SQL**  

### üîπ **1.1. MySQL: LOAD DATA INFILE**
**C√∫ ph√°p:**
```sql
LOAD DATA INFILE 'C:/data/products.csv'
INTO TABLE products
FIELDS TERMINATED BY ',' 
ENCLOSED BY '"' 
LINES TERMINATED BY '\n'
IGNORE 1 ROWS;
```
üìå **L∆∞u √Ω:** C·∫ßn b·∫≠t ch·∫ø ƒë·ªô `LOCAL INFILE` n·∫øu b·ªã l·ªói:
```sql
SET GLOBAL local_infile = 1;
```

---

### üîπ **1.2. PostgreSQL: COPY**
```sql
COPY products(id, name, price)
FROM 'C:/data/products.csv'
DELIMITER ',' 
CSV HEADER;
```

---

### üîπ **1.3. SQL Server: BULK INSERT**
```sql
BULK INSERT products
FROM 'C:\data\products.csv'
WITH (
    FORMAT = 'CSV',
    FIRSTROW = 2,
    FIELDTERMINATOR = ',',
    ROWTERMINATOR = '\n'
);
```

---

## üìù **2. Xu·∫•t d·ªØ li·ªáu t·ª´ SQL ra CSV**  

### üîπ **2.1. MySQL: SELECT INTO OUTFILE**
```sql
SELECT * FROM products
INTO OUTFILE 'C:/data/products_export.csv'
FIELDS TERMINATED BY ',' 
ENCLOSED BY '"'
LINES TERMINATED BY '\n';
```

---

### üîπ **2.2. PostgreSQL: COPY**
```sql
COPY products TO 'C:/data/products_export.csv' 
DELIMITER ',' 
CSV HEADER;
```

---

### üîπ **2.3. SQL Server: EXPORT DATA**
```sql
SELECT * 
INTO OPENROWSET('Microsoft.ACE.OLEDB.12.0', 
                'Text;Database=C:\data;',
                'SELECT * FROM products_export.csv')
FROM products;
```

---

## üìù **3. Xu·∫•t d·ªØ li·ªáu t·ª´ SQL ra Excel**  

- **C√°ch 1:** D√πng c√¥ng c·ª• SQL Server Management Studio (SSMS) ho·∫∑c MySQL Workbench ƒë·ªÉ export d·ªØ li·ªáu ra Excel.
- **C√°ch 2:** D√πng Python:
  ```python
  import pandas as pd
  import sqlite3

  conn = sqlite3.connect('database.db')
  df = pd.read_sql_query("SELECT * FROM products", conn)
  df.to_excel("products_export.xlsx", index=False)
  ```
- **C√°ch 3:** PostgreSQL:
  ```sql
  COPY (SELECT * FROM products) 
  TO 'C:/data/products.xlsx' 
  WITH (FORMAT CSV, HEADER);
  ```

---

## üéØ **B√†i t·∫≠p th·ª±c h√†nh**

### **B√†i 1: T·∫°o b·∫£ng `students` v√† nh·∫≠p d·ªØ li·ªáu t·ª´ CSV**
#### **Y√™u c·∫ßu:**  
- T·∫°o b·∫£ng `students` g·ªìm c√°c c·ªôt: `id` (s·ªë nguy√™n, kh√≥a ch√≠nh), `name` (chu·ªói k√Ω t·ª±), `dob` (ng√†y sinh).  
- Nh·∫≠p d·ªØ li·ªáu t·ª´ file `students.csv` (d·∫°ng: `id,name,dob`).  

üîπ **G·ª£i √Ω ƒë√°p √°n (MySQL):**
```sql
CREATE TABLE students (
    id INT PRIMARY KEY,
    name VARCHAR(255),
    dob DATE
);

LOAD DATA INFILE 'C:/data/students.csv'
INTO TABLE students
FIELDS TERMINATED BY ',' 
ENCLOSED BY '"' 
LINES TERMINATED BY '\n'
IGNORE 1 ROWS;
```

üîπ **G·ª£i √Ω ƒë√°p √°n (PostgreSQL):**
```sql
COPY students(id, name, dob)
FROM 'C:/data/students.csv'
DELIMITER ',' 
CSV HEADER;
```

---

### **B√†i 2: Xu·∫•t danh s√°ch sinh vi√™n ra file CSV**
#### **Y√™u c·∫ßu:**  
- Xu·∫•t d·ªØ li·ªáu t·ª´ b·∫£ng `students` ra file `students_export.csv`.  

üîπ **G·ª£i √Ω ƒë√°p √°n (MySQL):**
```sql
SELECT * FROM students
INTO OUTFILE 'C:/data/students_export.csv'
FIELDS TERMINATED BY ',' 
ENCLOSED BY '"'
LINES TERMINATED BY '\n';
```

üîπ **G·ª£i √Ω ƒë√°p √°n (PostgreSQL):**
```sql
COPY students TO 'C:/data/students_export.csv' 
DELIMITER ',' 
CSV HEADER;
```

---

### **B√†i 3: Xu·∫•t d·ªØ li·ªáu t·ª´ `students` ra file Excel**
#### **Y√™u c·∫ßu:**  
- Xu·∫•t d·ªØ li·ªáu t·ª´ b·∫£ng `students` ra file Excel `students.xlsx` b·∫±ng Python.  

üîπ **G·ª£i √Ω ƒë√°p √°n (Python + SQLite):**
```python
import pandas as pd
import sqlite3

conn = sqlite3.connect('database.db')
df = pd.read_sql_query("SELECT * FROM students", conn)
df.to_excel("students.xlsx", index=False)
conn.close()
```

---

#### üìå **T√≥m t·∫Øt b√†i h·ªçc**
- **Nh·∫≠p CSV:** `LOAD DATA INFILE` (MySQL), `COPY` (PostgreSQL), `BULK INSERT` (SQL Server).
- **Xu·∫•t CSV:** `SELECT INTO OUTFILE`, `COPY`, `BULK INSERT`.
- **Xu·∫•t Excel:** D√πng Python (`pandas`), SSMS, ho·∫∑c MySQL Workbench.

---

üöÄ **Ti·∫øp theo:** [L√†m vi·ªác v·ªõi d·ªØ li·ªáu l·ªõn (Big Data)](25.%20Big%20Data.md).

üìå **L·ªô tr√¨nh:** [H·ªçc SQL trong 30 ng√†y](00.%2030-Day%20SQL%20Learning%20Roadmap.md).
