"use strict";(self.webpackChunktiennhm_github_io=self.webpackChunktiennhm_github_io||[]).push([[9428],{10457:(n,e,s)=>{s.r(e),s.d(e,{assets:()=>l,contentTitle:()=>r,default:()=>d,frontMatter:()=>c,metadata:()=>o,toc:()=>h});var t=s(74848),i=s(28453);const c={title:"3.02 | Missing Function Level Access Control",slug:"missing-function-level-access-control-02",description:"B\xe0i vi\u1ebft n\xe0y s\u1ebd h\u01b0\u1edbng d\u1eabn c\xe1ch t\u1ea5n c\xf4ng Missing Function Level Access Control tr\xean WebGoat 2023.8",image:"https://tiennhm.github.io/img/docs/database.jpg",sidebar_position:3,tags:["web-security","webgoat","broken-access-control","missing-function-level-access-control","webgoat-2023.8"],keywords:["web-security","webgoat","broken-access-control","missing-function-level-access-control","webgoat-2023.8"],enableComments:!0,draft:!1},r=void 0,o={id:"web-security/webgoat-2023.8/A1-Broken-Access-Control/Missing-Function-Level-Access-Control-02",title:"3.02 | Missing Function Level Access Control",description:"B\xe0i vi\u1ebft n\xe0y s\u1ebd h\u01b0\u1edbng d\u1eabn c\xe1ch t\u1ea5n c\xf4ng Missing Function Level Access Control tr\xean WebGoat 2023.8",source:"@site/docs/02-web-security/webgoat-2023.8/A1-Broken-Access-Control/Missing-Function-Level-Access-Control-02.md",sourceDirName:"02-web-security/webgoat-2023.8/A1-Broken-Access-Control",slug:"/web-security/webgoat-2023.8/A1-Broken-Access-Control/missing-function-level-access-control-02",permalink:"/en/docs/web-security/webgoat-2023.8/A1-Broken-Access-Control/missing-function-level-access-control-02",draft:!1,unlisted:!1,editUrl:"https://github.com/TienNHM/tiennhm.github.io/tree/master/docs/02-web-security/webgoat-2023.8/A1-Broken-Access-Control/Missing-Function-Level-Access-Control-02.md",tags:[{inline:!0,label:"web-security",permalink:"/en/docs/tags/web-security"},{inline:!0,label:"webgoat",permalink:"/en/docs/tags/webgoat"},{inline:!0,label:"broken-access-control",permalink:"/en/docs/tags/broken-access-control"},{inline:!0,label:"missing-function-level-access-control",permalink:"/en/docs/tags/missing-function-level-access-control"},{inline:!0,label:"webgoat-2023.8",permalink:"/en/docs/tags/webgoat-2023-8"}],version:"current",lastUpdatedAt:1742149476e3,sidebarPosition:3,frontMatter:{title:"3.02 | Missing Function Level Access Control",slug:"missing-function-level-access-control-02",description:"B\xe0i vi\u1ebft n\xe0y s\u1ebd h\u01b0\u1edbng d\u1eabn c\xe1ch t\u1ea5n c\xf4ng Missing Function Level Access Control tr\xean WebGoat 2023.8",image:"https://tiennhm.github.io/img/docs/database.jpg",sidebar_position:3,tags:["web-security","webgoat","broken-access-control","missing-function-level-access-control","webgoat-2023.8"],keywords:["web-security","webgoat","broken-access-control","missing-function-level-access-control","webgoat-2023.8"],enableComments:!0,draft:!1},sidebar:"tutorialSidebar",previous:{title:"3.01 | Missing Function Level Access Control",permalink:"/en/docs/web-security/webgoat-2023.8/A1-Broken-Access-Control/missing-function-level-access-control-01"},next:{title:"3.03 | Missing Function Level Access Control",permalink:"/en/docs/web-security/webgoat-2023.8/A1-Broken-Access-Control/missing-function-level-access-control-03"}},l={},h=[{value:"\u2705 <strong>1\ufe0f\u20e3 L\u1ed7 h\u1ed5ng &quot;Relying on Obscurity&quot; l\xe0 g\xec?</strong>",id:"-1\ufe0f\u20e3-l\u1ed7-h\u1ed5ng-relying-on-obscurity-l\xe0-g\xec",level:2},{value:"\ud83d\ude80 <strong>2\ufe0f\u20e3 C\xe1ch t\xecm Menu \u1ea9n trong WebGoat</strong>",id:"-2\ufe0f\u20e3-c\xe1ch-t\xecm-menu-\u1ea9n-trong-webgoat",level:2},{value:"\ud83d\udd12 <strong>3\ufe0f\u20e3 Gi\u1ea3i ph\xe1p b\u1ea3o m\u1eadt</strong>",id:"-3\ufe0f\u20e3-gi\u1ea3i-ph\xe1p-b\u1ea3o-m\u1eadt",level:2},{value:"\u2705 <strong>1. Kh\xf4ng d\u1ef1a v\xe0o UI \u0111\u1ec3 b\u1ea3o m\u1eadt</strong>",id:"-1-kh\xf4ng-d\u1ef1a-v\xe0o-ui-\u0111\u1ec3-b\u1ea3o-m\u1eadt",level:3},{value:"\u2705 <strong>2. Ki\u1ec3m so\xe1t hi\u1ec3n th\u1ecb tr\xean Server (Kh\xf4ng hi\u1ec3n th\u1ecb n\u1ebfu kh\xf4ng c\xf3 quy\u1ec1n)</strong>",id:"-2-ki\u1ec3m-so\xe1t-hi\u1ec3n-th\u1ecb-tr\xean-server-kh\xf4ng-hi\u1ec3n-th\u1ecb-n\u1ebfu-kh\xf4ng-c\xf3-quy\u1ec1n",level:3},{value:"\u2705 <strong>3. Ghi log m\u1ecdi truy c\u1eadp \u0111\xe1ng ng\u1edd</strong>",id:"-3-ghi-log-m\u1ecdi-truy-c\u1eadp-\u0111\xe1ng-ng\u1edd",level:3},{value:"\ud83d\udd25 <strong>4\ufe0f\u20e3 T\xf3m t\u1eaft &amp; K\u1ebft lu\u1eadn</strong>",id:"-4\ufe0f\u20e3-t\xf3m-t\u1eaft--k\u1ebft-lu\u1eadn",level:2}];function g(n){const e={a:"a",blockquote:"blockquote",br:"br",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...n.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(e.blockquote,{children:["\n",(0,t.jsxs)(e.p,{children:["\ud83d\udd25 ",(0,t.jsx)(e.strong,{children:'Ph\xe2n t\xedch l\u1ed7 h\u1ed5ng "Relying on Obscurity" & C\xe1ch t\xecm Menu \u1ea9n'})]}),"\n"]}),"\n",(0,t.jsxs)(e.h2,{id:"-1\ufe0f\u20e3-l\u1ed7-h\u1ed5ng-relying-on-obscurity-l\xe0-g\xec",children:["\u2705 ",(0,t.jsx)(e.strong,{children:'1\ufe0f\u20e3 L\u1ed7 h\u1ed5ng "Relying on Obscurity" l\xe0 g\xec?'})]}),"\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.strong,{children:"\ud83d\udccc \u0110\u1ecbnh ngh\u0129a:"}),(0,t.jsx)(e.br,{}),"\n","Nhi\u1ec1u \u1ee9ng d\u1ee5ng c\u1ed1 g\u1eafng b\u1ea3o m\u1eadt b\u1eb1ng c\xe1ch ",(0,t.jsx)(e.strong,{children:"\u1ea9n c\xe1c t\xednh n\u0103ng quan tr\u1ecdng"})," thay v\xec ki\u1ec3m so\xe1t truy c\u1eadp th\u1ef1c s\u1ef1. \u0110i\u1ec1u n\xe0y nguy hi\u1ec3m v\xec ",(0,t.jsx)(e.strong,{children:"hacker c\xf3 th\u1ec3 d\u1ec5 d\xe0ng t\xecm ra"})," v\xe0 khai th\xe1c."]}),"\n",(0,t.jsxs)(e.p,{children:["\ud83d\udccc ",(0,t.jsx)(e.strong,{children:"V\xed d\u1ee5 th\u1ef1c t\u1ebf:"})]}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:["\u1ea8n n\xfat b\u1eb1ng ",(0,t.jsxs)(e.strong,{children:["CSS (",(0,t.jsx)(e.code,{children:"display: none"}),")"]})]}),"\n",(0,t.jsxs)(e.li,{children:["\u1ea8n ph\u1ea7n t\u1eed b\u1eb1ng ",(0,t.jsxs)(e.strong,{children:["JavaScript (",(0,t.jsx)(e.code,{children:"if (!isAdmin) hideMenu()"}),")"]})]}),"\n",(0,t.jsxs)(e.li,{children:["\u1ea8n \u0111\u01b0\u1eddng d\u1eabn ",(0,t.jsx)(e.strong,{children:"URL admin"})]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Comment"})," m\xe3 ngu\u1ed3n HTML ch\u1ee9a th\xf4ng tin nh\u1ea1y c\u1ea3m"]}),"\n"]}),"\n",(0,t.jsxs)(e.p,{children:["\ud83d\udea8 ",(0,t.jsx)(e.strong,{children:"Nguy hi\u1ec3m"}),": Hacker c\xf3 th\u1ec3 ",(0,t.jsx)(e.strong,{children:"b\u1eadt l\u1ea1i, xem ho\u1eb7c \u0111o\xe1n \u0111\u01b0\u1ee3c"})," c\xe1c ph\u1ea7n b\u1ecb \u1ea9n m\u1ed9t c\xe1ch d\u1ec5 d\xe0ng."]}),"\n",(0,t.jsxs)(e.h2,{id:"-2\ufe0f\u20e3-c\xe1ch-t\xecm-menu-\u1ea9n-trong-webgoat",children:["\ud83d\ude80 ",(0,t.jsx)(e.strong,{children:"2\ufe0f\u20e3 C\xe1ch t\xecm Menu \u1ea9n trong WebGoat"})]}),"\n",(0,t.jsxs)(e.p,{children:["Gi\u1ea3 s\u1eed ",(0,t.jsx)(e.strong,{children:"menu hi\u1ec3n th\u1ecb tr\xean UI"})," nh\u01b0 sau:"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-html",children:'<ul id="menu">\n    <li>WebGoat</li>\n    <li>Account</li>\n    <li>Messages</li>\n    \x3c!-- <li>Users</li> --\x3e\n    <li style="display: none;">Config</li>\n</ul>\n'})}),"\n",(0,t.jsxs)(e.p,{children:["\ud83d\udccc ",(0,t.jsx)(e.strong,{children:"C\xe1c c\xe1ch hacker c\xf3 th\u1ec3 ph\xe1t hi\u1ec7n menu \u1ea9n:"}),(0,t.jsx)(e.br,{}),"\n","\u2705 ",(0,t.jsx)(e.strong,{children:'D\xf9ng "View Source" (Ctrl + U)'})," \u2192 T\xecm c\xe1c ph\u1ea7n t\u1eed b\u1ecb comment (",(0,t.jsx)(e.code,{children:"\x3c!-- Users --\x3e"}),")",(0,t.jsx)(e.br,{}),"\n","\u2705 ",(0,t.jsx)(e.strong,{children:"D\xf9ng DevTools (F12 \u2192 Elements)"})," \u2192 Ki\u1ec3m tra ",(0,t.jsx)(e.strong,{children:(0,t.jsx)(e.code,{children:"display: none;"})})," v\xe0 ch\u1ec9nh s\u1eeda",(0,t.jsx)(e.br,{}),"\n","\u2705 ",(0,t.jsx)(e.strong,{children:"Ki\u1ec3m tra JavaScript"})," \u2192 Xem file ",(0,t.jsx)(e.code,{children:".js"})," c\xf3 \u1ea9n n\u1ed9i dung kh\xf4ng",(0,t.jsx)(e.br,{}),"\n","\u2705 ",(0,t.jsx)(e.strong,{children:"S\u1eed d\u1ee5ng API Scanner"})," \u2192 Ki\u1ec3m tra ",(0,t.jsx)(e.code,{children:"/users"}),", ",(0,t.jsx)(e.code,{children:"/admin"}),", ",(0,t.jsx)(e.code,{children:"/config"})," c\xf3 t\u1ed3n t\u1ea1i kh\xf4ng"]}),"\n",(0,t.jsxs)(e.p,{children:["\ud83c\udfaf ",(0,t.jsx)(e.strong,{children:"K\u1ebft qu\u1ea3 t\xecm th\u1ea5y hai m\u1ee5c menu \u1ea9n:"}),(0,t.jsx)(e.br,{}),"\n","\ud83d\udd0d ",(0,t.jsx)(e.strong,{children:"Hidden item 1:"})," ",(0,t.jsx)(e.code,{children:"Users"}),(0,t.jsx)(e.br,{}),"\n","\ud83d\udd0d ",(0,t.jsx)(e.strong,{children:"Hidden item 2:"})," ",(0,t.jsx)(e.code,{children:"Config"})]}),"\n",(0,t.jsxs)(e.h2,{id:"-3\ufe0f\u20e3-gi\u1ea3i-ph\xe1p-b\u1ea3o-m\u1eadt",children:["\ud83d\udd12 ",(0,t.jsx)(e.strong,{children:"3\ufe0f\u20e3 Gi\u1ea3i ph\xe1p b\u1ea3o m\u1eadt"})]}),"\n",(0,t.jsxs)(e.h3,{id:"-1-kh\xf4ng-d\u1ef1a-v\xe0o-ui-\u0111\u1ec3-b\u1ea3o-m\u1eadt",children:["\u2705 ",(0,t.jsx)(e.strong,{children:"1. Kh\xf4ng d\u1ef1a v\xe0o UI \u0111\u1ec3 b\u1ea3o m\u1eadt"})]}),"\n",(0,t.jsxs)(e.p,{children:["\u274c ",(0,t.jsx)(e.strong,{children:"Sai:"})," \u1ea8n b\u1eb1ng ",(0,t.jsx)(e.code,{children:"display: none;"})," ho\u1eb7c JavaScript",(0,t.jsx)(e.br,{}),"\n","\u2705 ",(0,t.jsx)(e.strong,{children:"\u0110\xfang:"})," Ki\u1ec3m so\xe1t quy\u1ec1n truy c\u1eadp tr\xean Backend"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-csharp",children:'[Authorize(Roles = "Admin")]\npublic IActionResult Users()\n{\n    return View();\n}\n'})}),"\n",(0,t.jsxs)(e.h3,{id:"-2-ki\u1ec3m-so\xe1t-hi\u1ec3n-th\u1ecb-tr\xean-server-kh\xf4ng-hi\u1ec3n-th\u1ecb-n\u1ebfu-kh\xf4ng-c\xf3-quy\u1ec1n",children:["\u2705 ",(0,t.jsx)(e.strong,{children:"2. Ki\u1ec3m so\xe1t hi\u1ec3n th\u1ecb tr\xean Server (Kh\xf4ng hi\u1ec3n th\u1ecb n\u1ebfu kh\xf4ng c\xf3 quy\u1ec1n)"})]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-csharp",children:'@if (User.IsInRole("Admin"))\n{\n    <li><a href="/users">Users</a></li>\n}\n'})}),"\n",(0,t.jsxs)(e.p,{children:["\ud83d\udccc ",(0,t.jsx)(e.strong,{children:"K\u1ebft qu\u1ea3:"})]}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Ng\u01b0\u1eddi d\xf9ng th\u01b0\u1eddng"})," kh\xf4ng th\u1ea5y menu ",(0,t.jsx)(e.strong,{children:"Users"})]}),"\n",(0,t.jsx)(e.li,{children:(0,t.jsx)(e.strong,{children:"Hacker kh\xf4ng th\u1ec3 th\u1ea5y d\xf9 d\xf9ng DevTools"})}),"\n"]}),"\n",(0,t.jsxs)(e.h3,{id:"-3-ghi-log-m\u1ecdi-truy-c\u1eadp-\u0111\xe1ng-ng\u1edd",children:["\u2705 ",(0,t.jsx)(e.strong,{children:"3. Ghi log m\u1ecdi truy c\u1eadp \u0111\xe1ng ng\u1edd"})]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-csharp",children:'_logger.LogWarning($"Unauthorized access attempt: {HttpContext.User.Identity.Name} tried to access /config");\n'})}),"\n",(0,t.jsxs)(e.p,{children:["\ud83d\udccc ",(0,t.jsx)(e.strong,{children:"K\u1ebft qu\u1ea3:"})]}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:["Ghi l\u1ea1i ",(0,t.jsx)(e.strong,{children:"t\u1ea5t c\u1ea3 truy c\u1eadp \u0111\xe1ng ng\u1edd"})]}),"\n",(0,t.jsxs)(e.li,{children:["Gi\xfap ph\xe1t hi\u1ec7n hacker ",(0,t.jsx)(e.strong,{children:"s\u1edbm h\u01a1n"})]}),"\n"]}),"\n",(0,t.jsxs)(e.h2,{id:"-4\ufe0f\u20e3-t\xf3m-t\u1eaft--k\u1ebft-lu\u1eadn",children:["\ud83d\udd25 ",(0,t.jsx)(e.strong,{children:"4\ufe0f\u20e3 T\xf3m t\u1eaft & K\u1ebft lu\u1eadn"})]}),"\n",(0,t.jsxs)(e.table,{children:[(0,t.jsx)(e.thead,{children:(0,t.jsxs)(e.tr,{children:[(0,t.jsxs)(e.th,{children:["\u274c ",(0,t.jsx)(e.strong,{children:"Sai l\u1ea7m"})]}),(0,t.jsxs)(e.th,{children:["\u2705 ",(0,t.jsx)(e.strong,{children:"C\xe1ch s\u1eeda"})]})]})}),(0,t.jsxs)(e.tbody,{children:[(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"\u1ea8n menu b\u1eb1ng CSS ho\u1eb7c JS"}),(0,t.jsx)(e.td,{children:"Ki\u1ec3m so\xe1t truy c\u1eadp t\u1eeb Backend"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"Ch\u1ec9 ch\u1eb7n hi\u1ec3n th\u1ecb tr\xean Frontend"}),(0,t.jsx)(e.td,{children:"\u1ea8n n\u1ed9i dung t\u1eeb Server"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"Kh\xf4ng gi\xe1m s\xe1t truy c\u1eadp"}),(0,t.jsx)(e.td,{children:"Ghi log m\u1ecdi request \u0111\xe1ng ng\u1edd"})]})]})]}),"\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.strong,{children:"\ud83d\udccc B\xe0i h\u1ecdc r\xfat ra:"}),(0,t.jsx)(e.br,{}),"\n",(0,t.jsx)(e.strong,{children:'"B\u1ea3o m\u1eadt th\u1ef1c s\u1ef1 kh\xf4ng n\u1eb1m \u1edf vi\u1ec7c \u1ea9n gi\u1ea5u, m\xe0 \u1edf vi\u1ec7c ki\u1ec3m so\xe1t quy\u1ec1n truy c\u1eadp \u0111\xfang c\xe1ch!"'})," \ud83d\ude80"]}),"\n",(0,t.jsxs)(e.p,{children:["Xem chi ti\u1ebft t\u1ea1i ",(0,t.jsx)(e.a,{href:"https://docs.cycubix.com/application-security-series/web-application-security-essentials/solutions/a5-broken-access-control/a1-2021-or-missing-function-level-access-control-or-cycubix-docs/missing-function-level-access-control-2",children:"\u0111\xe2y"}),"."]})]})}function d(n={}){const{wrapper:e}={...(0,i.R)(),...n.components};return e?(0,t.jsx)(e,{...n,children:(0,t.jsx)(g,{...n})}):g(n)}},28453:(n,e,s)=>{s.d(e,{R:()=>r,x:()=>o});var t=s(96540);const i={},c=t.createContext(i);function r(n){const e=t.useContext(c);return t.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function o(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(i):n.components||i:r(n.components),t.createElement(c.Provider,{value:e},n.children)}}}]);