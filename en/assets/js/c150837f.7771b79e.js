"use strict";(globalThis.webpackChunktiennhm_github_io=globalThis.webpackChunktiennhm_github_io||[]).push([[8952],{28453:(n,t,e)=>{e.d(t,{R:()=>c,x:()=>o});var i=e(96540);const r={},s=i.createContext(r);function c(n){const t=i.useContext(s);return i.useMemo((function(){return"function"==typeof n?n(t):{...t,...n}}),[t,n])}function o(n){let t;return t=n.disableParentContext?"function"==typeof n.components?n.components(r):n.components||r:c(n.components),i.createElement(s.Provider,{value:t},n.children)}},64294:(n,t,e)=>{e.r(t),e.d(t,{assets:()=>a,contentTitle:()=>o,default:()=>g,frontMatter:()=>c,metadata:()=>i,toc:()=>h});const i=JSON.parse('{"id":"web-security/webgoat-2023.8/A5-Security-Misconfiguration/XXE-12","title":"1.12 | XXE","description":"B\xe0i vi\u1ebft n\xe0y s\u1ebd h\u01b0\u1edbng d\u1eabn c\xe1ch t\u1ea5n c\xf4ng XXE tr\xean WebGoat 2023.8","source":"@site/docs/02-web-security/webgoat-2023.8/A5-Security-Misconfiguration/XXE-12.md","sourceDirName":"02-web-security/webgoat-2023.8/A5-Security-Misconfiguration","slug":"/web-security/webgoat-2023.8/A5-Security-Misconfiguration/XXE-12","permalink":"/en/docs/web-security/webgoat-2023.8/A5-Security-Misconfiguration/XXE-12","draft":false,"unlisted":false,"editUrl":"https://github.com/TienNHM/tiennhm.github.io/tree/master/docs/02-web-security/webgoat-2023.8/A5-Security-Misconfiguration/XXE-12.md","tags":[{"inline":true,"label":"web-security","permalink":"/en/docs/tags/web-security"},{"inline":true,"label":"webgoat","permalink":"/en/docs/tags/webgoat"},{"inline":true,"label":"security-misconfiguration","permalink":"/en/docs/tags/security-misconfiguration"},{"inline":true,"label":"xxe","permalink":"/en/docs/tags/xxe"},{"inline":true,"label":"webgoat-2023.8","permalink":"/en/docs/tags/webgoat-2023-8"}],"version":"current","lastUpdatedAt":1761985702000,"sidebarPosition":1,"frontMatter":{"title":"1.12 | XXE","slug":"XXE-12","description":"B\xe0i vi\u1ebft n\xe0y s\u1ebd h\u01b0\u1edbng d\u1eabn c\xe1ch t\u1ea5n c\xf4ng XXE tr\xean WebGoat 2023.8","image":"https://tiennhm.github.io/img/docs/database.jpg","sidebar_position":1,"tags":["web-security","webgoat","security-misconfiguration","xxe","webgoat-2023.8"],"keywords":["web-security","webgoat","security-misconfiguration","xxe","webgoat-2023.8"],"enableComments":true,"draft":false},"sidebar":"tutorialSidebar","previous":{"title":"1.11 | XXE","permalink":"/en/docs/web-security/webgoat-2023.8/A5-Security-Misconfiguration/XXE-11"},"next":{"title":"1.13 | XXE","permalink":"/en/docs/web-security/webgoat-2023.8/A5-Security-Misconfiguration/XXE-13"}}');var r=e(74848),s=e(28453);const c={title:"1.12 | XXE",slug:"XXE-12",description:"B\xe0i vi\u1ebft n\xe0y s\u1ebd h\u01b0\u1edbng d\u1eabn c\xe1ch t\u1ea5n c\xf4ng XXE tr\xean WebGoat 2023.8",image:"https://tiennhm.github.io/img/docs/database.jpg",sidebar_position:1,tags:["web-security","webgoat","security-misconfiguration","xxe","webgoat-2023.8"],keywords:["web-security","webgoat","security-misconfiguration","xxe","webgoat-2023.8"],enableComments:!0,draft:!1},o=void 0,a={},h=[{value:"<strong>1\ufe0f\u20e3 Ki\u1ec3m so\xe1t v\xe0 x\xe1c th\u1ef1c \u0111\u1ea7u v\xe0o</strong>",id:"1\ufe0f\u20e3-ki\u1ec3m-so\xe1t-v\xe0-x\xe1c-th\u1ef1c-\u0111\u1ea7u-v\xe0o",level:2},{value:"<strong>2\ufe0f\u20e3 C\u1ea5u h\xecnh XML Parser \u0111\u1ec3 v\xf4 hi\u1ec7u h\xf3a DTD v\xe0 External Entities</strong>",id:"2\ufe0f\u20e3-c\u1ea5u-h\xecnh-xml-parser-\u0111\u1ec3-v\xf4-hi\u1ec7u-h\xf3a-dtd-v\xe0-external-entities",level:2},{value:"<strong>3\ufe0f\u20e3 Ki\u1ec3m tra Content-Type v\xe0 Accept Header</strong>",id:"3\ufe0f\u20e3-ki\u1ec3m-tra-content-type-v\xe0-accept-header",level:2},{value:"<strong>4\ufe0f\u20e3 S\u1eed d\u1ee5ng th\u01b0 vi\u1ec7n ch\u1ed1ng XXE</strong>",id:"4\ufe0f\u20e3-s\u1eed-d\u1ee5ng-th\u01b0-vi\u1ec7n-ch\u1ed1ng-xxe",level:2},{value:"<strong>5\ufe0f\u20e3 D\xf9ng JSON thay v\xec XML n\u1ebfu c\xf3 th\u1ec3</strong>",id:"5\ufe0f\u20e3-d\xf9ng-json-thay-v\xec-xml-n\u1ebfu-c\xf3-th\u1ec3",level:2},{value:"<strong>\ud83d\udd12 T\u1ed5ng k\u1ebft</strong>",id:"-t\u1ed5ng-k\u1ebft",level:2}];function l(n){const t={blockquote:"blockquote",br:"br",code:"code",h2:"h2",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...n.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(t.blockquote,{children:["\n",(0,r.jsxs)(t.p,{children:["\ud83d\udee1 ",(0,r.jsx)(t.strong,{children:"XXE Mitigation - C\xe1ch Ph\xf2ng Ch\u1ed1ng XXE"})]}),"\n"]}),"\n",(0,r.jsx)(t.h2,{id:"1\ufe0f\u20e3-ki\u1ec3m-so\xe1t-v\xe0-x\xe1c-th\u1ef1c-\u0111\u1ea7u-v\xe0o",children:(0,r.jsx)(t.strong,{children:"1\ufe0f\u20e3 Ki\u1ec3m so\xe1t v\xe0 x\xe1c th\u1ef1c \u0111\u1ea7u v\xe0o"})}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:"Ch\u1ec9 ch\u1ea5p nh\u1eadn d\u1eef li\u1ec7u XML t\u1eeb ngu\u1ed3n tin c\u1eady."}),"\n",(0,r.jsx)(t.li,{children:"Ki\u1ec3m tra n\u1ed9i dung XML tr\u01b0\u1edbc khi x\u1eed l\xfd."}),"\n",(0,r.jsx)(t.li,{children:"Kh\xf4ng cho ph\xe9p ng\u01b0\u1eddi d\xf9ng nh\u1eadp tr\u1ef1c ti\u1ebfp XML."}),"\n"]}),"\n",(0,r.jsx)(t.h2,{id:"2\ufe0f\u20e3-c\u1ea5u-h\xecnh-xml-parser-\u0111\u1ec3-v\xf4-hi\u1ec7u-h\xf3a-dtd-v\xe0-external-entities",children:(0,r.jsx)(t.strong,{children:"2\ufe0f\u20e3 C\u1ea5u h\xecnh XML Parser \u0111\u1ec3 v\xf4 hi\u1ec7u h\xf3a DTD v\xe0 External Entities"})}),"\n",(0,r.jsxs)(t.p,{children:["Trong ",(0,r.jsx)(t.strong,{children:"Java"}),", b\u1ea1n c\xf3 th\u1ec3 t\u1eaft DTD b\u1eb1ng c\xe1ch:"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-java",children:"XMLInputFactory xif = XMLInputFactory.newFactory();\nxif.setProperty(XMLInputFactory.SUPPORT_DTD, false); // T\u1eaft h\u1ed7 tr\u1ee3 DTD\n"})}),"\n",(0,r.jsx)(t.p,{children:"N\u1ebfu kh\xf4ng th\u1ec3 v\xf4 hi\u1ec7u h\xf3a ho\xe0n to\xe0n DTD, h\xe3y ch\u1eb7n external entities:"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-java",children:"XMLInputFactory xif = XMLInputFactory.newFactory();\nxif.setProperty(XMLInputFactory.IS_SUPPORTING_EXTERNAL_ENTITIES, false); // Ch\u1eb7n external entities\nxif.setProperty(XMLInputFactory.SUPPORT_DTD, true); // Ch\u1ec9 cho ph\xe9p DTD n\u1ed9i b\u1ed9\n"})}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.strong,{children:"L\u01b0u \xfd:"})," C\xe1c th\u01b0 vi\u1ec7n XML kh\xe1c nhau s\u1ebd c\xf3 c\xe1ch c\u1ea5u h\xecnh kh\xe1c nhau. H\xe3y ki\u1ec3m tra theo th\u01b0 vi\u1ec7n b\u1ea1n \u0111ang d\xf9ng."]}),"\n",(0,r.jsx)(t.h2,{id:"3\ufe0f\u20e3-ki\u1ec3m-tra-content-type-v\xe0-accept-header",children:(0,r.jsx)(t.strong,{children:"3\ufe0f\u20e3 Ki\u1ec3m tra Content-Type v\xe0 Accept Header"})}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:["Ch\u1ec9 ch\u1ea5p nh\u1eadn request c\xf3 ",(0,r.jsx)(t.strong,{children:"Content-Type h\u1ee3p l\u1ec7"}),"."]}),"\n",(0,r.jsxs)(t.li,{children:["N\u1ebfu client g\u1eedi Accept Header kh\xf4ng ph\xf9 h\u1ee3p, tr\u1ea3 v\u1ec1 HTTP ",(0,r.jsx)(t.code,{children:"406 Not Acceptable"}),"."]}),"\n"]}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.strong,{children:"V\xed d\u1ee5 trong Spring Boot (Java):"})}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-java",children:'@RequestMapping(value = "/upload", method = RequestMethod.POST, consumes = "application/xml")\npublic ResponseEntity<String> uploadFile(@RequestBody String xmlData) {\n    return new ResponseEntity<>("Received", HttpStatus.OK);\n}\n'})}),"\n",(0,r.jsxs)(t.p,{children:["\ud83d\udd39 ",(0,r.jsx)(t.strong,{children:"Ch\u1eb7n n\u1ebfu Content-Type kh\xf4ng ph\u1ea3i XML"}),"."]}),"\n",(0,r.jsx)(t.h2,{id:"4\ufe0f\u20e3-s\u1eed-d\u1ee5ng-th\u01b0-vi\u1ec7n-ch\u1ed1ng-xxe",children:(0,r.jsx)(t.strong,{children:"4\ufe0f\u20e3 S\u1eed d\u1ee5ng th\u01b0 vi\u1ec7n ch\u1ed1ng XXE"})}),"\n",(0,r.jsx)(t.p,{children:"M\u1ed9t s\u1ed1 th\u01b0 vi\u1ec7n h\u1ed7 tr\u1ee3 b\u1ea3o v\u1ec7 kh\u1ecfi XXE:"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:(0,r.jsx)(t.strong,{children:"OWASP Java XML Parser"})}),"\n",(0,r.jsx)(t.li,{children:(0,r.jsx)(t.strong,{children:"Jackson for XML (kh\xf4ng d\xf9ng DOM ho\u1eb7c SAX tr\u1ef1c ti\u1ebfp)"})}),"\n",(0,r.jsx)(t.li,{children:(0,r.jsx)(t.strong,{children:"DefusedXml (Python)"})}),"\n",(0,r.jsx)(t.li,{children:(0,r.jsx)(t.strong,{children:"SafeXmlParser (.NET)"})}),"\n"]}),"\n",(0,r.jsx)(t.h2,{id:"5\ufe0f\u20e3-d\xf9ng-json-thay-v\xec-xml-n\u1ebfu-c\xf3-th\u1ec3",children:(0,r.jsx)(t.strong,{children:"5\ufe0f\u20e3 D\xf9ng JSON thay v\xec XML n\u1ebfu c\xf3 th\u1ec3"})}),"\n",(0,r.jsxs)(t.p,{children:["N\u1ebfu \u1ee9ng d\u1ee5ng kh\xf4ng b\u1eaft bu\u1ed9c d\xf9ng XML, h\xe3y c\xe2n nh\u1eafc ",(0,r.jsx)(t.strong,{children:"s\u1eed d\u1ee5ng JSON"}),", v\xec JSON kh\xf4ng h\u1ed7 tr\u1ee3 c\xe1c th\u1ef1c th\u1ec3 XML (",(0,r.jsx)(t.code,{children:"<!ENTITY>"}),"), gi\u1ea3m thi\u1ec3u r\u1ee7i ro XXE."]}),"\n",(0,r.jsx)(t.h2,{id:"-t\u1ed5ng-k\u1ebft",children:(0,r.jsx)(t.strong,{children:"\ud83d\udd12 T\u1ed5ng k\u1ebft"})}),"\n",(0,r.jsxs)(t.p,{children:["\u2714 ",(0,r.jsx)(t.strong,{children:"Ki\u1ec3m tra v\xe0 x\xe1c th\u1ef1c d\u1eef li\u1ec7u \u0111\u1ea7u v\xe0o"}),(0,r.jsx)(t.br,{}),"\n","\u2714 ",(0,r.jsx)(t.strong,{children:"V\xf4 hi\u1ec7u h\xf3a DTD v\xe0 External Entities trong parser"}),(0,r.jsx)(t.br,{}),"\n","\u2714 ",(0,r.jsx)(t.strong,{children:"Ki\u1ec3m tra Content-Type v\xe0 Accept Header"}),(0,r.jsx)(t.br,{}),"\n","\u2714 ",(0,r.jsx)(t.strong,{children:"S\u1eed d\u1ee5ng th\u01b0 vi\u1ec7n XML an to\xe0n"}),(0,r.jsx)(t.br,{}),"\n","\u2714 ",(0,r.jsx)(t.strong,{children:"\u01afu ti\xean JSON thay v\xec XML n\u1ebfu c\xf3 th\u1ec3"})]}),"\n",(0,r.jsx)(t.p,{children:"B\u1eb1ng c\xe1ch \xe1p d\u1ee5ng c\xe1c bi\u1ec7n ph\xe1p tr\xean, b\u1ea1n c\xf3 th\u1ec3 gi\u1ea3m thi\u1ec3u nguy c\u01a1 b\u1ecb t\u1ea5n c\xf4ng XXE! \ud83d\ude80"})]})}function g(n={}){const{wrapper:t}={...(0,s.R)(),...n.components};return t?(0,r.jsx)(t,{...n,children:(0,r.jsx)(l,{...n})}):l(n)}}}]);