"use strict";(self.webpackChunktiennhm_github_io=self.webpackChunktiennhm_github_io||[]).push([[3189],{3122:(n,e,t)=>{t.r(e),t.d(e,{assets:()=>h,contentTitle:()=>o,default:()=>d,frontMatter:()=>s,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"web-security/webgoat-2023.8/A5-Security-Misconfiguration/XXE-06","title":"1.06 | XXE","description":"B\xe0i vi\u1ebft n\xe0y s\u1ebd h\u01b0\u1edbng d\u1eabn c\xe1ch t\u1ea5n c\xf4ng XXE tr\xean WebGoat 2023.8","source":"@site/docs/02-web-security/webgoat-2023.8/A5-Security-Misconfiguration/XXE-06.md","sourceDirName":"02-web-security/webgoat-2023.8/A5-Security-Misconfiguration","slug":"/web-security/webgoat-2023.8/A5-Security-Misconfiguration/XXE-06","permalink":"/en/docs/web-security/webgoat-2023.8/A5-Security-Misconfiguration/XXE-06","draft":false,"unlisted":false,"editUrl":"https://github.com/TienNHM/tiennhm.github.io/tree/master/docs/02-web-security/webgoat-2023.8/A5-Security-Misconfiguration/XXE-06.md","tags":[{"inline":true,"label":"web-security","permalink":"/en/docs/tags/web-security"},{"inline":true,"label":"webgoat","permalink":"/en/docs/tags/webgoat"},{"inline":true,"label":"security-misconfiguration","permalink":"/en/docs/tags/security-misconfiguration"},{"inline":true,"label":"xxe","permalink":"/en/docs/tags/xxe"},{"inline":true,"label":"webgoat-2023.8","permalink":"/en/docs/tags/webgoat-2023-8"}],"version":"current","lastUpdatedAt":1755324792000,"sidebarPosition":1,"frontMatter":{"title":"1.06 | XXE","slug":"XXE-06","description":"B\xe0i vi\u1ebft n\xe0y s\u1ebd h\u01b0\u1edbng d\u1eabn c\xe1ch t\u1ea5n c\xf4ng XXE tr\xean WebGoat 2023.8","image":"https://tiennhm.github.io/img/docs/database.jpg","sidebar_position":1,"tags":["web-security","webgoat","security-misconfiguration","xxe","webgoat-2023.8"],"keywords":["web-security","webgoat","security-misconfiguration","xxe","webgoat-2023.8"],"enableComments":true,"draft":false},"sidebar":"tutorialSidebar","previous":{"title":"1.05 | XXE","permalink":"/en/docs/web-security/webgoat-2023.8/A5-Security-Misconfiguration/XXE-05"},"next":{"title":"1.07 | XXE","permalink":"/en/docs/web-security/webgoat-2023.8/A5-Security-Misconfiguration/XXE-07"}}');var c=t(74848),i=t(28453);const s={title:"1.06 | XXE",slug:"XXE-06",description:"B\xe0i vi\u1ebft n\xe0y s\u1ebd h\u01b0\u1edbng d\u1eabn c\xe1ch t\u1ea5n c\xf4ng XXE tr\xean WebGoat 2023.8",image:"https://tiennhm.github.io/img/docs/database.jpg",sidebar_position:1,tags:["web-security","webgoat","security-misconfiguration","xxe","webgoat-2023.8"],keywords:["web-security","webgoat","security-misconfiguration","xxe","webgoat-2023.8"],enableComments:!0,draft:!1},o=void 0,h={},l=[{value:"\ud83c\udfaf <strong>M\u1ee5c ti\xeau</strong>",id:"-m\u1ee5c-ti\xeau",level:2},{value:"\ud83d\udee0 <strong>1. Ph\xe2n t\xedch m\xe3 ngu\u1ed3n ch\u1ee9a l\u1ed7 h\u1ed5ng</strong>",id:"-1-ph\xe2n-t\xedch-m\xe3-ngu\u1ed3n-ch\u1ee9a-l\u1ed7-h\u1ed5ng",level:2},{value:"\ud83d\udee0 <strong>2. Ph\xe2n t\xedch s\xe2u h\u01a1n - <code>XmlFactory</code></strong>",id:"-2-ph\xe2n-t\xedch-s\xe2u-h\u01a1n---xmlfactory",level:2},{value:"\u2705 <strong>3. C\xe1ch ph\xf2ng ch\u1ed1ng</strong>",id:"-3-c\xe1ch-ph\xf2ng-ch\u1ed1ng",level:2},{value:"\ud83d\udd25 <strong>4. C\xe1ch ki\u1ec3m tra parser c\xf3 an to\xe0n kh\xf4ng?</strong>",id:"-4-c\xe1ch-ki\u1ec3m-tra-parser-c\xf3-an-to\xe0n-kh\xf4ng",level:2},{value:"\ud83d\udee1 <strong>5. T\xe0i li\u1ec7u tham kh\u1ea3o</strong>",id:"-5-t\xe0i-li\u1ec7u-tham-kh\u1ea3o",level:2}];function a(n){const e={a:"a",blockquote:"blockquote",br:"br",code:"code",h2:"h2",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...n.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)(e.blockquote,{children:["\n",(0,c.jsxs)(e.p,{children:["\ud83d\udd0d ",(0,c.jsx)(e.strong,{children:"Ph\xe1t hi\u1ec7n XXE qua Code Review"})]}),"\n"]}),"\n",(0,c.jsxs)(e.h2,{id:"-m\u1ee5c-ti\xeau",children:["\ud83c\udfaf ",(0,c.jsx)(e.strong,{children:"M\u1ee5c ti\xeau"})]}),"\n",(0,c.jsxs)(e.ul,{children:["\n",(0,c.jsxs)(e.li,{children:[(0,c.jsx)(e.strong,{children:"T\xecm hi\u1ec3u t\u1ea1i sao XXE x\u1ea3y ra"})," trong c\xe1c \u1ee9ng d\u1ee5ng Java."]}),"\n",(0,c.jsxs)(e.li,{children:[(0,c.jsx)(e.strong,{children:"Ph\xe2n t\xedch m\xe3 ngu\u1ed3n \u0111\u1ec3 ph\xe1t hi\u1ec7n l\u1ed7 h\u1ed5ng XXE"}),"."]}),"\n",(0,c.jsxs)(e.li,{children:[(0,c.jsx)(e.strong,{children:"X\xe1c \u0111\u1ecbnh c\xe1ch c\u1ea5u h\xecnh XML parser sao cho an to\xe0n"}),"."]}),"\n"]}),"\n",(0,c.jsxs)(e.h2,{id:"-1-ph\xe2n-t\xedch-m\xe3-ngu\u1ed3n-ch\u1ee9a-l\u1ed7-h\u1ed5ng",children:["\ud83d\udee0 ",(0,c.jsx)(e.strong,{children:"1. Ph\xe2n t\xedch m\xe3 ngu\u1ed3n ch\u1ee9a l\u1ed7 h\u1ed5ng"})]}),"\n",(0,c.jsx)(e.p,{children:(0,c.jsxs)(e.strong,{children:["\ud83d\udccc \u0110o\u1ea1n m\xe3 c\u1ea5u h\xecnh ",(0,c.jsx)(e.code,{children:"XmlMapper"})]})}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-java",children:"public XmlMapper xmlMapper() {\n  return new XmlMapper(XMLInputFactory.newInstance()); \n}\n"})}),"\n",(0,c.jsx)(e.p,{children:(0,c.jsx)(e.strong,{children:"\u274c V\u1ea5n \u0111\u1ec1:"})}),"\n",(0,c.jsxs)(e.ul,{children:["\n",(0,c.jsxs)(e.li,{children:["H\xe0m n\xe0y ",(0,c.jsxs)(e.strong,{children:["kh\u1edfi t\u1ea1o tr\u1ef1c ti\u1ebfp ",(0,c.jsx)(e.code,{children:"XMLInputFactory.newInstance()"})]})," m\xe0 kh\xf4ng t\u1eaft c\xe1c thu\u1ed9c t\xednh nguy hi\u1ec3m."]}),"\n",(0,c.jsxs)(e.li,{children:["M\u1eb7c \u0111\u1ecbnh, tr\xecnh ph\xe2n t\xedch ",(0,c.jsx)(e.strong,{children:"cho ph\xe9p c\xe1c th\u1ef1c th\u1ec3 b\xean ngo\xe0i (External Entities)"}),"."]}),"\n"]}),"\n",(0,c.jsxs)(e.p,{children:["\ud83d\udc49 ",(0,c.jsx)(e.strong,{children:"C\xe2u h\u1ecfi:"})," ",(0,c.jsx)(e.strong,{children:"Parser n\xe0y c\xf3 an to\xe0n kh\xf4ng?"}),(0,c.jsx)(e.br,{}),"\n","\ud83d\udd0d ",(0,c.jsxs)(e.strong,{children:["\u0110i s\xe2u v\xe0o m\xe3 ngu\u1ed3n c\u1ee7a Jackson ",(0,c.jsx)(e.code,{children:"XmlMapper"}),":"]})]}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-java",children:"public XmlMapper(XMLInputFactory inputF) {   \n  this(new XmlFactory(inputF));  \n}\n"})}),"\n",(0,c.jsxs)(e.ul,{children:["\n",(0,c.jsxs)(e.li,{children:[(0,c.jsxs)(e.strong,{children:["H\xe0m kh\u1edfi t\u1ea1o ",(0,c.jsx)(e.code,{children:"XmlMapper"})]})," g\u1ecdi ti\u1ebfp ",(0,c.jsx)(e.strong,{children:(0,c.jsx)(e.code,{children:"XmlFactory"})}),"."]}),"\n",(0,c.jsxs)(e.li,{children:[(0,c.jsxs)(e.strong,{children:[(0,c.jsx)(e.code,{children:"XmlFactory"})," nh\u1eadn ",(0,c.jsx)(e.code,{children:"XMLInputFactory"})," t\u1eeb b\xean ngo\xe0i`"]}),"."]}),"\n"]}),"\n",(0,c.jsxs)(e.h2,{id:"-2-ph\xe2n-t\xedch-s\xe2u-h\u01a1n---xmlfactory",children:["\ud83d\udee0 ",(0,c.jsxs)(e.strong,{children:["2. Ph\xe2n t\xedch s\xe2u h\u01a1n - ",(0,c.jsx)(e.code,{children:"XmlFactory"})]})]}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-java",children:"public XmlFactory(XMLInputFactory xmlIn) {  \n  this(xmlIn, null); \n}  \n\nprotected XmlFactory(XMLInputFactory xmlIn, XMLOutputFactory xmlOut, ...) { \n  if (xmlIn == null) {  \n    xmlIn = XMLInputFactory.newInstance();\n\n    // T\u1eaft th\u1ef1c th\u1ec3 b\xean ngo\xe0i (ch\u1ec9 khi xmlIn == null)\n    xmlIn.setProperty(XMLInputFactory.IS_SUPPORTING_EXTERNAL_ENTITIES, Boolean.FALSE);  \n    xmlIn.setProperty(XMLInputFactory.SUPPORT_DTD, Boolean.FALSE); \n  }\n}\n"})}),"\n",(0,c.jsxs)(e.p,{children:["\ud83d\udea8 ",(0,c.jsx)(e.strong,{children:"Ph\xe1t hi\u1ec7n l\u1ed7 h\u1ed5ng:"})]}),"\n",(0,c.jsxs)(e.ul,{children:["\n",(0,c.jsxs)(e.li,{children:[(0,c.jsxs)(e.strong,{children:[(0,c.jsx)(e.code,{children:"xmlIn == null"})," s\u1ebd kh\xf4ng x\u1ea3y ra"]}),", v\xec ",(0,c.jsx)(e.code,{children:"XMLInputFactory.newInstance()"})," \u0111\xe3 \u0111\u01b0\u1ee3c truy\u1ec1n v\xe0o."]}),"\n",(0,c.jsxs)(e.li,{children:[(0,c.jsx)(e.strong,{children:"Do \u0111\xf3, c\xe1c thu\u1ed9c t\xednh an to\xe0n kh\xf4ng \u0111\u01b0\u1ee3c thi\u1ebft l\u1eadp"})," \u2192 ",(0,c.jsx)(e.strong,{children:"XXE Injection v\u1eabn c\xf3 th\u1ec3 x\u1ea3y ra"}),"."]}),"\n"]}),"\n",(0,c.jsxs)(e.h2,{id:"-3-c\xe1ch-ph\xf2ng-ch\u1ed1ng",children:["\u2705 ",(0,c.jsx)(e.strong,{children:"3. C\xe1ch ph\xf2ng ch\u1ed1ng"})]}),"\n",(0,c.jsx)(e.p,{children:(0,c.jsx)(e.strong,{children:"\ud83d\udca1 Spring Boot \u0111\xe3 kh\u1eafc ph\u1ee5c l\u1ed7i nh\u01b0 th\u1ebf n\xe0o?"})}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-java",children:"public ObjectMapper create() {\n  return new XmlMapper(xmlInputFactory());  \n}\n\nprivate static XMLInputFactory xmlInputFactory() {\n  XMLInputFactory inputFactory = XMLInputFactory.newInstance();\n  inputFactory.setProperty(XMLInputFactory.SUPPORT_DTD, false);\n  inputFactory.setProperty(XMLInputFactory.IS_SUPPORTING_EXTERNAL_ENTITIES, false);\n  return inputFactory;\n}\n"})}),"\n",(0,c.jsxs)(e.p,{children:["\ud83d\udd12 ",(0,c.jsx)(e.strong,{children:"Gi\u1ea3i ph\xe1p an to\xe0n:"})]}),"\n",(0,c.jsxs)(e.ul,{children:["\n",(0,c.jsx)(e.li,{children:(0,c.jsxs)(e.strong,{children:["T\u1ea1o ",(0,c.jsx)(e.code,{children:"XMLInputFactory"})," trong m\u1ed9t method ri\xeang (",(0,c.jsx)(e.code,{children:"xmlInputFactory()"}),")."]})}),"\n",(0,c.jsxs)(e.li,{children:[(0,c.jsxs)(e.strong,{children:["T\u1eaft ",(0,c.jsx)(e.code,{children:"SUPPORT_DTD"})," v\xe0 ",(0,c.jsx)(e.code,{children:"IS_SUPPORTING_EXTERNAL_ENTITIES"})," ngay khi kh\u1edfi t\u1ea1o"]}),"."]}),"\n"]}),"\n",(0,c.jsxs)(e.h2,{id:"-4-c\xe1ch-ki\u1ec3m-tra-parser-c\xf3-an-to\xe0n-kh\xf4ng",children:["\ud83d\udd25 ",(0,c.jsx)(e.strong,{children:"4. C\xe1ch ki\u1ec3m tra parser c\xf3 an to\xe0n kh\xf4ng?"})]}),"\n",(0,c.jsxs)(e.p,{children:["\ud83d\udd0d ",(0,c.jsx)(e.strong,{children:"C\xe2u h\u1ecfi c\u1ea7n \u0111\u1eb7t ra khi review code"})]}),"\n",(0,c.jsxs)(e.p,{children:["\u2705 Parser c\xf3 b\u1ecb \u1ea3nh h\u01b0\u1edfng b\u1edfi XXE kh\xf4ng?",(0,c.jsx)(e.br,{}),"\n","\u2705 C\xf3 s\u1eed d\u1ee5ng ",(0,c.jsx)(e.code,{children:"XMLInputFactory.newInstance()"})," m\xe0 kh\xf4ng v\xf4 hi\u1ec7u h\xf3a th\u1ef1c th\u1ec3 b\xean ngo\xe0i kh\xf4ng?",(0,c.jsx)(e.br,{}),"\n","\u2705 C\xf3 thu\u1ed9c t\xednh ",(0,c.jsx)(e.code,{children:"IS_SUPPORTING_EXTERNAL_ENTITIES = false"})," kh\xf4ng?",(0,c.jsx)(e.br,{}),"\n","\u2705 C\xf3 thu\u1ed9c t\xednh ",(0,c.jsx)(e.code,{children:"SUPPORT_DTD = false"})," kh\xf4ng?"]}),"\n",(0,c.jsxs)(e.h2,{id:"-5-t\xe0i-li\u1ec7u-tham-kh\u1ea3o",children:["\ud83d\udee1 ",(0,c.jsx)(e.strong,{children:"5. T\xe0i li\u1ec7u tham kh\u1ea3o"})]}),"\n",(0,c.jsxs)(e.p,{children:["\ud83d\udccc ",(0,c.jsx)(e.a,{href:"https://cheatsheetseries.owasp.org/cheatsheets/XML_External_Entity_Prevention_Cheat_Sheet.html",children:"OWASP XXE Prevention Cheat Sheet"}),(0,c.jsx)(e.br,{}),"\n","\ud83d\udccc ",(0,c.jsx)(e.a,{href:"https://github.com/FasterXML/jackson-dataformat-xml",children:"Jackson XML Deserialization Security"})]})]})}function d(n={}){const{wrapper:e}={...(0,i.R)(),...n.components};return e?(0,c.jsx)(e,{...n,children:(0,c.jsx)(a,{...n})}):a(n)}},28453:(n,e,t)=>{t.d(e,{R:()=>s,x:()=>o});var r=t(96540);const c={},i=r.createContext(c);function s(n){const e=r.useContext(i);return r.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function o(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(c):n.components||c:s(n.components),r.createElement(i.Provider,{value:e},n.children)}}}]);