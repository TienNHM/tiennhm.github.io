"use strict";(self.webpackChunktiennhm_github_io=self.webpackChunktiennhm_github_io||[]).push([[7827],{28453:(n,e,t)=>{t.d(e,{R:()=>o,x:()=>c});var i=t(96540);const s={},r=i.createContext(s);function o(n){const e=i.useContext(r);return i.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function c(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(s):n.components||s:o(n.components),i.createElement(r.Provider,{value:e},n.children)}},76159:(n,e,t)=>{t.r(e),t.d(e,{assets:()=>a,contentTitle:()=>c,default:()=>g,frontMatter:()=>o,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"web-security/webgoat-2023.8/A5-Security-Misconfiguration/XXE-13","title":"1.13 | XXE","description":"B\xe0i vi\u1ebft n\xe0y s\u1ebd h\u01b0\u1edbng d\u1eabn c\xe1ch t\u1ea5n c\xf4ng XXE tr\xean WebGoat 2023.8","source":"@site/docs/02-web-security/webgoat-2023.8/A5-Security-Misconfiguration/XXE-13.md","sourceDirName":"02-web-security/webgoat-2023.8/A5-Security-Misconfiguration","slug":"/web-security/webgoat-2023.8/A5-Security-Misconfiguration/XXE-13","permalink":"/en/docs/web-security/webgoat-2023.8/A5-Security-Misconfiguration/XXE-13","draft":false,"unlisted":false,"editUrl":"https://github.com/TienNHM/tiennhm.github.io/tree/master/docs/02-web-security/webgoat-2023.8/A5-Security-Misconfiguration/XXE-13.md","tags":[{"inline":true,"label":"web-security","permalink":"/en/docs/tags/web-security"},{"inline":true,"label":"webgoat","permalink":"/en/docs/tags/webgoat"},{"inline":true,"label":"security-misconfiguration","permalink":"/en/docs/tags/security-misconfiguration"},{"inline":true,"label":"xxe","permalink":"/en/docs/tags/xxe"},{"inline":true,"label":"webgoat-2023.8","permalink":"/en/docs/tags/webgoat-2023-8"}],"version":"current","lastUpdatedAt":1755938109000,"sidebarPosition":1,"frontMatter":{"title":"1.13 | XXE","slug":"XXE-13","description":"B\xe0i vi\u1ebft n\xe0y s\u1ebd h\u01b0\u1edbng d\u1eabn c\xe1ch t\u1ea5n c\xf4ng XXE tr\xean WebGoat 2023.8","image":"https://tiennhm.github.io/img/docs/database.jpg","sidebar_position":1,"tags":["web-security","webgoat","security-misconfiguration","xxe","webgoat-2023.8"],"keywords":["web-security","webgoat","security-misconfiguration","xxe","webgoat-2023.8"],"enableComments":true,"draft":false},"sidebar":"tutorialSidebar","previous":{"title":"1.12 | XXE","permalink":"/en/docs/web-security/webgoat-2023.8/A5-Security-Misconfiguration/XXE-12"},"next":{"title":"LeetCode","permalink":"/en/docs/category/leetcode"}}');var s=t(74848),r=t(28453);const o={title:"1.13 | XXE",slug:"XXE-13",description:"B\xe0i vi\u1ebft n\xe0y s\u1ebd h\u01b0\u1edbng d\u1eabn c\xe1ch t\u1ea5n c\xf4ng XXE tr\xean WebGoat 2023.8",image:"https://tiennhm.github.io/img/docs/database.jpg",sidebar_position:1,tags:["web-security","webgoat","security-misconfiguration","xxe","webgoat-2023.8"],keywords:["web-security","webgoat","security-misconfiguration","xxe","webgoat-2023.8"],enableComments:!0,draft:!1},c=void 0,a={},l=[{value:"<strong>\ud83d\udd0d 1. Static Code Analysis l\xe0 g\xec?</strong>",id:"-1-static-code-analysis-l\xe0-g\xec",level:2},{value:"<strong>\u26a1 2. Ph\xe1t hi\u1ec7n XXE b\u1eb1ng SonarQube</strong>",id:"-2-ph\xe1t-hi\u1ec7n-xxe-b\u1eb1ng-sonarqube",level:2},{value:"<strong>\ud83c\udfaf 3. X\xe1c \u0111\u1ecbnh l\u1ed7 h\u1ed5ng XXE</strong>",id:"-3-x\xe1c-\u0111\u1ecbnh-l\u1ed7-h\u1ed5ng-xxe",level:2},{value:"<strong>\ud83d\udd27 4. C\xe1ch kh\u1eafc ph\u1ee5c l\u1ed7 h\u1ed5ng XXE</strong>",id:"-4-c\xe1ch-kh\u1eafc-ph\u1ee5c-l\u1ed7-h\u1ed5ng-xxe",level:2},{value:"<strong>\u2705 5. Ki\u1ec3m tra l\u1ea1i sau khi s\u1eeda l\u1ed7i</strong>",id:"-5-ki\u1ec3m-tra-l\u1ea1i-sau-khi-s\u1eeda-l\u1ed7i",level:2}];function h(n){const e={a:"a",blockquote:"blockquote",code:"code",h2:"h2",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...n.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(e.blockquote,{children:["\n",(0,s.jsxs)(e.p,{children:["\ud83d\udd75\ufe0f ",(0,s.jsx)(e.strong,{children:"Ph\xe1t hi\u1ec7n l\u1ed7 h\u1ed5ng XXE b\u1eb1ng ph\xe2n t\xedch m\xe3 t\u0129nh (Static Code Analysis)"})]}),"\n"]}),"\n",(0,s.jsx)(e.h2,{id:"-1-static-code-analysis-l\xe0-g\xec",children:(0,s.jsx)(e.strong,{children:"\ud83d\udd0d 1. Static Code Analysis l\xe0 g\xec?"})}),"\n",(0,s.jsxs)(e.p,{children:["Ph\xe2n t\xedch m\xe3 t\u0129nh (Static Code Analysis) gi\xfap t\xecm ki\u1ebfm l\u1ed7 h\u1ed5ng b\u1ea3o m\u1eadt trong code m\xe0 ",(0,s.jsx)(e.strong,{children:"kh\xf4ng c\u1ea7n ch\u1ea1y \u1ee9ng d\u1ee5ng"}),". C\xf4ng c\u1ee5 ph\u1ed5 bi\u1ebfn nh\u1ea5t \u0111\u1ec3 ph\xe2n t\xedch m\xe3 t\u0129nh l\xe0 ",(0,s.jsx)(e.strong,{children:"SonarQube"}),"."]}),"\n",(0,s.jsx)(e.h2,{id:"-2-ph\xe1t-hi\u1ec7n-xxe-b\u1eb1ng-sonarqube",children:(0,s.jsx)(e.strong,{children:"\u26a1 2. Ph\xe1t hi\u1ec7n XXE b\u1eb1ng SonarQube"})}),"\n",(0,s.jsxs)(e.p,{children:["Khi qu\xe9t m\xe3 ngu\u1ed3n ",(0,s.jsx)(e.strong,{children:"WebGoat"}),", SonarQube s\u1ebd ph\xe1t hi\u1ec7n c\xe1c v\u1ea5n \u0111\u1ec1 b\u1ea3o m\u1eadt, bao g\u1ed3m l\u1ed7 h\u1ed5ng ",(0,s.jsx)(e.strong,{children:"XXE (XML External Entity)"}),"."]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"\ud83d\udc40 C\xe1ch th\u1ef1c hi\u1ec7n qu\xe9t v\u1edbi SonarQube:"})}),"\n",(0,s.jsxs)(e.p,{children:["1\ufe0f\u20e3 ",(0,s.jsx)(e.strong,{children:"C\xe0i \u0111\u1eb7t SonarQube"})," (n\u1ebfu ch\u01b0a c\xf3):"]}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["Ch\u1ea1y SonarQube Server (",(0,s.jsx)(e.code,{children:"docker run -d -p 9000:9000 sonarqube"}),")"]}),"\n",(0,s.jsxs)(e.li,{children:["C\xe0i SonarScanner (",(0,s.jsx)(e.code,{children:"brew install sonar-scanner"})," ho\u1eb7c t\u1ea3i t\u1eeb ",(0,s.jsx)(e.a,{href:"https://docs.sonarqube.org/latest/analysis/scan/sonarscanner/",children:"SonarQube Scanner"}),")"]}),"\n"]}),"\n",(0,s.jsxs)(e.p,{children:["2\ufe0f\u20e3 ",(0,s.jsx)(e.strong,{children:"Ch\u1ea1y qu\xe9t m\xe3 ngu\u1ed3n WebGoat:"})]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-sh",children:"sonar-scanner \\\n-Dsonar.projectKey=WebGoat \\\n-Dsonar.sources=./WebGoat \\\n-Dsonar.host.url=http://localhost:9000 \\\n-Dsonar.login=your_token\n"})}),"\n",(0,s.jsxs)(e.p,{children:["3\ufe0f\u20e3 ",(0,s.jsx)(e.strong,{children:"Xem b\xe1o c\xe1o tr\xean giao di\u1ec7n SonarQube"})]}),"\n",(0,s.jsx)(e.h2,{id:"-3-x\xe1c-\u0111\u1ecbnh-l\u1ed7-h\u1ed5ng-xxe",children:(0,s.jsx)(e.strong,{children:"\ud83c\udfaf 3. X\xe1c \u0111\u1ecbnh l\u1ed7 h\u1ed5ng XXE"})}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:(0,s.jsxs)(e.strong,{children:["SonarQube b\xe1o l\u1ed7i XXE trong ",(0,s.jsx)(e.code,{children:"Comments"})," class"]})}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"X\xe1c minh l\u1ed7i"}),": \u0110\xe2y c\xf3 ph\u1ea3i ",(0,s.jsx)(e.strong,{children:"true positive"})," hay ",(0,s.jsx)(e.strong,{children:"false positive"}),"?"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Trong WebGoat, l\u1ed7i n\xe0y c\u1ed1 t\xecnh \u0111\u01b0\u1ee3c \u0111\u01b0a v\xe0o \u0111\u1ec3 th\u1ef1c h\xe0nh b\u1ea3o m\u1eadt"}),", n\xean \u0111\xe2y l\xe0 ",(0,s.jsx)(e.strong,{children:"true positive"}),"."]}),"\n"]}),"\n",(0,s.jsx)(e.h2,{id:"-4-c\xe1ch-kh\u1eafc-ph\u1ee5c-l\u1ed7-h\u1ed5ng-xxe",children:(0,s.jsx)(e.strong,{children:"\ud83d\udd27 4. C\xe1ch kh\u1eafc ph\u1ee5c l\u1ed7 h\u1ed5ng XXE"})}),"\n",(0,s.jsx)(e.p,{children:"SonarQube s\u1ebd \u0111\u1ec1 xu\u1ea5t c\xe1ch s\u1eeda l\u1ed7i, th\u01b0\u1eddng l\xe0:"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:(0,s.jsx)(e.strong,{children:"T\u1eaft DTD v\xe0 External Entities trong XML parser"})}),"\n",(0,s.jsx)(e.li,{children:(0,s.jsx)(e.strong,{children:"S\u1eed d\u1ee5ng th\u01b0 vi\u1ec7n an to\xe0n"})}),"\n"]}),"\n",(0,s.jsxs)(e.p,{children:["V\xed d\u1ee5: Trong ",(0,s.jsx)(e.strong,{children:"Java"}),", s\u1eeda l\u1ed7i b\u1eb1ng c\xe1ch:"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-java",children:"XMLInputFactory xif = XMLInputFactory.newFactory();\nxif.setProperty(XMLInputFactory.SUPPORT_DTD, false);\nxif.setProperty(XMLInputFactory.IS_SUPPORTING_EXTERNAL_ENTITIES, false);\n"})}),"\n",(0,s.jsx)(e.h2,{id:"-5-ki\u1ec3m-tra-l\u1ea1i-sau-khi-s\u1eeda-l\u1ed7i",children:(0,s.jsx)(e.strong,{children:"\u2705 5. Ki\u1ec3m tra l\u1ea1i sau khi s\u1eeda l\u1ed7i"})}),"\n",(0,s.jsx)(e.p,{children:"Sau khi \xe1p d\u1ee5ng b\u1ea3n v\xe1, qu\xe9t l\u1ea1i v\u1edbi SonarQube:"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-sh",children:"sonar-scanner\n"})}),"\n",(0,s.jsxs)(e.p,{children:["N\u1ebfu l\u1ed7i bi\u1ebfn m\u1ea5t ho\u1eb7c \u0111\u01b0\u1ee3c \u0111\xe1nh d\u1ea5u ",(0,s.jsx)(e.strong,{children:"mitigated"}),", ngh\u0129a l\xe0 b\u1ea1n \u0111\xe3 s\u1eeda l\u1ed7i th\xe0nh c\xf4ng! \ud83d\ude80"]})]})}function g(n={}){const{wrapper:e}={...(0,r.R)(),...n.components};return e?(0,s.jsx)(e,{...n,children:(0,s.jsx)(h,{...n})}):h(n)}}}]);