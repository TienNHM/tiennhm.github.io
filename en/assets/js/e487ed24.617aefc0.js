"use strict";(self.webpackChunktiennhm_github_io=self.webpackChunktiennhm_github_io||[]).push([[8586],{68807:(n,s,e)=>{e.r(s),e.d(s,{assets:()=>o,contentTitle:()=>c,default:()=>d,frontMatter:()=>i,metadata:()=>h,toc:()=>l});var t=e(74848),r=e(28453);const i={title:"3.04 | Missing Function Level Access Control",slug:"missing-function-level-access-control-04",description:"B\xe0i vi\u1ebft n\xe0y s\u1ebd h\u01b0\u1edbng d\u1eabn c\xe1ch t\u1ea5n c\xf4ng Missing Function Level Access Control tr\xean WebGoat 2023.8",image:"https://tiennhm.github.io/img/docs/database.jpg",sidebar_position:3,tags:["web-security","webgoat","broken-access-control","missing-function-level-access-control","webgoat-2023.8"],keywords:["web-security","webgoat","broken-access-control","missing-function-level-access-control","webgoat-2023.8"],enableComments:!0,draft:!1},c=void 0,h={id:"web-security/webgoat-2023.8/A1-Broken-Access-Control/Missing-Function-Level-Access-Control-04",title:"3.04 | Missing Function Level Access Control",description:"B\xe0i vi\u1ebft n\xe0y s\u1ebd h\u01b0\u1edbng d\u1eabn c\xe1ch t\u1ea5n c\xf4ng Missing Function Level Access Control tr\xean WebGoat 2023.8",source:"@site/docs/02-web-security/webgoat-2023.8/A1-Broken-Access-Control/Missing-Function-Level-Access-Control-04.md",sourceDirName:"02-web-security/webgoat-2023.8/A1-Broken-Access-Control",slug:"/web-security/webgoat-2023.8/A1-Broken-Access-Control/missing-function-level-access-control-04",permalink:"/en/docs/web-security/webgoat-2023.8/A1-Broken-Access-Control/missing-function-level-access-control-04",draft:!1,unlisted:!1,editUrl:"https://github.com/TienNHM/tiennhm.github.io/tree/master/docs/02-web-security/webgoat-2023.8/A1-Broken-Access-Control/Missing-Function-Level-Access-Control-04.md",tags:[{inline:!0,label:"web-security",permalink:"/en/docs/tags/web-security"},{inline:!0,label:"webgoat",permalink:"/en/docs/tags/webgoat"},{inline:!0,label:"broken-access-control",permalink:"/en/docs/tags/broken-access-control"},{inline:!0,label:"missing-function-level-access-control",permalink:"/en/docs/tags/missing-function-level-access-control"},{inline:!0,label:"webgoat-2023.8",permalink:"/en/docs/tags/webgoat-2023-8"}],version:"current",lastUpdatedAt:1742146041e3,sidebarPosition:3,frontMatter:{title:"3.04 | Missing Function Level Access Control",slug:"missing-function-level-access-control-04",description:"B\xe0i vi\u1ebft n\xe0y s\u1ebd h\u01b0\u1edbng d\u1eabn c\xe1ch t\u1ea5n c\xf4ng Missing Function Level Access Control tr\xean WebGoat 2023.8",image:"https://tiennhm.github.io/img/docs/database.jpg",sidebar_position:3,tags:["web-security","webgoat","broken-access-control","missing-function-level-access-control","webgoat-2023.8"],keywords:["web-security","webgoat","broken-access-control","missing-function-level-access-control","webgoat-2023.8"],enableComments:!0,draft:!1},sidebar:"tutorialSidebar",previous:{title:"3.03 | Missing Function Level Access Control",permalink:"/en/docs/web-security/webgoat-2023.8/A1-Broken-Access-Control/missing-function-level-access-control-03"},next:{title:"4.01 | Spoofing an Authentication Cookie",permalink:"/en/docs/web-security/webgoat-2023.8/A1-Broken-Access-Control/spoofing-an-authentication-cookie-01"}},o={},l=[{value:"\u2705 <strong>1\ufe0f\u20e3 \xdd ngh\u0129a c\u1ee7a b\xe0i t\u1eadp n\xe0y?</strong>",id:"-1\ufe0f\u20e3-\xfd-ngh\u0129a-c\u1ee7a-b\xe0i-t\u1eadp-n\xe0y",level:2},{value:"\ud83d\ude80 <strong>2\ufe0f\u20e3 C\xe1ch khai th\xe1c l\u1ed7 h\u1ed5ng sau khi fix</strong>",id:"-2\ufe0f\u20e3-c\xe1ch-khai-th\xe1c-l\u1ed7-h\u1ed5ng-sau-khi-fix",level:2},{value:"<strong>\ud83d\udd0e C\xe1ch 1: Kh\xf4i ph\u1ee5c hash c\u1ee7a Jerry b\u1eb1ng thu\u1eadt to\xe1n SHA-256</strong>",id:"-c\xe1ch-1-kh\xf4i-ph\u1ee5c-hash-c\u1ee7a-jerry-b\u1eb1ng-thu\u1eadt-to\xe1n-sha-256",level:3},{value:"<strong>\ud83d\udd0e C\xe1ch 2: S\u1eed d\u1ee5ng Burp Suite \u0111\u1ec3 th\u1eed l\u1ea1i quy\u1ec1n truy c\u1eadp</strong>",id:"-c\xe1ch-2-s\u1eed-d\u1ee5ng-burp-suite-\u0111\u1ec3-th\u1eed-l\u1ea1i-quy\u1ec1n-truy-c\u1eadp",level:3},{value:"\ud83d\udd12 <strong>3\ufe0f\u20e3 Gi\u1ea3i ph\xe1p ph\xf2ng tr\xe1nh</strong>",id:"-3\ufe0f\u20e3-gi\u1ea3i-ph\xe1p-ph\xf2ng-tr\xe1nh",level:2},{value:"\ud83d\udd39 <strong>1. S\u1eed d\u1ee5ng ph\u01b0\u01a1ng ph\xe1p b\u0103m an to\xe0n (Password Hashing)</strong>",id:"-1-s\u1eed-d\u1ee5ng-ph\u01b0\u01a1ng-ph\xe1p-b\u0103m-an-to\xe0n-password-hashing",level:3},{value:"\ud83d\ude80 <strong>V\xed d\u1ee5: C\xe1ch b\u0103m m\u1eadt kh\u1ea9u b\u1eb1ng bcrypt trong Java</strong>",id:"-v\xed-d\u1ee5-c\xe1ch-b\u0103m-m\u1eadt-kh\u1ea9u-b\u1eb1ng-bcrypt-trong-java",level:3},{value:"\ud83d\udd39 <strong>2. Ki\u1ec3m so\xe1t quy\u1ec1n h\u1ea1n ch\u1eb7t ch\u1ebd tr\xean Backend (API Authorization)</strong>",id:"-2-ki\u1ec3m-so\xe1t-quy\u1ec1n-h\u1ea1n-ch\u1eb7t-ch\u1ebd-tr\xean-backend-api-authorization",level:3},{value:"\ud83d\ude80 <strong>V\xed d\u1ee5: Ki\u1ec3m tra quy\u1ec1n h\u1ea1n trong API (ASP.NET Core)</strong>",id:"-v\xed-d\u1ee5-ki\u1ec3m-tra-quy\u1ec1n-h\u1ea1n-trong-api-aspnet-core",level:3},{value:"\ud83d\udd39 <strong>3. B\u1ea3o v\u1ec7 API ch\u1ed1ng t\u1ea5n c\xf4ng Brute Force v\xe0 Enumeration</strong>",id:"-3-b\u1ea3o-v\u1ec7-api-ch\u1ed1ng-t\u1ea5n-c\xf4ng-brute-force-v\xe0-enumeration",level:3},{value:"\ud83d\ude80 <strong>V\xed d\u1ee5: Ch\u1ed1ng brute force trong API (Node.js + Express + Rate Limiter)</strong>",id:"-v\xed-d\u1ee5-ch\u1ed1ng-brute-force-trong-api-nodejs--express--rate-limiter",level:3},{value:"<strong>\ud83d\udd0e 3\ufe0f\u20e3 K\u1ebft lu\u1eadn: C\xe1ch l\xe0m \u0111\xfang</strong>",id:"-3\ufe0f\u20e3-k\u1ebft-lu\u1eadn-c\xe1ch-l\xe0m-\u0111\xfang",level:2}];function a(n){const s={a:"a",blockquote:"blockquote",br:"br",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...n.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(s.blockquote,{children:["\n",(0,t.jsxs)(s.p,{children:["\ud83d\udd25 ",(0,t.jsx)(s.strong,{children:'Ph\xe2n t\xedch & C\xe1ch khai th\xe1c l\u1ed7 h\u1ed5ng "The company fixed the problem, right?" trong WebGoat'})]}),"\n"]}),"\n",(0,t.jsxs)(s.h2,{id:"-1\ufe0f\u20e3-\xfd-ngh\u0129a-c\u1ee7a-b\xe0i-t\u1eadp-n\xe0y",children:["\u2705 ",(0,t.jsx)(s.strong,{children:"1\ufe0f\u20e3 \xdd ngh\u0129a c\u1ee7a b\xe0i t\u1eadp n\xe0y?"})]}),"\n",(0,t.jsxs)(s.p,{children:["B\xe0i t\u1eadp n\xe0y ki\u1ec3m tra c\xe1ch \u1ee9ng d\u1ee5ng x\u1eed l\xfd ",(0,t.jsx)(s.strong,{children:"c\xe1c l\u1ed7 h\u1ed5ng b\u1ea3o m\u1eadt sau khi v\xe1 l\u1ed7i"}),"."]}),"\n",(0,t.jsxs)(s.p,{children:["L\u1ed7i ban \u0111\u1ea7u c\u1ee7a h\u1ec7 th\u1ed1ng l\xe0 ",(0,t.jsx)(s.strong,{children:"b\u1ea5t k\u1ef3 ai c\u0169ng c\xf3 th\u1ec3 truy c\u1eadp danh s\xe1ch ng\u01b0\u1eddi d\xf9ng"})," qua endpoint ",(0,t.jsx)(s.code,{children:"/users"}),". Sau khi c\xf4ng ty v\xe1 l\u1ed7i, ch\u1ec9 admin m\u1edbi c\xf3 th\u1ec3 xem danh s\xe1ch n\xe0y. Tuy nhi\xean, hacker v\u1eabn c\xf3 th\u1ec3:",(0,t.jsx)(s.br,{}),"\n","\u2705 ",(0,t.jsx)(s.strong,{children:"D\u1ef1 \u0111o\xe1n & t\u1ea1o l\u1ea1i hash"})," n\u1ebfu bi\u1ebft c\xe1ch h\u1ec7 th\u1ed1ng t\u1ea1o hash.",(0,t.jsx)(s.br,{}),"\n","\u2705 ",(0,t.jsx)(s.strong,{children:"Bypass ki\u1ec3m tra quy\u1ec1n h\u1ea1n"})," n\u1ebfu API backend kh\xf4ng th\u1ef1c s\u1ef1 ch\u1eb7n request."]}),"\n",(0,t.jsxs)(s.p,{children:["\ud83d\udccc ",(0,t.jsx)(s.strong,{children:"T\xecnh hu\u1ed1ng gi\u1ea3 \u0111\u1ecbnh:"})]}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["Tr\u01b0\u1edbc \u0111\xf3, b\u1ea5t k\u1ef3 ng\u01b0\u1eddi d\xf9ng n\xe0o c\u0169ng c\xf3 th\u1ec3 truy c\u1eadp danh s\xe1ch ",(0,t.jsx)(s.code,{children:"/users"}),"."]}),"\n",(0,t.jsxs)(s.li,{children:["C\xf4ng ty \u0111\xe3 v\xe1 l\u1ed7i \u2192 ",(0,t.jsx)(s.strong,{children:"Ch\u1ec9 admin m\u1edbi c\xf3 th\u1ec3 truy c\u1eadp"}),"."]}),"\n",(0,t.jsxs)(s.li,{children:["M\u1ee5c ti\xeau: ",(0,t.jsx)(s.strong,{children:"T\xecm hash c\u1ee7a Jerry m\xe0 kh\xf4ng c\xf3 quy\u1ec1n admin"})]}),"\n"]}),"\n",(0,t.jsxs)(s.h2,{id:"-2\ufe0f\u20e3-c\xe1ch-khai-th\xe1c-l\u1ed7-h\u1ed5ng-sau-khi-fix",children:["\ud83d\ude80 ",(0,t.jsx)(s.strong,{children:"2\ufe0f\u20e3 C\xe1ch khai th\xe1c l\u1ed7 h\u1ed5ng sau khi fix"})]}),"\n",(0,t.jsx)(s.h3,{id:"-c\xe1ch-1-kh\xf4i-ph\u1ee5c-hash-c\u1ee7a-jerry-b\u1eb1ng-thu\u1eadt-to\xe1n-sha-256",children:(0,t.jsx)(s.strong,{children:"\ud83d\udd0e C\xe1ch 1: Kh\xf4i ph\u1ee5c hash c\u1ee7a Jerry b\u1eb1ng thu\u1eadt to\xe1n SHA-256"})}),"\n",(0,t.jsxs)(s.p,{children:["V\xec ta kh\xf4ng th\u1ec3 l\u1ea5y danh s\xe1ch ",(0,t.jsx)(s.code,{children:"/users"}),", ta s\u1ebd ",(0,t.jsx)(s.strong,{children:"d\u1ef1 \u0111o\xe1n v\xe0 t\u1ea1o l\u1ea1i hash"})," c\u1ee7a Jerry."]}),"\n",(0,t.jsxs)(s.p,{children:["\ud83d\udccc ",(0,t.jsx)(s.strong,{children:"Chi\u1ebfn l\u01b0\u1ee3c:"})]}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["D\u1ef1 \u0111o\xe1n c\xe1ch \u1ee9ng d\u1ee5ng ",(0,t.jsx)(s.strong,{children:"b\u0103m m\u1eadt kh\u1ea9u"})]}),"\n",(0,t.jsxs)(s.li,{children:["D\xf9ng ",(0,t.jsx)(s.strong,{children:"c\xf9ng thu\u1eadt to\xe1n SHA-256"})," \u0111\u1ec3 t\u1ea1o hash"]}),"\n",(0,t.jsx)(s.li,{children:"So s\xe1nh v\u1edbi hash c\u0169 ta t\xecm th\u1ea5y tr\u01b0\u1edbc \u0111\xf3"}),"\n"]}),"\n",(0,t.jsxs)(s.p,{children:["\ud83d\udccc ",(0,t.jsx)(s.strong,{children:"Th\xf4ng tin t\u1eeb b\xe0i tr\u01b0\u1edbc:"})]}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["Salt \u0111\u01b0\u1ee3c d\xf9ng: ",(0,t.jsx)(s.code,{children:'"DeliberatelyInsecure1235"'})]}),"\n",(0,t.jsxs)(s.li,{children:["C\u1ea5u tr\xfac hash: ",(0,t.jsx)(s.code,{children:"SHA-256(password + salt + username)"})]}),"\n"]}),"\n",(0,t.jsxs)(s.p,{children:["\ud83d\udccc ",(0,t.jsx)(s.strong,{children:"\ud83d\udd39 Code Java \u0111\u1ec3 t\xednh l\u1ea1i hash c\u1ee7a Jerry"})]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-java",children:'import java.nio.charset.StandardCharsets;\nimport java.security.MessageDigest;\nimport java.security.NoSuchAlgorithmException;\nimport java.util.Base64;\n\npublic class Main {\n    public static void main(String[] args) {\n        String password = "doesnotreallymatter";\n        String username = "Jerry";\n        String passwordSalt = "DeliberatelyInsecure1235"; // Strong Salt\n\n        try {\n            MessageDigest md = MessageDigest.getInstance("SHA-256");\n            String combined = password + passwordSalt + username;\n            byte[] hash = md.digest(combined.getBytes(StandardCharsets.UTF_8));\n            System.out.println("Hash c\u1ee7a Jerry: " + Base64.getEncoder().encodeToString(hash));\n        } catch (NoSuchAlgorithmException e) {\n            throw new RuntimeException(e);\n        }\n    }\n}\n'})}),"\n",(0,t.jsxs)(s.p,{children:["\ud83d\udcbb ",(0,t.jsx)(s.strong,{children:"H\u01b0\u1edbng d\u1eabn ch\u1ea1y code"}),"\n1\ufe0f\u20e3 ",(0,t.jsxs)(s.strong,{children:["L\u01b0u code th\xe0nh ",(0,t.jsx)(s.code,{children:"Main.java"})]}),(0,t.jsx)(s.br,{}),"\n","2\ufe0f\u20e3 ",(0,t.jsx)(s.strong,{children:"M\u1edf terminal v\xe0 bi\xean d\u1ecbch:"})]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-sh",children:"javac Main.java\n"})}),"\n",(0,t.jsxs)(s.p,{children:["3\ufe0f\u20e3 ",(0,t.jsx)(s.strong,{children:"Ch\u1ea1y ch\u01b0\u01a1ng tr\xecnh:"})]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-sh",children:"java Main\n"})}),"\n",(0,t.jsxs)(s.p,{children:["4\ufe0f\u20e3 ",(0,t.jsx)(s.strong,{children:"Copy hash v\xe0 d\xe1n v\xe0o WebGoat"})]}),"\n",(0,t.jsx)(s.h3,{id:"-c\xe1ch-2-s\u1eed-d\u1ee5ng-burp-suite-\u0111\u1ec3-th\u1eed-l\u1ea1i-quy\u1ec1n-truy-c\u1eadp",children:(0,t.jsx)(s.strong,{children:"\ud83d\udd0e C\xe1ch 2: S\u1eed d\u1ee5ng Burp Suite \u0111\u1ec3 th\u1eed l\u1ea1i quy\u1ec1n truy c\u1eadp"})}),"\n",(0,t.jsxs)(s.p,{children:["\ud83d\udca1 ",(0,t.jsx)(s.strong,{children:"C\xf3 th\u1ec3 backend ch\u1ec9 ch\u1eb7n giao di\u1ec7n UI nh\u01b0ng kh\xf4ng ch\u1eb7n API?"})]}),"\n",(0,t.jsxs)(s.p,{children:["\ud83d\udccc ",(0,t.jsx)(s.strong,{children:"C\xe1c b\u01b0\u1edbc th\u1eed nghi\u1ec7m:"}),(0,t.jsx)(s.br,{}),"\n","1\ufe0f\u20e3 ",(0,t.jsx)(s.strong,{children:"M\u1edf Burp Suite \u2192 B\u1eadt Intercept"}),(0,t.jsx)(s.br,{}),"\n","2\ufe0f\u20e3 ",(0,t.jsxs)(s.strong,{children:["Truy c\u1eadp WebGoat \u2192 Th\u1eed g\u1ecdi ",(0,t.jsx)(s.code,{children:"/users"})," qua API"]}),(0,t.jsx)(s.br,{}),"\n","3\ufe0f\u20e3 ",(0,t.jsx)(s.strong,{children:"N\u1ebfu b\u1ecb ch\u1eb7n \u2192 Th\u1eed \u0111\u1ed5i User-Agent th\xe0nh Admin"}),(0,t.jsx)(s.br,{}),"\n","4\ufe0f\u20e3 ",(0,t.jsx)(s.strong,{children:"N\u1ebfu v\u1eabn b\u1ecb ch\u1eb7n \u2192 Th\u1eed bypass b\u1eb1ng session hijacking"})]}),"\n",(0,t.jsxs)(s.h2,{id:"-3\ufe0f\u20e3-gi\u1ea3i-ph\xe1p-ph\xf2ng-tr\xe1nh",children:["\ud83d\udd12 ",(0,t.jsx)(s.strong,{children:"3\ufe0f\u20e3 Gi\u1ea3i ph\xe1p ph\xf2ng tr\xe1nh"})]}),"\n",(0,t.jsxs)(s.h3,{id:"-1-s\u1eed-d\u1ee5ng-ph\u01b0\u01a1ng-ph\xe1p-b\u0103m-an-to\xe0n-password-hashing",children:["\ud83d\udd39 ",(0,t.jsx)(s.strong,{children:"1. S\u1eed d\u1ee5ng ph\u01b0\u01a1ng ph\xe1p b\u0103m an to\xe0n (Password Hashing)"})]}),"\n",(0,t.jsxs)(s.p,{children:["\ud83d\udccc ",(0,t.jsx)(s.strong,{children:"Sai l\u1ea7m trong h\u1ec7 th\u1ed1ng hi\u1ec7n t\u1ea1i:"})]}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["S\u1eed d\u1ee5ng SHA-256 ",(0,t.jsx)(s.strong,{children:"m\u1ed9t l\u1ea7n duy nh\u1ea5t"})," \u0111\u1ec3 b\u0103m m\u1eadt kh\u1ea9u."]}),"\n",(0,t.jsxs)(s.li,{children:["Salt (",(0,t.jsx)(s.code,{children:"DeliberatelyInsecure1235"}),") b\u1ecb c\u1ed1 \u0111\u1ecbnh \u2192 d\u1ec5 b\u1ecb \u0111o\xe1n."]}),"\n"]}),"\n",(0,t.jsxs)(s.p,{children:["\ud83d\udccc ",(0,t.jsx)(s.strong,{children:"C\xe1ch l\xe0m \u0111\xfang:"}),(0,t.jsx)(s.br,{}),"\n","\ud83d\udd39 ",(0,t.jsx)(s.strong,{children:"D\xf9ng thu\u1eadt to\xe1n b\u0103m an to\xe0n h\u01a1n nh\u01b0"})," ",(0,t.jsx)(s.code,{children:"bcrypt"}),", ",(0,t.jsx)(s.code,{children:"PBKDF2"})," ho\u1eb7c ",(0,t.jsx)(s.code,{children:"Argon2"}),".",(0,t.jsx)(s.br,{}),"\n","\ud83d\udd39 ",(0,t.jsx)(s.strong,{children:"S\u1eed d\u1ee5ng salt ng\u1eabu nhi\xean cho m\u1ed7i user"})," thay v\xec d\xf9ng chung m\u1ed9t salt."]}),"\n",(0,t.jsxs)(s.h3,{id:"-v\xed-d\u1ee5-c\xe1ch-b\u0103m-m\u1eadt-kh\u1ea9u-b\u1eb1ng-bcrypt-trong-java",children:["\ud83d\ude80 ",(0,t.jsx)(s.strong,{children:"V\xed d\u1ee5: C\xe1ch b\u0103m m\u1eadt kh\u1ea9u b\u1eb1ng bcrypt trong Java"})]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-java",children:'import org.mindrot.jbcrypt.BCrypt;\n\npublic class SecureHashing {\n    public static void main(String[] args) {\n        String password = "JerrySecurePassword";\n        \n        // T\u1ea1o salt ng\u1eabu nhi\xean v\xe0 b\u0103m m\u1eadt kh\u1ea9u\n        String hashedPassword = BCrypt.hashpw(password, BCrypt.gensalt());\n        \n        System.out.println("Hashed Password: " + hashedPassword);\n    }\n}\n'})}),"\n",(0,t.jsxs)(s.p,{children:["\ud83d\udca1 ",(0,t.jsx)(s.strong,{children:"L\u1ee3i \xedch:"}),(0,t.jsx)(s.br,{}),"\n","\u2705 Bcrypt t\u1ef1 \u0111\u1ed9ng ",(0,t.jsx)(s.strong,{children:"th\xeam salt ng\u1eabu nhi\xean"}),".",(0,t.jsx)(s.br,{}),"\n","\u2705 Bcrypt c\xf3 ",(0,t.jsx)(s.strong,{children:"c\u01a1 ch\u1ebf l\xe0m ch\u1eadm (work factor)"}),", khi\u1ebfn vi\u1ec7c b\u1ebb kh\xf3a kh\xf3 h\u01a1n."]}),"\n",(0,t.jsxs)(s.h3,{id:"-2-ki\u1ec3m-so\xe1t-quy\u1ec1n-h\u1ea1n-ch\u1eb7t-ch\u1ebd-tr\xean-backend-api-authorization",children:["\ud83d\udd39 ",(0,t.jsx)(s.strong,{children:"2. Ki\u1ec3m so\xe1t quy\u1ec1n h\u1ea1n ch\u1eb7t ch\u1ebd tr\xean Backend (API Authorization)"})]}),"\n",(0,t.jsxs)(s.p,{children:["\ud83d\udccc ",(0,t.jsx)(s.strong,{children:"Sai l\u1ea7m trong h\u1ec7 th\u1ed1ng hi\u1ec7n t\u1ea1i:"})]}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["Ch\u1ec9 ",(0,t.jsx)(s.strong,{children:"ch\u1eb7n truy c\u1eadp tr\xean giao di\u1ec7n"})," m\xe0 kh\xf4ng ki\u1ec3m tra quy\u1ec1n trong API backend."]}),"\n",(0,t.jsxs)(s.li,{children:["Hacker c\xf3 th\u1ec3 ",(0,t.jsx)(s.strong,{children:"g\u1eedi request tr\u1ef1c ti\u1ebfp \u0111\u1ebfn API"})," \u0111\u1ec3 truy v\u1ea5n d\u1eef li\u1ec7u."]}),"\n"]}),"\n",(0,t.jsxs)(s.p,{children:["\ud83d\udccc ",(0,t.jsx)(s.strong,{children:"C\xe1ch l\xe0m \u0111\xfang:"}),(0,t.jsx)(s.br,{}),"\n","\ud83d\udd39 ",(0,t.jsx)(s.strong,{children:"Ki\u1ec3m tra quy\u1ec1n c\u1ee7a user tr\xean API, kh\xf4ng ch\u1ec9 tr\xean giao di\u1ec7n."}),(0,t.jsx)(s.br,{}),"\n","\ud83d\udd39 ",(0,t.jsx)(s.strong,{children:"D\xf9ng OAuth2 / JWT \u0111\u1ec3 x\xe1c th\u1ef1c user v\xe0 ph\xe2n quy\u1ec1n ch\u1eb7t ch\u1ebd."}),(0,t.jsx)(s.br,{}),"\n","\ud83d\udd39 ",(0,t.jsx)(s.strong,{children:"H\u1ea1n ch\u1ebf th\xf4ng tin tr\u1ea3 v\u1ec1 (Least Privilege)"})," \u2192 ch\u1ec9 cho user th\u1ea5y d\u1eef li\u1ec7u h\u1ecd \u0111\u01b0\u1ee3c ph\xe9p xem."]}),"\n",(0,t.jsxs)(s.h3,{id:"-v\xed-d\u1ee5-ki\u1ec3m-tra-quy\u1ec1n-h\u1ea1n-trong-api-aspnet-core",children:["\ud83d\ude80 ",(0,t.jsx)(s.strong,{children:"V\xed d\u1ee5: Ki\u1ec3m tra quy\u1ec1n h\u1ea1n trong API (ASP.NET Core)"})]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-csharp",children:'[Authorize(Roles = "Admin")]\n[HttpGet("users")]\npublic IActionResult GetUsers()\n{\n    var users = _userService.GetAllUsers();\n    return Ok(users);\n}\n'})}),"\n",(0,t.jsxs)(s.p,{children:["\ud83d\udca1 ",(0,t.jsx)(s.strong,{children:"L\u1ee3i \xedch:"}),(0,t.jsx)(s.br,{}),"\n","\u2705 Ch\u1ec9 ",(0,t.jsx)(s.strong,{children:"admin"})," m\u1edbi c\xf3 th\u1ec3 g\u1ecdi API ",(0,t.jsx)(s.code,{children:"/users"}),".",(0,t.jsx)(s.br,{}),"\n","\u2705 Hacker kh\xf4ng th\u1ec3 bypass ch\u1ec9 b\u1eb1ng c\xe1ch g\u1eedi request tr\u1ef1c ti\u1ebfp."]}),"\n",(0,t.jsxs)(s.h3,{id:"-3-b\u1ea3o-v\u1ec7-api-ch\u1ed1ng-t\u1ea5n-c\xf4ng-brute-force-v\xe0-enumeration",children:["\ud83d\udd39 ",(0,t.jsx)(s.strong,{children:"3. B\u1ea3o v\u1ec7 API ch\u1ed1ng t\u1ea5n c\xf4ng Brute Force v\xe0 Enumeration"})]}),"\n",(0,t.jsxs)(s.p,{children:["\ud83d\udccc ",(0,t.jsx)(s.strong,{children:"Sai l\u1ea7m trong h\u1ec7 th\u1ed1ng hi\u1ec7n t\u1ea1i:"})]}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["Hacker c\xf3 th\u1ec3 ",(0,t.jsx)(s.strong,{children:"th\u1eed nhi\u1ec1u l\u1ea7n"})," \u0111\u1ec3 \u0111o\xe1n hash c\u1ee7a Jerry."]}),"\n",(0,t.jsxs)(s.li,{children:["Kh\xf4ng c\xf3 ",(0,t.jsx)(s.strong,{children:"gi\u1edbi h\u1ea1n s\u1ed1 l\u1ea7n th\u1eed"})," \u2192 d\u1ec5 b\u1ecb brute-force."]}),"\n"]}),"\n",(0,t.jsxs)(s.p,{children:["\ud83d\udccc ",(0,t.jsx)(s.strong,{children:"C\xe1ch l\xe0m \u0111\xfang:"}),(0,t.jsx)(s.br,{}),"\n","\ud83d\udd39 ",(0,t.jsx)(s.strong,{children:"Gi\u1edbi h\u1ea1n s\u1ed1 l\u1ea7n th\u1eed"})," (Rate Limiting).",(0,t.jsx)(s.br,{}),"\n","\ud83d\udd39 ",(0,t.jsx)(s.strong,{children:"Ch\u1ed1ng d\xf2 \u0111o\xe1n th\xf4ng tin b\u1eb1ng Captcha ho\u1eb7c Delay Response."}),(0,t.jsx)(s.br,{}),"\n","\ud83d\udd39 ",(0,t.jsx)(s.strong,{children:"\u1ea8n l\u1ed7i tr\u1ea3 v\u1ec1 \u0111\u1ec3 hacker kh\xf4ng \u0111o\xe1n \u0111\u01b0\u1ee3c user t\u1ed3n t\u1ea1i hay kh\xf4ng."})]}),"\n",(0,t.jsxs)(s.h3,{id:"-v\xed-d\u1ee5-ch\u1ed1ng-brute-force-trong-api-nodejs--express--rate-limiter",children:["\ud83d\ude80 ",(0,t.jsx)(s.strong,{children:"V\xed d\u1ee5: Ch\u1ed1ng brute force trong API (Node.js + Express + Rate Limiter)"})]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-javascript",children:"const rateLimit = require('express-rate-limit');\n\nconst loginLimiter = rateLimit({\n    windowMs: 15 * 60 * 1000, // 15 ph\xfat\n    max: 5, // Ch\u1ec9 cho ph\xe9p th\u1eed 5 l\u1ea7n\n    message: \"Qu\xe1 nhi\u1ec1u l\u1ea7n th\u1eed \u0111\u0103ng nh\u1eadp. Vui l\xf2ng th\u1eed l\u1ea1i sau 15 ph\xfat.\"\n});\n\napp.post('/login', loginLimiter, (req, res) => {\n    // X\u1eed l\xfd \u0111\u0103ng nh\u1eadp\n});\n"})}),"\n",(0,t.jsxs)(s.p,{children:["\ud83d\udca1 ",(0,t.jsx)(s.strong,{children:"L\u1ee3i \xedch:"}),(0,t.jsx)(s.br,{}),"\n","\u2705 Ng\u0103n ch\u1eb7n hacker ",(0,t.jsx)(s.strong,{children:"th\u1eed nhi\u1ec1u l\u1ea7n \u0111\u1ec3 d\xf2 m\u1eadt kh\u1ea9u"}),".",(0,t.jsx)(s.br,{}),"\n","\u2705 B\u1ea3o v\u1ec7 user kh\u1ecfi ",(0,t.jsx)(s.strong,{children:"t\u1ea5n c\xf4ng brute-force"}),"."]}),"\n",(0,t.jsx)(s.h2,{id:"-3\ufe0f\u20e3-k\u1ebft-lu\u1eadn-c\xe1ch-l\xe0m-\u0111\xfang",children:(0,t.jsx)(s.strong,{children:"\ud83d\udd0e 3\ufe0f\u20e3 K\u1ebft lu\u1eadn: C\xe1ch l\xe0m \u0111\xfang"})}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsxs)(s.th,{children:["\u274c ",(0,t.jsx)(s.strong,{children:"Sai l\u1ea7m"})]}),(0,t.jsxs)(s.th,{children:["\u2705 ",(0,t.jsx)(s.strong,{children:"C\xe1ch s\u1eeda"})]})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"D\xf9ng SHA-256 v\u1edbi salt c\u1ed1 \u0111\u1ecbnh"}),(0,t.jsxs)(s.td,{children:["D\xf9ng ",(0,t.jsx)(s.code,{children:"bcrypt"})," ho\u1eb7c ",(0,t.jsx)(s.code,{children:"Argon2"})," v\u1edbi salt ng\u1eabu nhi\xean"]})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Ch\u1ec9 ch\u1eb7n UI nh\u01b0ng kh\xf4ng ki\u1ec3m tra API"}),(0,t.jsxs)(s.td,{children:["Ki\u1ec3m tra quy\u1ec1n tr\xean ",(0,t.jsx)(s.strong,{children:"backend"})," (API)"]})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Kh\xf4ng gi\u1edbi h\u1ea1n s\u1ed1 l\u1ea7n th\u1eed"}),(0,t.jsxs)(s.td,{children:["D\xf9ng ",(0,t.jsx)(s.strong,{children:"Rate Limiting"})," & ",(0,t.jsx)(s.strong,{children:"Captcha"})," \u0111\u1ec3 ch\u1ed1ng brute-force"]})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"API tr\u1ea3 v\u1ec1 l\u1ed7i r\xf5 r\xe0ng"}),(0,t.jsxs)(s.td,{children:[(0,t.jsx)(s.strong,{children:"\u1ea8n l\u1ed7i"}),", kh\xf4ng ti\u1ebft l\u1ed9 th\xf4ng tin user c\xf3 t\u1ed3n t\u1ea1i hay kh\xf4ng"]})]})]})]}),"\n",(0,t.jsxs)(s.p,{children:["\ud83d\udccc ",(0,t.jsx)(s.strong,{children:"B\xe0i h\u1ecdc quan tr\u1ecdng:"}),(0,t.jsx)(s.br,{}),"\n","\u2705 ",(0,t.jsx)(s.strong,{children:"Kh\xf4ng ch\u1ec9 s\u1eeda l\u1ed7i tr\xean UI"})," \u2013 ",(0,t.jsx)(s.strong,{children:"ph\u1ea3i ki\u1ec3m tra c\u1ea3 API backend"}),"!",(0,t.jsx)(s.br,{}),"\n","\u2705 ",(0,t.jsx)(s.strong,{children:"M\u1eadt kh\u1ea9u v\xe0 hash c\u1ea7n \u0111\u01b0\u1ee3c b\u1ea3o v\u1ec7 b\u1eb1ng thu\u1eadt to\xe1n m\u1ea1nh"})," nh\u01b0 bcrypt.",(0,t.jsx)(s.br,{}),"\n","\u2705 ",(0,t.jsx)(s.strong,{children:"Ph\u1ea3i ch\u1ed1ng brute-force \u0111\u1ec3 ng\u0103n hacker d\xf2 m\u1eadt kh\u1ea9u."})]}),"\n",(0,t.jsxs)(s.p,{children:["\ud83d\udd25 ",(0,t.jsx)(s.strong,{children:'"Fix l\u1ed7i" kh\xf4ng c\xf3 ngh\u0129a l\xe0 an to\xe0n \u2013 hacker lu\xf4n t\xecm c\xe1ch m\u1edbi \u0111\u1ec3 khai th\xe1c!"'})," \ud83d\ude80"]}),"\n",(0,t.jsxs)(s.p,{children:["Xem chi ti\u1ebft t\u1ea1i ",(0,t.jsx)(s.a,{href:"https://docs.cycubix.com/application-security-series/web-application-security-essentials/solutions/a5-broken-access-control/a1-2021-or-missing-function-level-access-control-or-cycubix-docs/a1-2021-or-missing-function-level-access-control-4-or-cycubix-docs",children:"\u0111\xe2y"}),"."]})]})}function d(n={}){const{wrapper:s}={...(0,r.R)(),...n.components};return s?(0,t.jsx)(s,{...n,children:(0,t.jsx)(a,{...n})}):a(n)}},28453:(n,s,e)=>{e.d(s,{R:()=>c,x:()=>h});var t=e(96540);const r={},i=t.createContext(r);function c(n){const s=t.useContext(i);return t.useMemo((function(){return"function"==typeof n?n(s):{...s,...n}}),[s,n])}function h(n){let s;return s=n.disableParentContext?"function"==typeof n.components?n.components(r):n.components||r:c(n.components),t.createElement(i.Provider,{value:s},n.children)}}}]);